2025-05-05 02:26:12,423 - lavka_recsys.Experiment(catboost_classifier_2f618b) - INFO - Initialized experiment: catboost_classifier_2f618b
2025-05-05 02:26:12,438 - lavka_recsys.Experiment(catboost_classifier_2f618b) - INFO - Config saved: results/full_experiment_20250505_022520/classifier/catboost_classifier_2f618b_config.json
2025-05-05 02:26:12,439 - lavka_recsys.Experiment(catboost_classifier_2f618b) - INFO - Setting up experiment environment...
2025-05-05 02:27:05,086 - lavka_recsys.Experiment(catboost_classifier_b029b8) - INFO - Initialized experiment: catboost_classifier_b029b8
2025-05-05 02:27:05,097 - lavka_recsys.Experiment(catboost_classifier_b029b8) - INFO - Config saved: results/full_experiment_20250505_022701/classifier/catboost_classifier_b029b8_config.json
2025-05-05 02:27:05,097 - lavka_recsys.Experiment(catboost_classifier_b029b8) - INFO - Setting up experiment environment...
2025-05-05 02:27:05,098 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 02:27:05,409 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 02:27:05,463 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:27:05,504 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:27:05,758 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 02:27:05,785 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15070276 rows)
2025-05-05 02:27:05,789 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1438338 rows)
2025-05-05 02:27:05,792 - lavka_recsys.Experiment(catboost_classifier_b029b8) - INFO - Setup complete.
2025-05-05 02:27:05,793 - lavka_recsys.Experiment(catboost_classifier_b029b8) - INFO - Starting experiment run...
2025-05-05 02:27:06,345 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 02:27:06,368 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12082523 rows)
2025-05-05 02:27:06,372 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1498126 rows)
2025-05-05 02:27:06,404 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13580649 rows)
2025-05-05 02:27:06,409 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1489627 rows)
2025-05-05 02:27:06,423 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 02:27:06,424 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf, product_embeddings, category_embeddings, user_product_distance, text_similarity_cluster, text_diversity_features
2025-05-05 02:27:06,425 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 02:27:06,425 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 02:27:06,784 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 02:27:06,889 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 02:27:07,343 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 02:27:07,713 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 02:27:08,345 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 02:27:09,507 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 02:27:09,837 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 02:27:10,177 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 02:27:10,462 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 02:27:10,993 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_temporal_patterns
2025-05-05 02:27:11,233 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_store
2025-05-05 02:27:11,646 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_features
2025-05-05 02:27:11,683 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_window_user_product
2025-05-05 02:27:12,256 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: session_features
2025-05-05 02:27:13,917 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: frequency_features
2025-05-05 02:27:17,906 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_popularity_trend
2025-05-05 02:27:18,369 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 02:27:18,728 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 02:27:19,010 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 02:27:19,258 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 02:27:19,750 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cross_features
2025-05-05 02:27:19,756 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_segments
2025-05-05 02:27:20,062 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: memory-based-cf
2025-05-05 02:27:22,142 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: npmi-cf
2025-05-05 02:27:46,412 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: puresvd-cf
2025-05-05 02:28:10,045 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: svd-cf
2025-05-05 02:28:13,883 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_embeddings
2025-05-05 02:28:13,894 - lavka_recsys.TextProcessor - ERROR - sentence-transformers not available. Install with: pip install sentence-transformers
2025-05-05 02:28:14,480 - lavka_recsys.TextProcessor - WARNING - No text model loaded. Returning zero embeddings.
2025-05-05 02:28:14,543 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: category_embeddings
2025-05-05 02:28:14,560 - lavka_recsys.TextProcessor - ERROR - sentence-transformers not available. Install with: pip install sentence-transformers
2025-05-05 02:28:14,881 - lavka_recsys.TextProcessor - WARNING - No text model loaded. Returning zero embeddings.
2025-05-05 02:28:14,924 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_product_distance
2025-05-05 02:28:14,942 - lavka_recsys.TextProcessor - ERROR - sentence-transformers not available. Install with: pip install sentence-transformers
2025-05-05 02:28:15,316 - lavka_recsys.TextProcessor - WARNING - No text model loaded. Returning zero embeddings.
2025-05-05 02:28:52,085 - lavka_recsys.Experiment(catboost_classifier_bad914) - INFO - Initialized experiment: catboost_classifier_bad914
2025-05-05 02:28:52,094 - lavka_recsys.Experiment(catboost_classifier_bad914) - INFO - Config saved: results/full_experiment_20250505_022701/classifier/catboost_classifier_bad914_config.json
2025-05-05 02:28:52,096 - lavka_recsys.Experiment(catboost_classifier_bad914) - INFO - Setting up experiment environment...
2025-05-05 02:28:52,097 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 02:28:52,362 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 02:28:52,426 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:28:52,445 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:28:52,653 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 02:28:52,681 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15070276 rows)
2025-05-05 02:28:52,685 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1438338 rows)
2025-05-05 02:28:52,686 - lavka_recsys.Experiment(catboost_classifier_bad914) - INFO - Setup complete.
2025-05-05 02:28:52,687 - lavka_recsys.Experiment(catboost_classifier_bad914) - INFO - Starting experiment run...
2025-05-05 02:28:53,036 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 02:28:53,059 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12082523 rows)
2025-05-05 02:28:53,063 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1498126 rows)
2025-05-05 02:28:53,089 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13580649 rows)
2025-05-05 02:28:53,094 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1489627 rows)
2025-05-05 02:28:53,108 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 02:28:53,110 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf, product_embeddings, category_embeddings
2025-05-05 02:28:53,111 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 02:28:53,111 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 02:28:53,505 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 02:28:53,590 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 02:28:54,197 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 02:28:54,564 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 02:28:54,942 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 02:28:55,897 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 02:28:56,203 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 02:28:56,499 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 02:28:56,774 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 02:28:57,212 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_temporal_patterns
2025-05-05 02:28:57,373 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_store
2025-05-05 02:28:57,706 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_features
2025-05-05 02:28:57,747 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_window_user_product
2025-05-05 02:28:58,127 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: session_features
2025-05-05 02:28:59,957 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: frequency_features
2025-05-05 02:29:03,819 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_popularity_trend
2025-05-05 02:29:04,295 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 02:29:04,569 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 02:29:04,859 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 02:29:05,136 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 02:29:05,690 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cross_features
2025-05-05 02:29:05,697 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_segments
2025-05-05 02:29:05,984 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: memory-based-cf
2025-05-05 02:29:07,875 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: npmi-cf
2025-05-05 02:29:35,497 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: puresvd-cf
2025-05-05 02:29:58,146 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: svd-cf
2025-05-05 02:30:01,803 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_embeddings
2025-05-05 02:30:01,813 - lavka_recsys.TextProcessor - ERROR - sentence-transformers not available. Install with: pip install sentence-transformers
2025-05-05 02:30:02,282 - lavka_recsys.TextProcessor - WARNING - No text model loaded. Returning zero embeddings.
2025-05-05 02:30:02,328 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: category_embeddings
2025-05-05 02:30:02,339 - lavka_recsys.TextProcessor - ERROR - sentence-transformers not available. Install with: pip install sentence-transformers
2025-05-05 02:30:02,604 - lavka_recsys.TextProcessor - WARNING - No text model loaded. Returning zero embeddings.
2025-05-05 02:30:02,630 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 02:30:02,631 - lavka_recsys.FeatureFactory - INFO - All column names: {'user_store_purchase_cross', 'user_total_views', 'user_product_store_cross', 'cart_to_purchase_rate', 'product_embed_5', 'category_embed_0', 'category_embed_1', 'session_unique_stores', 'cf_score', 'product_unique_users', 'product_embed_2', 'product_total_purchases', 'purchase_trend', 'user_product_purchase_cross', 'views_week_u_p', 'most_common_purchase_day', 'hour_relevance', 'category_embed_8', 'purchases_month_u_p', 'product_embed_9', 'purchases_week_u_p', 'category_embed_3', 'store_total_interactions', 'product_embed_7', 'day_of_week', 'avg_purchase_hour', 'is_weekend', 'product_embed_3', 'count_purchase_u_s', 'month', 'product_total_views', 'interaction_trend', 'store_unique_products', 'session_unique_products', 'product_embed_6', 'city_total_purchases', 'product_embed_8', 'puresvd_cf_score', 'category_embed_7', 'category_embed_2', 'day_of_week_relevance', 'count_purchase_u_p', 'interactions_month_u_p', 'std_purchase_hour', 'session_duration_seconds', 'category_embed_4', 'product_total_interactions', 'user_total_interactions', 'interactions_day_u_p', 'category_embed_6', 'svd_cf_score', 'product_embed_0', 'interactions_week_u_p', 'product_embed_4', 'city_unique_stores', 'npmi_cf_score', 'session_purchases', 'category_embed_9', 'user_unique_products', 'category_embed_5', 'last_interaction_u_p', 'source_type', 'last_interaction_u_s', 'purchase_view_ratio', 'session_length', 'city_name', 'city_total_interactions', 'city_total_views', 'views_month_u_p', 'views_day_u_p', 'purchases_day_u_p', 'store_total_views', 'product_embed_1', 'user_segment', 'mean_interval_days', 'ctr_product', 'user_total_purchases', 'hour_of_day', 'store_total_purchases'}
2025-05-05 02:30:02,632 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['user_segment', 'source_type', 'city_name']
2025-05-05 02:33:36,275 - lavka_recsys.Experiment(catboost_classifier_8b6f1c) - INFO - Initialized experiment: catboost_classifier_8b6f1c
2025-05-05 02:33:36,286 - lavka_recsys.Experiment(catboost_classifier_8b6f1c) - INFO - Config saved: results/full_experiment_20250505_022701/classifier/catboost_classifier_8b6f1c_config.json
2025-05-05 02:33:36,287 - lavka_recsys.Experiment(catboost_classifier_8b6f1c) - INFO - Setting up experiment environment...
2025-05-05 02:33:36,289 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 02:33:36,591 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 02:33:36,653 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:33:36,669 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:33:36,847 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 02:33:36,873 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15070276 rows)
2025-05-05 02:33:36,877 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1438338 rows)
2025-05-05 02:33:36,878 - lavka_recsys.Experiment(catboost_classifier_8b6f1c) - INFO - Setup complete.
2025-05-05 02:33:36,879 - lavka_recsys.Experiment(catboost_classifier_8b6f1c) - INFO - Starting experiment run...
2025-05-05 02:33:37,213 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 02:33:37,234 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12082523 rows)
2025-05-05 02:33:37,238 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1498126 rows)
2025-05-05 02:33:37,263 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13580649 rows)
2025-05-05 02:33:37,271 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1489627 rows)
2025-05-05 02:33:37,294 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 02:33:37,295 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf
2025-05-05 02:33:37,296 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 02:33:37,296 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 02:33:37,528 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 02:33:37,601 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 02:33:38,015 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 02:33:38,380 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 02:33:38,715 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 02:33:39,759 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 02:33:40,079 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 02:33:40,346 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 02:33:40,605 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 02:33:41,104 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_temporal_patterns
2025-05-05 02:33:41,258 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_store
2025-05-05 02:33:41,607 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_features
2025-05-05 02:33:41,645 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_window_user_product
2025-05-05 02:33:42,033 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: session_features
2025-05-05 02:33:43,518 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: frequency_features
2025-05-05 02:33:47,970 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_popularity_trend
2025-05-05 02:33:48,519 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 02:33:48,870 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 02:33:49,147 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 02:33:49,421 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 02:33:49,889 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cross_features
2025-05-05 02:33:49,898 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_segments
2025-05-05 02:33:50,222 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: memory-based-cf
2025-05-05 02:33:52,371 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: npmi-cf
2025-05-05 02:34:16,298 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: puresvd-cf
2025-05-05 02:34:38,884 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: svd-cf
2025-05-05 02:34:42,433 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 02:34:42,439 - lavka_recsys.FeatureFactory - INFO - All column names: {'hour_relevance', 'user_unique_products', 'purchases_month_u_p', 'user_store_purchase_cross', 'last_interaction_u_p', 'source_type', 'user_total_views', 'last_interaction_u_s', 'purchases_week_u_p', 'purchase_view_ratio', 'session_unique_products', 'user_product_store_cross', 'city_total_purchases', 'session_length', 'puresvd_cf_score', 'day_of_week_relevance', 'count_purchase_u_p', 'cart_to_purchase_rate', 'store_total_interactions', 'interactions_month_u_p', 'city_name', 'day_of_week', 'city_total_interactions', 'city_total_views', 'views_month_u_p', 'session_unique_stores', 'std_purchase_hour', 'avg_purchase_hour', 'views_day_u_p', 'is_weekend', 'product_total_interactions', 'session_duration_seconds', 'user_total_interactions', 'purchases_day_u_p', 'cf_score', 'interactions_day_u_p', 'store_total_views', 'product_unique_users', 'svd_cf_score', 'product_total_purchases', 'purchase_trend', 'interactions_week_u_p', 'mean_interval_days', 'count_purchase_u_s', 'user_product_purchase_cross', 'city_unique_stores', 'user_segment', 'views_week_u_p', 'npmi_cf_score', 'ctr_product', 'month', 'user_total_purchases', 'product_total_views', 'hour_of_day', 'most_common_purchase_day', 'interaction_trend', 'store_unique_products', 'session_purchases', 'store_total_purchases'}
2025-05-05 02:34:42,440 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['user_segment', 'source_type', 'city_name']
2025-05-05 02:35:43,883 - lavka_recsys.Experiment(catboost_classifier_8b6f1c) - INFO - Initialized experiment: catboost_classifier_8b6f1c
2025-05-05 02:35:43,892 - lavka_recsys.Experiment(catboost_classifier_8b6f1c) - INFO - Config saved: results/full_experiment_20250505_022701/classifier/catboost_classifier_8b6f1c_config.json
2025-05-05 02:35:43,893 - lavka_recsys.Experiment(catboost_classifier_8b6f1c) - INFO - Setting up experiment environment...
2025-05-05 02:35:43,894 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 02:35:44,150 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 02:35:44,200 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:35:44,218 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:35:44,409 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 02:35:44,435 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15070276 rows)
2025-05-05 02:35:44,439 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1438338 rows)
2025-05-05 02:35:44,440 - lavka_recsys.Experiment(catboost_classifier_8b6f1c) - INFO - Setup complete.
2025-05-05 02:35:44,441 - lavka_recsys.Experiment(catboost_classifier_8b6f1c) - INFO - Starting experiment run...
2025-05-05 02:35:44,759 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 02:35:44,787 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12082523 rows)
2025-05-05 02:35:44,791 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1498126 rows)
2025-05-05 02:35:44,816 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13580649 rows)
2025-05-05 02:35:44,820 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1489627 rows)
2025-05-05 02:35:44,833 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 02:35:44,835 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf
2025-05-05 02:35:44,836 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 02:35:44,836 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 02:35:45,117 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 02:35:45,205 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 02:35:45,670 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 02:35:45,999 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 02:35:46,343 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 02:35:47,287 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 02:35:47,585 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 02:35:47,888 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 02:35:48,163 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 02:35:48,638 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_temporal_patterns
2025-05-05 02:35:48,831 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_store
2025-05-05 02:35:49,193 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_features
2025-05-05 02:35:49,245 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_window_user_product
2025-05-05 02:35:49,654 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: session_features
2025-05-05 02:35:51,169 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: frequency_features
2025-05-05 02:36:37,123 - lavka_recsys.Experiment(catboost_classifier_3cb920) - INFO - Initialized experiment: catboost_classifier_3cb920
2025-05-05 02:36:37,147 - lavka_recsys.Experiment(catboost_classifier_3cb920) - INFO - Config saved: results/catboost_classifier_3cb920_config.json
2025-05-05 02:36:37,149 - lavka_recsys.Experiment(catboost_classifier_3cb920) - INFO - Setting up experiment environment...
2025-05-05 02:36:37,150 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 02:36:37,462 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 02:36:37,525 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:36:37,577 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:36:37,802 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 02:36:37,833 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15070276 rows, 367 days)
2025-05-05 02:36:37,837 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1438338 rows, 29 days)
2025-05-05 02:36:37,838 - lavka_recsys.Experiment(catboost_classifier_3cb920) - INFO - Setup complete.
2025-05-05 02:36:37,839 - lavka_recsys.Experiment(catboost_classifier_3cb920) - INFO - Starting experiment run...
2025-05-05 02:36:38,369 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 02:36:38,391 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12082523 rows, 307 days)
2025-05-05 02:36:38,395 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1498126 rows, 29 days)
2025-05-05 02:36:38,421 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13580649 rows, 337 days)
2025-05-05 02:36:38,425 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1489627 rows, 29 days)
2025-05-05 02:36:38,439 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 02:36:38,440 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf
2025-05-05 02:36:38,443 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 02:36:38,443 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 02:36:38,723 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 02:36:38,812 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 02:36:39,275 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 02:36:39,612 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 02:36:39,936 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 02:36:40,941 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 02:36:41,277 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 02:36:41,605 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 02:36:41,961 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 02:36:42,424 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_temporal_patterns
2025-05-05 02:36:42,607 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_store
2025-05-05 02:36:42,962 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_features
2025-05-05 02:36:43,002 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_window_user_product
2025-05-05 02:36:43,391 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: session_features
2025-05-05 02:36:45,306 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: frequency_features
2025-05-05 02:36:49,591 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_popularity_trend
2025-05-05 02:36:50,189 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 02:36:50,503 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 02:36:50,805 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 02:36:51,051 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 02:36:51,554 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cross_features
2025-05-05 02:36:51,571 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_segments
2025-05-05 02:36:51,894 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: memory-based-cf
2025-05-05 02:36:53,880 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: npmi-cf
2025-05-05 02:37:17,692 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: puresvd-cf
2025-05-05 02:37:41,023 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: svd-cf
2025-05-05 02:37:45,024 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 02:37:45,029 - lavka_recsys.FeatureFactory - INFO - All column names: {'purchase_trend', 'session_duration_seconds', 'month', 'days_since_interaction_u_p', 'store_total_views', 'user_product_purchase_cross', 'user_total_views', 'product_unique_users', 'mean_interval_days', 'purchases_day_u_p', 'purchases_week_u_p', 'store_unique_products', 'day_of_week', 'views_month_u_p', 'product_total_interactions', 'user_total_purchases', 'session_unique_products', 'city_total_views', 'views_week_u_p', 'city_unique_stores', 'avg_purchase_hour', 'count_purchase_u_p', 'session_unique_stores', 'product_total_views', 'user_product_store_cross', 'days_since_interaction_u_s', 'svd_cf_score', 'city_total_purchases', 'user_store_purchase_cross', 'is_weekend', 'cart_to_purchase_rate', 'views_day_u_p', 'most_common_purchase_day', 'user_unique_products', 'interactions_day_u_p', 'source_type', 'ctr_product', 'session_length', 'product_total_purchases', 'cf_score', 'count_purchase_u_s', 'interactions_month_u_p', 'user_total_interactions', 'city_name', 'interactions_week_u_p', 'session_purchases', 'hour_relevance', 'city_total_interactions', 'user_segment', 'puresvd_cf_score', 'day_of_week_relevance', 'hour_of_day', 'purchase_view_ratio', 'interaction_trend', 'npmi_cf_score', 'std_purchase_hour', 'purchases_month_u_p', 'store_total_purchases', 'store_total_interactions'}
2025-05-05 02:37:45,030 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type', 'user_segment', 'city_name']
2025-05-05 02:37:45,034 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 02:38:30,146 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Initialized experiment: catboost_classifier_97acd4
2025-05-05 02:38:30,155 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Config saved: results/catboost_classifier_97acd4_config.json
2025-05-05 02:38:30,156 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Setting up experiment environment...
2025-05-05 02:38:30,157 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 02:38:30,481 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 02:38:30,547 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:38:30,583 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:38:30,862 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 02:38:30,890 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 02:38:30,893 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 02:38:30,894 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Setup complete.
2025-05-05 02:38:30,895 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Starting experiment run...
2025-05-05 02:38:31,416 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 02:38:31,440 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 02:38:31,444 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 02:38:31,470 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 02:38:31,474 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 02:38:31,487 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 02:38:31,489 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio
2025-05-05 02:38:31,490 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 02:38:31,490 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 02:38:31,777 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 02:38:31,868 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 02:38:32,319 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 02:38:32,701 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 02:38:33,063 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 02:38:33,064 - lavka_recsys.FeatureFactory - INFO - All column names: {'purchase_view_ratio', 'ctr_product', 'count_purchase_u_s', 'count_purchase_u_p', 'source_type', 'cart_to_purchase_rate'}
2025-05-05 02:38:33,065 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type']
2025-05-05 02:38:33,067 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 02:38:34,412 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_807fd2021581198863b69c022ce940a8.pkl
2025-05-05 02:38:34,426 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 02:38:34,428 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio
2025-05-05 02:38:34,429 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 02:38:34,429 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 02:38:34,657 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 02:38:34,739 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 02:38:35,198 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 02:38:35,668 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 02:38:36,042 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 02:38:36,044 - lavka_recsys.FeatureFactory - INFO - All column names: {'purchase_view_ratio', 'ctr_product', 'count_purchase_u_s', 'count_purchase_u_p', 'source_type', 'cart_to_purchase_rate'}
2025-05-05 02:38:36,045 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type']
2025-05-05 02:38:36,049 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 02:38:37,380 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_a9dd1ab83132447dd6edb0ae14e7330e.pkl
2025-05-05 02:38:37,381 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 500, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 02:38:37,535 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 02:38:38,138 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 02:39:07,106 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Initialized experiment: catboost_classifier_97acd4
2025-05-05 02:39:07,115 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Config saved: results/catboost_classifier_97acd4_config.json
2025-05-05 02:39:07,116 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Setting up experiment environment...
2025-05-05 02:39:07,117 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 02:39:07,437 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 02:39:07,492 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:39:07,538 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:39:07,792 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 02:39:07,816 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 02:39:07,820 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 02:39:07,820 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Setup complete.
2025-05-05 02:39:07,821 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Starting experiment run...
2025-05-05 02:39:08,360 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 02:39:08,381 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 02:39:08,385 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 02:39:08,410 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 02:39:08,414 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 02:39:08,426 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_807fd2021581198863b69c022ce940a8.pkl
2025-05-05 02:39:08,706 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 02:39:08,720 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_a9dd1ab83132447dd6edb0ae14e7330e.pkl
2025-05-05 02:39:08,917 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 02:39:08,919 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 500, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 02:39:09,130 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 02:39:09,759 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 02:39:10,194 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoost model with columns: ['purchase_view_ratio', 'ctr_product', 'count_purchase_u_s', 'count_purchase_u_p', 'source_type', 'cart_to_purchase_rate'] (cat_columns: ['source_type'])
2025-05-05 02:50:18,376 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Initialized experiment: catboost_classifier_97acd4
2025-05-05 02:50:18,385 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Config saved: results/catboost_classifier_97acd4_config.json
2025-05-05 02:50:18,386 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Setting up experiment environment...
2025-05-05 02:50:18,388 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 02:50:18,701 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 02:50:18,755 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:50:18,806 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:50:19,057 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 02:50:19,085 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 02:50:19,089 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 02:50:19,090 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Setup complete.
2025-05-05 02:50:19,092 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Starting experiment run...
2025-05-05 02:50:19,556 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 02:50:19,579 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 02:50:19,582 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 02:50:19,608 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 02:50:19,612 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 02:50:19,626 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_807fd2021581198863b69c022ce940a8.pkl
2025-05-05 02:50:19,878 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 02:50:19,895 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_a9dd1ab83132447dd6edb0ae14e7330e.pkl
2025-05-05 02:50:20,112 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 02:50:20,115 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 500, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 02:50:20,285 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 02:51:41,479 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Initialized experiment: catboost_classifier_97acd4
2025-05-05 02:51:41,487 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Config saved: results/catboost_classifier_97acd4_config.json
2025-05-05 02:51:41,488 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Setting up experiment environment...
2025-05-05 02:51:41,490 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 02:51:41,830 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 02:51:41,892 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:51:41,928 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:51:42,208 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 02:51:42,233 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 02:51:42,237 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 02:51:42,238 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Setup complete.
2025-05-05 02:51:42,239 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Starting experiment run...
2025-05-05 02:51:42,614 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 02:51:42,640 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 02:51:42,644 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 02:51:42,674 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 02:51:42,678 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 02:51:42,694 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_807fd2021581198863b69c022ce940a8.pkl
2025-05-05 02:51:42,963 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 02:51:42,977 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_a9dd1ab83132447dd6edb0ae14e7330e.pkl
2025-05-05 02:51:43,183 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 02:51:43,189 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 500, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 02:51:43,533 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 02:53:07,227 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Initialized experiment: catboost_classifier_97acd4
2025-05-05 02:53:07,236 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Config saved: results/catboost_classifier_97acd4_config.json
2025-05-05 02:53:07,238 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Setting up experiment environment...
2025-05-05 02:53:07,240 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 02:53:07,576 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 02:53:07,631 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:53:07,653 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:53:07,901 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 02:53:07,928 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 02:53:07,932 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 02:53:07,933 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Setup complete.
2025-05-05 02:53:07,934 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Starting experiment run...
2025-05-05 02:53:08,504 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 02:53:08,526 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 02:53:08,529 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 02:53:08,555 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 02:53:08,559 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 02:53:08,577 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_807fd2021581198863b69c022ce940a8.pkl
2025-05-05 02:53:08,805 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 02:53:08,820 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_a9dd1ab83132447dd6edb0ae14e7330e.pkl
2025-05-05 02:53:09,020 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 02:53:09,023 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 500, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 02:53:09,196 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 02:53:44,504 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Initialized experiment: catboost_classifier_97acd4
2025-05-05 02:53:44,513 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Config saved: results/catboost_classifier_97acd4_config.json
2025-05-05 02:53:44,514 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Setting up experiment environment...
2025-05-05 02:53:44,515 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 02:53:44,859 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 02:53:44,928 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:53:44,960 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:53:45,254 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 02:53:45,280 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 02:53:45,284 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 02:53:45,285 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Setup complete.
2025-05-05 02:53:45,286 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Starting experiment run...
2025-05-05 02:53:45,774 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 02:53:45,796 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 02:53:45,799 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 02:53:45,826 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 02:53:45,829 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 02:53:45,843 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_807fd2021581198863b69c022ce940a8.pkl
2025-05-05 02:53:46,111 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 02:53:46,134 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_a9dd1ab83132447dd6edb0ae14e7330e.pkl
2025-05-05 02:53:46,332 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 02:53:46,335 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 500, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 02:53:46,502 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 03:21:39,180 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Initialized experiment: catboost_classifier_97acd4
2025-05-05 03:21:39,188 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Config saved: results/catboost_classifier_97acd4_config.json
2025-05-05 03:21:39,190 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Setting up experiment environment...
2025-05-05 03:21:39,192 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 03:21:39,488 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 03:21:39,540 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 03:21:39,573 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 03:21:39,838 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 03:21:39,865 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 03:21:39,868 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 03:21:39,869 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Setup complete.
2025-05-05 03:21:39,871 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Starting experiment run...
2025-05-05 03:21:40,388 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 03:21:40,410 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 03:21:40,416 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 03:21:40,441 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 03:21:40,445 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 03:21:40,458 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_807fd2021581198863b69c022ce940a8.pkl
2025-05-05 03:21:40,685 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 03:21:40,699 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_a9dd1ab83132447dd6edb0ae14e7330e.pkl
2025-05-05 03:21:40,895 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 03:21:40,907 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 500, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 03:21:41,092 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 03:21:43,355 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 03:21:45,653 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 03:21:46,719 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 03:21:47,560 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoost model with columns: ['purchase_view_ratio', 'ctr_product', 'count_purchase_u_s', 'count_purchase_u_p', 'source_type', 'cart_to_purchase_rate'] (cat_columns: ['source_type'])
2025-05-05 03:22:23,800 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Training completed in 42.85s
2025-05-05 03:22:23,803 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Evaluating on holdout.
2025-05-05 03:22:23,901 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 03:22:23,903 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio
2025-05-05 03:22:23,904 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 03:22:23,904 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 03:22:24,429 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 03:22:24,521 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 03:22:25,074 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 03:22:25,545 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 03:22:25,972 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 03:22:25,975 - lavka_recsys.FeatureFactory - INFO - All column names: {'ctr_product', 'cart_to_purchase_rate', 'count_purchase_u_s', 'purchase_view_ratio', 'count_purchase_u_p', 'source_type'}
2025-05-05 03:22:25,976 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type']
2025-05-05 03:22:25,981 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 03:22:27,265 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_19f692debef267747df811cb88093d2c.pkl
2025-05-05 03:23:47,749 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Initialized experiment: catboost_classifier_97acd4
2025-05-05 03:23:47,758 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Config saved: results/catboost_classifier_97acd4_config.json
2025-05-05 03:23:47,760 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Setting up experiment environment...
2025-05-05 03:23:47,761 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 03:23:48,044 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 03:23:48,100 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 03:23:48,139 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 03:23:48,418 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 03:23:48,443 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 03:23:48,446 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 03:23:48,447 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Setup complete.
2025-05-05 03:23:48,448 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Starting experiment run...
2025-05-05 03:23:49,023 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 03:23:49,050 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 03:23:49,054 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 03:23:49,079 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 03:23:49,083 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 03:23:49,098 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_807fd2021581198863b69c022ce940a8.pkl
2025-05-05 03:23:49,329 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 03:23:49,344 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_a9dd1ab83132447dd6edb0ae14e7330e.pkl
2025-05-05 03:23:49,547 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 03:23:49,550 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 500, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 03:23:49,719 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 03:23:51,962 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 03:23:54,093 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 03:23:54,999 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 03:23:55,806 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoost model with columns: ['purchase_view_ratio', 'ctr_product', 'count_purchase_u_s', 'count_purchase_u_p', 'source_type', 'cart_to_purchase_rate'] (cat_columns: ['source_type'])
2025-05-05 03:24:32,260 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Training completed in 42.69s
2025-05-05 03:24:32,264 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Evaluating on holdout.
2025-05-05 03:24:32,361 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_19f692debef267747df811cb88093d2c.pkl
2025-05-05 03:24:32,549 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 03:24:32,689 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 03:24:44,460 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Run results saved: results/catboost_classifier_97acd4_results.json
2025-05-05 03:24:44,465 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Run finished and results saved.
2025-05-05 03:25:13,049 - lavka_recsys.Experiment(catboost_classifier_3cb920) - INFO - Initialized experiment: catboost_classifier_3cb920
2025-05-05 03:25:13,059 - lavka_recsys.Experiment(catboost_classifier_3cb920) - INFO - Config saved: results/catboost_classifier_3cb920_config.json
2025-05-05 03:25:13,298 - lavka_recsys.Experiment(catboost_classifier_3cb920) - INFO - Setting up experiment environment...
2025-05-05 03:25:13,300 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 03:25:13,773 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 03:25:13,832 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 03:25:13,859 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 03:25:14,047 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 03:25:14,073 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 03:25:14,076 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 03:25:14,077 - lavka_recsys.Experiment(catboost_classifier_3cb920) - INFO - Setup complete.
2025-05-05 03:25:14,078 - lavka_recsys.Experiment(catboost_classifier_3cb920) - INFO - Starting experiment run...
2025-05-05 03:25:14,417 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 03:25:14,440 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 03:25:14,444 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 03:25:14,469 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 03:25:14,473 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 03:25:14,488 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 03:25:14,489 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf
2025-05-05 03:25:14,490 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 03:25:14,490 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 03:25:14,832 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 03:25:14,932 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 03:25:15,439 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 03:25:15,775 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 03:25:16,155 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 03:25:17,079 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 03:25:17,378 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 03:25:17,742 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 03:25:18,024 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 03:25:18,468 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_temporal_patterns
2025-05-05 03:25:18,654 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_store
2025-05-05 03:25:19,022 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_features
2025-05-05 03:25:19,076 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_window_user_product
2025-05-05 03:25:19,491 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: session_features
2025-05-05 03:25:20,971 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: frequency_features
2025-05-05 03:25:24,340 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_popularity_trend
2025-05-05 03:25:24,842 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 03:25:25,148 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 03:25:25,425 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 03:25:25,697 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 03:25:26,168 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cross_features
2025-05-05 03:25:26,178 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_segments
2025-05-05 03:25:26,446 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: memory-based-cf
2025-05-05 03:25:28,485 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: npmi-cf
2025-05-05 03:25:52,457 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: puresvd-cf
2025-05-05 03:26:15,142 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: svd-cf
2025-05-05 03:26:19,048 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 03:26:19,051 - lavka_recsys.FeatureFactory - INFO - All column names: {'product_total_purchases', 'month', 'days_since_interaction_u_s', 'city_unique_stores', 'user_total_purchases', 'purchases_week_u_p', 'puresvd_cf_score', 'svd_cf_score', 'session_unique_stores', 'mean_interval_days', 'ctr_product', 'interaction_trend', 'hour_of_day', 'session_length', 'views_week_u_p', 'day_of_week', 'count_purchase_u_s', 'session_unique_products', 'most_common_purchase_day', 'purchase_trend', 'user_product_purchase_cross', 'city_total_views', 'session_duration_seconds', 'city_total_purchases', 'day_of_week_relevance', 'store_total_interactions', 'purchase_view_ratio', 'city_total_interactions', 'std_purchase_hour', 'interactions_week_u_p', 'purchases_day_u_p', 'product_total_views', 'avg_purchase_hour', 'store_total_purchases', 'interactions_month_u_p', 'purchases_month_u_p', 'user_store_purchase_cross', 'count_purchase_u_p', 'cart_to_purchase_rate', 'user_product_store_cross', 'product_total_interactions', 'cf_score', 'session_purchases', 'views_month_u_p', 'hour_relevance', 'user_total_interactions', 'store_unique_products', 'product_unique_users', 'views_day_u_p', 'npmi_cf_score', 'user_segment', 'user_total_views', 'store_total_views', 'user_unique_products', 'city_name', 'is_weekend', 'days_since_interaction_u_p', 'source_type', 'interactions_day_u_p'}
2025-05-05 03:26:19,052 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['city_name', 'source_type', 'user_segment']
2025-05-05 03:26:19,054 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 03:26:21,662 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_e2cea473ae2de94a90929a1d8c5e4952.pkl
2025-05-05 03:26:21,707 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 03:26:21,709 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf
2025-05-05 03:26:21,710 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 03:26:21,711 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 03:26:22,125 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 03:26:22,242 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 03:26:22,726 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 03:26:23,081 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 03:26:23,467 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 03:26:24,506 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 03:26:24,861 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 03:26:25,307 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 03:26:25,670 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 03:26:26,318 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_temporal_patterns
2025-05-05 03:26:26,541 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_store
2025-05-05 03:26:26,969 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_features
2025-05-05 03:26:27,029 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_window_user_product
2025-05-05 03:26:27,454 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: session_features
2025-05-05 03:26:29,308 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: frequency_features
2025-05-05 03:26:33,522 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_popularity_trend
2025-05-05 03:26:34,050 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 03:26:34,376 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 03:26:34,711 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 03:26:35,054 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 03:26:35,519 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cross_features
2025-05-05 03:26:35,526 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_segments
2025-05-05 03:26:35,850 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: memory-based-cf
2025-05-05 03:26:37,860 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: npmi-cf
2025-05-05 03:27:04,797 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: puresvd-cf
2025-05-05 03:27:30,487 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: svd-cf
2025-05-05 03:27:34,192 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 03:27:34,197 - lavka_recsys.FeatureFactory - INFO - All column names: {'product_total_purchases', 'month', 'days_since_interaction_u_s', 'city_unique_stores', 'user_total_purchases', 'purchases_week_u_p', 'puresvd_cf_score', 'svd_cf_score', 'session_unique_stores', 'mean_interval_days', 'ctr_product', 'interaction_trend', 'hour_of_day', 'session_length', 'views_week_u_p', 'day_of_week', 'count_purchase_u_s', 'session_unique_products', 'most_common_purchase_day', 'purchase_trend', 'user_product_purchase_cross', 'city_total_views', 'session_duration_seconds', 'city_total_purchases', 'day_of_week_relevance', 'store_total_interactions', 'purchase_view_ratio', 'city_total_interactions', 'std_purchase_hour', 'interactions_week_u_p', 'purchases_day_u_p', 'product_total_views', 'avg_purchase_hour', 'store_total_purchases', 'interactions_month_u_p', 'purchases_month_u_p', 'user_store_purchase_cross', 'count_purchase_u_p', 'cart_to_purchase_rate', 'user_product_store_cross', 'product_total_interactions', 'cf_score', 'session_purchases', 'views_month_u_p', 'hour_relevance', 'user_total_interactions', 'store_unique_products', 'product_unique_users', 'views_day_u_p', 'npmi_cf_score', 'user_segment', 'user_total_views', 'store_total_views', 'user_unique_products', 'city_name', 'is_weekend', 'days_since_interaction_u_p', 'source_type', 'interactions_day_u_p'}
2025-05-05 03:27:34,198 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['city_name', 'source_type', 'user_segment']
2025-05-05 03:27:34,204 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 03:27:36,897 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_ac5f5e86f44f608c0d04faf318225b89.pkl
2025-05-05 03:27:36,898 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 500, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 03:27:37,235 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 03:27:40,629 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 03:27:43,635 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 03:27:43,655 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 03:27:43,678 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 03:27:45,217 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 03:27:45,238 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 03:27:45,263 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 03:27:46,694 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoost model with columns: ['product_total_purchases', 'month', 'days_since_interaction_u_s', 'city_unique_stores', 'user_total_purchases', 'purchases_week_u_p', 'puresvd_cf_score', 'svd_cf_score', 'session_unique_stores', 'mean_interval_days', 'ctr_product', 'interaction_trend', 'hour_of_day', 'session_length', 'views_week_u_p', 'day_of_week', 'count_purchase_u_s', 'session_unique_products', 'most_common_purchase_day', 'purchase_trend', 'user_product_purchase_cross', 'city_total_views', 'session_duration_seconds', 'city_total_purchases', 'day_of_week_relevance', 'store_total_interactions', 'purchase_view_ratio', 'city_total_interactions', 'std_purchase_hour', 'interactions_week_u_p', 'purchases_day_u_p', 'product_total_views', 'avg_purchase_hour', 'store_total_purchases', 'interactions_month_u_p', 'purchases_month_u_p', 'user_store_purchase_cross', 'count_purchase_u_p', 'cart_to_purchase_rate', 'user_product_store_cross', 'product_total_interactions', 'cf_score', 'session_purchases', 'views_month_u_p', 'hour_relevance', 'user_total_interactions', 'store_unique_products', 'product_unique_users', 'views_day_u_p', 'npmi_cf_score', 'user_segment', 'user_total_views', 'store_total_views', 'user_unique_products', 'city_name', 'is_weekend', 'days_since_interaction_u_p', 'source_type', 'interactions_day_u_p'] (cat_columns: ['city_name', 'source_type', 'user_segment'])
2025-05-05 03:28:52,302 - lavka_recsys.Experiment(catboost_classifier_3cb920) - INFO - Training completed in 75.40s
2025-05-05 03:28:52,306 - lavka_recsys.Experiment(catboost_classifier_3cb920) - INFO - Evaluating on holdout.
2025-05-05 03:28:52,354 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 03:28:52,355 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf
2025-05-05 03:28:52,356 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 03:28:52,356 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 03:28:52,732 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 03:28:52,836 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 03:28:53,361 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 03:28:53,830 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 03:28:54,217 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 03:28:55,273 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 03:28:55,632 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 03:28:56,020 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 03:28:56,348 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 03:28:56,832 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_temporal_patterns
2025-05-05 03:28:57,007 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_store
2025-05-05 03:28:57,438 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_features
2025-05-05 03:28:57,490 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_window_user_product
2025-05-05 03:28:57,835 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: session_features
2025-05-05 03:28:59,628 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: frequency_features
2025-05-05 03:29:03,912 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_popularity_trend
2025-05-05 03:29:04,440 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 03:29:04,787 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 03:29:05,107 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 03:29:05,426 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 03:29:05,943 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cross_features
2025-05-05 03:29:05,949 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_segments
2025-05-05 03:29:06,280 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: memory-based-cf
2025-05-05 03:29:08,377 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: npmi-cf
2025-05-05 03:29:38,343 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: puresvd-cf
2025-05-05 03:30:04,953 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: svd-cf
2025-05-05 03:30:08,572 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 03:30:08,574 - lavka_recsys.FeatureFactory - INFO - All column names: {'product_total_purchases', 'month', 'days_since_interaction_u_s', 'city_unique_stores', 'user_total_purchases', 'purchases_week_u_p', 'puresvd_cf_score', 'svd_cf_score', 'session_unique_stores', 'mean_interval_days', 'ctr_product', 'interaction_trend', 'hour_of_day', 'session_length', 'views_week_u_p', 'day_of_week', 'count_purchase_u_s', 'session_unique_products', 'most_common_purchase_day', 'purchase_trend', 'user_product_purchase_cross', 'city_total_views', 'session_duration_seconds', 'city_total_purchases', 'day_of_week_relevance', 'store_total_interactions', 'purchase_view_ratio', 'city_total_interactions', 'std_purchase_hour', 'interactions_week_u_p', 'purchases_day_u_p', 'product_total_views', 'avg_purchase_hour', 'store_total_purchases', 'interactions_month_u_p', 'purchases_month_u_p', 'user_store_purchase_cross', 'count_purchase_u_p', 'cart_to_purchase_rate', 'user_product_store_cross', 'product_total_interactions', 'cf_score', 'session_purchases', 'views_month_u_p', 'hour_relevance', 'user_total_interactions', 'store_unique_products', 'product_unique_users', 'views_day_u_p', 'npmi_cf_score', 'user_segment', 'user_total_views', 'store_total_views', 'user_unique_products', 'city_name', 'is_weekend', 'days_since_interaction_u_p', 'source_type', 'interactions_day_u_p'}
2025-05-05 03:30:08,576 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['city_name', 'source_type', 'user_segment']
2025-05-05 03:30:08,579 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 03:30:11,051 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_7ee8d53fe77e25622ba623dcc06b9812.pkl
2025-05-05 03:30:11,290 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 03:30:11,325 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 03:30:11,343 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 03:30:23,925 - lavka_recsys.Experiment(catboost_classifier_3cb920) - INFO - Run results saved: results/catboost_classifier_3cb920_results.json
2025-05-05 03:30:23,927 - lavka_recsys.Experiment(catboost_classifier_3cb920) - INFO - Run finished and results saved.
2025-05-05 03:31:24,963 - lavka_recsys.Experiment(catboost_ranker_692adf) - INFO - Initialized experiment: catboost_ranker_692adf
2025-05-05 03:31:24,973 - lavka_recsys.Experiment(catboost_ranker_692adf) - INFO - Config saved: results/catboost_ranker_692adf_config.json
2025-05-05 03:31:24,975 - lavka_recsys.Experiment(catboost_ranker_692adf) - INFO - Setting up experiment environment...
2025-05-05 03:31:24,976 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 03:31:25,220 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 03:31:25,282 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 03:31:25,307 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 03:31:25,469 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 03:31:25,495 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 03:31:25,498 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 03:31:25,499 - lavka_recsys.Experiment(catboost_ranker_692adf) - INFO - Setup complete.
2025-05-05 03:31:25,500 - lavka_recsys.Experiment(catboost_ranker_692adf) - INFO - Starting experiment run...
2025-05-05 03:31:25,789 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 03:31:25,813 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 03:31:25,818 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 03:31:25,846 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 03:31:25,850 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 03:31:25,865 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_e2cea473ae2de94a90929a1d8c5e4952.pkl
2025-05-05 03:31:26,921 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 03:31:26,936 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_ac5f5e86f44f608c0d04faf318225b89.pkl
2025-05-05 03:31:28,039 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 03:31:28,042 - lavka_recsys.ModelFactory - INFO - Creating catboost_ranker model with params: {'iterations': 500, 'verbose': 1, 'loss_function': 'YetiRankPairwise', 'eval_metric': 'NDCG', 'early_stopping_rounds': 50, 'custom_metric': ['NDCG:top=10', 'PrecisionAt:top=10', 'RecallAt:top=10'], 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 03:31:28,280 - lavka_recsys.CatBoostRankerModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 03:31:31,445 - lavka_recsys.CatBoostRankerModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 03:31:34,730 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 03:31:34,753 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 03:31:34,778 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 03:31:36,353 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 03:31:36,375 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 03:31:36,402 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 03:42:09,243 - lavka_recsys.Experiment(catboost_ranker_692adf) - INFO - Training completed in 641.20s
2025-05-05 03:42:09,248 - lavka_recsys.Experiment(catboost_ranker_692adf) - INFO - Evaluating on holdout.
2025-05-05 03:42:09,298 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_7ee8d53fe77e25622ba623dcc06b9812.pkl
2025-05-05 03:42:10,362 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 03:42:10,612 - lavka_recsys.CatBoostRankerModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 03:42:13,203 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 03:42:13,223 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 03:42:13,250 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 03:42:26,145 - lavka_recsys.Experiment(catboost_ranker_692adf) - INFO - Run results saved: results/catboost_ranker_692adf_results.json
2025-05-05 03:42:26,148 - lavka_recsys.Experiment(catboost_ranker_692adf) - INFO - Run finished and results saved.
2025-05-05 03:45:12,356 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 03:45:12,377 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 03:45:12,380 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 03:45:12,405 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 03:45:12,409 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 03:45:25,492 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 03:45:25,515 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 03:45:25,519 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 03:45:25,545 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 03:45:25,549 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 03:46:39,940 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_e2cea473ae2de94a90929a1d8c5e4952.pkl
2025-05-05 03:46:41,069 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 03:49:43,327 - lavka_recsys.Experiment(catboost_ranker_a9c699) - INFO - Initialized experiment: catboost_ranker_a9c699
2025-05-05 03:49:43,347 - lavka_recsys.Experiment(catboost_ranker_a9c699) - INFO - Config saved: results/catboost_ranker_a9c699_config.json
2025-05-05 03:49:43,348 - lavka_recsys.Experiment(catboost_ranker_a9c699) - INFO - Setting up experiment environment...
2025-05-05 03:49:43,350 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 03:49:43,630 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 03:49:43,668 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 03:49:43,696 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 03:49:43,878 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 03:49:43,905 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 03:49:43,909 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 03:49:43,909 - lavka_recsys.Experiment(catboost_ranker_a9c699) - INFO - Setup complete.
2025-05-05 03:49:43,911 - lavka_recsys.Experiment(catboost_ranker_a9c699) - INFO - Starting experiment run...
2025-05-05 03:49:44,245 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 03:49:44,268 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 03:49:44,274 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 03:49:44,302 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 03:49:44,305 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 03:49:44,319 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_e2cea473ae2de94a90929a1d8c5e4952.pkl
2025-05-05 03:49:45,387 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 03:49:45,402 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_ac5f5e86f44f608c0d04faf318225b89.pkl
2025-05-05 03:49:46,493 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 03:49:46,496 - lavka_recsys.ModelFactory - INFO - Creating catboost_ranker model with params: {'iterations': 500, 'verbose': 1, 'loss_function': 'YetiRankPairwise', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'custom_metric': ['NDCG:top=10', 'PrecisionAt:top=10', 'RecallAt:top=10'], 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 03:49:46,766 - lavka_recsys.CatBoostRankerModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 03:50:04,896 - lavka_recsys.Experiment(catboost_ranker_692adf) - INFO - Computing predictions...
2025-05-05 03:59:48,614 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Initialized experiment: catboost_classifier_140e76
2025-05-05 03:59:48,622 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Config saved: results/catboost_classifier_140e76_config.json
2025-05-05 03:59:48,623 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Setting up experiment environment...
2025-05-05 03:59:48,624 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 03:59:48,900 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 03:59:48,952 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 03:59:48,980 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 03:59:49,247 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 03:59:49,276 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 03:59:49,281 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 03:59:49,282 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Setup complete.
2025-05-05 03:59:49,283 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Starting experiment run...
2025-05-05 03:59:49,710 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 03:59:49,731 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 03:59:49,734 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 03:59:49,760 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 03:59:49,764 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 03:59:49,778 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_e2cea473ae2de94a90929a1d8c5e4952.pkl
2025-05-05 03:59:51,101 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 03:59:51,115 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_ac5f5e86f44f608c0d04faf318225b89.pkl
2025-05-05 03:59:52,528 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 03:59:52,532 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 500, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 03:59:52,962 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 03:59:56,785 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 04:00:00,298 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 04:00:00,317 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 04:00:00,339 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 04:00:02,222 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 04:00:02,245 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 04:00:02,275 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 04:00:03,917 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoostClassifier model with columns: ['product_total_purchases', 'month', 'days_since_interaction_u_s', 'city_unique_stores', 'user_total_purchases', 'purchases_week_u_p', 'puresvd_cf_score', 'svd_cf_score', 'session_unique_stores', 'mean_interval_days', 'ctr_product', 'interaction_trend', 'hour_of_day', 'session_length', 'views_week_u_p', 'day_of_week', 'count_purchase_u_s', 'session_unique_products', 'most_common_purchase_day', 'purchase_trend', 'user_product_purchase_cross', 'city_total_views', 'session_duration_seconds', 'city_total_purchases', 'day_of_week_relevance', 'store_total_interactions', 'purchase_view_ratio', 'city_total_interactions', 'std_purchase_hour', 'interactions_week_u_p', 'purchases_day_u_p', 'product_total_views', 'avg_purchase_hour', 'store_total_purchases', 'interactions_month_u_p', 'purchases_month_u_p', 'user_store_purchase_cross', 'count_purchase_u_p', 'cart_to_purchase_rate', 'user_product_store_cross', 'product_total_interactions', 'cf_score', 'session_purchases', 'views_month_u_p', 'hour_relevance', 'user_total_interactions', 'store_unique_products', 'product_unique_users', 'views_day_u_p', 'npmi_cf_score', 'user_segment', 'user_total_views', 'store_total_views', 'user_unique_products', 'city_name', 'is_weekend', 'days_since_interaction_u_p', 'source_type', 'interactions_day_u_p'] (cat_columns: ['city_name', 'source_type', 'user_segment'])
2025-05-05 04:01:10,351 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Training completed in 77.80s
2025-05-05 04:01:10,359 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Evaluating on holdout.
2025-05-05 04:01:10,449 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_7ee8d53fe77e25622ba623dcc06b9812.pkl
2025-05-05 04:01:11,711 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 04:01:12,009 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 04:01:12,049 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 04:01:12,067 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 04:01:24,294 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Run results saved: results/catboost_classifier_140e76_results.json
2025-05-05 04:01:24,301 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Run finished and results saved.
2025-05-05 04:03:59,061 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Computing predictions...
2025-05-05 04:06:09,378 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Initialized experiment: catboost_classifier_140e76
2025-05-05 04:06:09,395 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Config saved: results/catboost_classifier_140e76_config.json
2025-05-05 04:06:09,396 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Setting up experiment environment...
2025-05-05 04:06:09,398 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 04:06:09,684 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 04:06:09,745 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 04:06:09,766 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 04:06:10,026 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 04:06:10,053 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 04:06:10,056 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 04:06:10,057 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Setup complete.
2025-05-05 04:06:10,058 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Starting experiment run...
2025-05-05 04:06:10,654 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 04:06:10,675 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 04:06:10,679 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 04:06:10,711 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 04:06:10,716 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 04:06:10,730 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_e2cea473ae2de94a90929a1d8c5e4952.pkl
2025-05-05 04:06:11,971 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 04:06:11,987 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_ac5f5e86f44f608c0d04faf318225b89.pkl
2025-05-05 04:06:13,146 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 04:06:13,154 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 500, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 04:06:13,571 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 04:06:16,903 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 04:06:19,992 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 04:06:20,012 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 04:06:20,035 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 04:06:21,539 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 04:06:21,559 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 04:06:21,583 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 04:06:22,907 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoostClassifier model with columns: ['product_total_purchases', 'month', 'days_since_interaction_u_s', 'city_unique_stores', 'user_total_purchases', 'purchases_week_u_p', 'puresvd_cf_score', 'svd_cf_score', 'session_unique_stores', 'mean_interval_days', 'ctr_product', 'interaction_trend', 'hour_of_day', 'session_length', 'views_week_u_p', 'day_of_week', 'count_purchase_u_s', 'session_unique_products', 'most_common_purchase_day', 'purchase_trend', 'user_product_purchase_cross', 'city_total_views', 'session_duration_seconds', 'city_total_purchases', 'day_of_week_relevance', 'store_total_interactions', 'purchase_view_ratio', 'city_total_interactions', 'std_purchase_hour', 'interactions_week_u_p', 'purchases_day_u_p', 'product_total_views', 'avg_purchase_hour', 'store_total_purchases', 'interactions_month_u_p', 'purchases_month_u_p', 'user_store_purchase_cross', 'count_purchase_u_p', 'cart_to_purchase_rate', 'user_product_store_cross', 'product_total_interactions', 'cf_score', 'session_purchases', 'views_month_u_p', 'hour_relevance', 'user_total_interactions', 'store_unique_products', 'product_unique_users', 'views_day_u_p', 'npmi_cf_score', 'user_segment', 'user_total_views', 'store_total_views', 'user_unique_products', 'city_name', 'is_weekend', 'days_since_interaction_u_p', 'source_type', 'interactions_day_u_p'] (cat_columns: ['city_name', 'source_type', 'user_segment'])
2025-05-05 04:07:27,846 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Training completed in 74.66s
2025-05-05 04:07:27,854 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Evaluating on holdout.
2025-05-05 04:07:27,958 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_7ee8d53fe77e25622ba623dcc06b9812.pkl
2025-05-05 04:07:29,325 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 04:07:29,613 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 04:07:29,649 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 04:07:29,680 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 04:07:42,082 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Run results saved: results/catboost_classifier_140e76_results.json
2025-05-05 04:07:42,086 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Run finished and results saved.
2025-05-05 04:07:58,327 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Computing predictions...
2025-05-05 04:07:58,333 - lavka_recsys.DataLoader - INFO - Holdout data merged back into training data.
2025-05-05 04:07:58,377 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 04:07:58,415 - lavka_recsys.DataLoader - INFO -   history: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 04:07:58,427 - lavka_recsys.DataLoader - INFO -   target: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 04:07:58,442 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_7ee8d53fe77e25622ba623dcc06b9812.pkl
2025-05-05 04:07:59,693 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 04:07:59,696 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 500, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 04:07:59,975 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 04:08:02,942 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 04:08:02,962 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 04:08:02,983 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 04:08:04,446 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoostClassifier model with columns: ['product_total_purchases', 'month', 'days_since_interaction_u_s', 'city_unique_stores', 'user_total_purchases', 'purchases_week_u_p', 'puresvd_cf_score', 'svd_cf_score', 'session_unique_stores', 'mean_interval_days', 'ctr_product', 'interaction_trend', 'hour_of_day', 'session_length', 'views_week_u_p', 'day_of_week', 'count_purchase_u_s', 'session_unique_products', 'most_common_purchase_day', 'purchase_trend', 'user_product_purchase_cross', 'city_total_views', 'session_duration_seconds', 'city_total_purchases', 'day_of_week_relevance', 'store_total_interactions', 'purchase_view_ratio', 'city_total_interactions', 'std_purchase_hour', 'interactions_week_u_p', 'purchases_day_u_p', 'product_total_views', 'avg_purchase_hour', 'store_total_purchases', 'interactions_month_u_p', 'purchases_month_u_p', 'user_store_purchase_cross', 'count_purchase_u_p', 'cart_to_purchase_rate', 'user_product_store_cross', 'product_total_interactions', 'cf_score', 'session_purchases', 'views_month_u_p', 'hour_relevance', 'user_total_interactions', 'store_unique_products', 'product_unique_users', 'views_day_u_p', 'npmi_cf_score', 'user_segment', 'user_total_views', 'store_total_views', 'user_unique_products', 'city_name', 'is_weekend', 'days_since_interaction_u_p', 'source_type', 'interactions_day_u_p'] (cat_columns: ['city_name', 'source_type', 'user_segment'])
2025-05-05 04:10:14,018 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Training completed in 134.32s
2025-05-05 04:10:14,072 - lavka_recsys.DataLoader - INFO - Holdout data merged back into training data.
2025-05-05 04:10:14,128 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 04:10:14,129 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf
2025-05-05 04:10:14,130 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 04:10:14,130 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 04:10:14,419 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 04:10:14,501 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 04:10:15,092 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 04:10:15,482 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 04:10:16,039 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 04:10:17,198 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 04:10:17,612 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 04:10:17,946 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 04:10:18,293 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 04:10:18,876 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_temporal_patterns
2025-05-05 04:10:19,005 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_store
2025-05-05 04:10:19,405 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_features
2025-05-05 04:10:19,428 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_window_user_product
2025-05-05 04:10:19,744 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: session_features
2025-05-05 04:10:22,473 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: frequency_features
2025-05-05 04:10:27,303 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_popularity_trend
2025-05-05 04:10:27,982 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 04:10:28,364 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 04:10:28,698 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 04:10:29,048 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 04:10:29,603 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cross_features
2025-05-05 04:10:29,606 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_segments
2025-05-05 04:10:29,972 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: memory-based-cf
2025-05-05 04:10:31,178 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: npmi-cf
2025-05-05 04:11:03,505 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: puresvd-cf
2025-05-05 04:11:31,936 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: svd-cf
2025-05-05 04:11:33,391 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 04:11:33,394 - lavka_recsys.FeatureFactory - INFO - All column names: {'most_common_purchase_day', 'store_unique_products', 'hour_relevance', 'count_purchase_u_s', 'purchases_day_u_p', 'days_since_interaction_u_s', 'session_unique_products', 'mean_interval_days', 'interaction_trend', 'day_of_week', 'puresvd_cf_score', 'store_total_interactions', 'hour_of_day', 'is_weekend', 'source_type', 'user_unique_products', 'city_name', 'product_total_interactions', 'user_product_purchase_cross', 'user_store_purchase_cross', 'month', 'product_total_views', 'city_total_purchases', 'views_week_u_p', 'interactions_week_u_p', 'session_unique_stores', 'day_of_week_relevance', 'purchase_trend', 'session_purchases', 'cf_score', 'product_unique_users', 'ctr_product', 'avg_purchase_hour', 'user_segment', 'interactions_month_u_p', 'city_total_views', 'user_total_interactions', 'city_unique_stores', 'user_product_store_cross', 'std_purchase_hour', 'purchases_month_u_p', 'session_duration_seconds', 'session_length', 'product_total_purchases', 'cart_to_purchase_rate', 'days_since_interaction_u_p', 'city_total_interactions', 'svd_cf_score', 'store_total_views', 'user_total_purchases', 'purchases_week_u_p', 'count_purchase_u_p', 'purchase_view_ratio', 'user_total_views', 'npmi_cf_score', 'views_day_u_p', 'views_month_u_p', 'store_total_purchases', 'interactions_day_u_p'}
2025-05-05 04:11:33,395 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['city_name', 'user_segment', 'source_type']
2025-05-05 04:11:33,398 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 04:16:41,799 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Computing predictions...
2025-05-05 04:16:41,805 - lavka_recsys.DataLoader - INFO - Holdout data merged back into training data.
2025-05-05 04:16:41,836 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 04:16:41,867 - lavka_recsys.DataLoader - INFO -   history: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 04:16:41,872 - lavka_recsys.DataLoader - INFO -   target: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 04:16:41,906 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 04:16:41,907 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf
2025-05-05 04:16:41,908 - lavka_recsys.FeatureFactory - ERROR - Feature 'source_type' is not registered
2025-05-05 04:16:41,910 - lavka_recsys.FeatureFactory - ERROR - Available features: []
2025-05-05 04:17:37,734 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Initialized experiment: catboost_classifier_140e76
2025-05-05 04:17:37,746 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Config saved: results/catboost_classifier_140e76_config.json
2025-05-05 04:17:37,747 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Setting up experiment environment...
2025-05-05 04:17:37,749 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 04:17:38,008 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 04:17:38,076 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 04:17:38,102 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 04:17:38,281 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 04:17:38,306 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 04:17:38,309 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 04:17:38,310 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Setup complete.
2025-05-05 04:17:38,311 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Starting experiment run...
2025-05-05 04:17:38,639 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 04:17:38,659 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 04:17:38,663 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 04:17:38,687 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 04:17:38,692 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 04:17:38,716 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 04:17:38,718 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf
2025-05-05 04:17:38,719 - lavka_recsys.FeatureFactory - ERROR - Feature 'source_type' is not registered
2025-05-05 04:17:38,720 - lavka_recsys.FeatureFactory - ERROR - Available features: []
2025-05-05 04:17:51,212 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Initialized experiment: catboost_classifier_140e76
2025-05-05 04:17:51,229 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Config saved: results/catboost_classifier_140e76_config.json
2025-05-05 04:17:51,230 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Setting up experiment environment...
2025-05-05 04:17:51,232 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 04:17:51,516 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 04:17:51,569 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 04:17:51,604 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 04:17:51,863 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 04:17:51,894 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 04:17:51,898 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 04:17:51,898 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Setup complete.
2025-05-05 04:17:51,899 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Starting experiment run...
2025-05-05 04:17:52,355 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 04:17:52,378 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 04:17:52,382 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 04:17:52,409 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 04:17:52,413 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 04:17:52,439 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 04:17:52,441 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf
2025-05-05 04:17:52,442 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 04:17:52,442 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 04:17:52,716 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 04:17:52,797 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 04:17:53,236 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 04:17:53,559 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 04:17:53,879 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 04:17:54,762 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 04:17:55,091 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 04:17:55,373 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 04:17:55,642 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 04:17:56,158 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_temporal_patterns
2025-05-05 04:17:56,368 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_store
2025-05-05 04:17:56,709 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_features
2025-05-05 04:17:56,763 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_window_user_product
2025-05-05 04:17:57,184 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: session_features
2025-05-05 04:17:58,839 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: frequency_features
2025-05-05 04:18:02,479 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_popularity_trend
2025-05-05 04:18:03,370 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 04:18:03,858 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 04:18:04,151 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 04:18:04,456 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 04:18:05,015 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cross_features
2025-05-05 04:18:05,023 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_segments
2025-05-05 04:18:05,309 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: memory-based-cf
2025-05-05 04:18:07,370 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: npmi-cf
2025-05-05 04:18:31,249 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: puresvd-cf
2025-05-05 04:18:54,190 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: svd-cf
2025-05-05 04:18:57,848 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 04:18:57,852 - lavka_recsys.FeatureFactory - INFO - All column names: {'user_total_views', 'source_type', 'month', 'std_purchase_hour', 'session_unique_products', 'user_total_purchases', 'purchases_day_u_p', 'day_of_week_relevance', 'hour_of_day', 'user_unique_products', 'count_purchase_u_p', 'puresvd_cf_score', 'cart_to_purchase_rate', 'cf_score', 'session_duration_seconds', 'store_total_interactions', 'user_product_purchase_cross', 'session_purchases', 'product_unique_users', 'days_since_interaction_u_s', 'store_total_purchases', 'is_weekend', 'views_day_u_p', 'most_common_purchase_day', 'count_purchase_u_s', 'purchases_week_u_p', 'interactions_month_u_p', 'avg_purchase_hour', 'user_total_interactions', 'city_name', 'mean_interval_days', 'interactions_week_u_p', 'purchase_view_ratio', 'days_since_interaction_u_p', 'user_store_purchase_cross', 'city_total_purchases', 'city_total_interactions', 'ctr_product', 'hour_relevance', 'user_segment', 'session_unique_stores', 'product_total_views', 'day_of_week', 'purchases_month_u_p', 'interaction_trend', 'npmi_cf_score', 'product_total_purchases', 'user_product_store_cross', 'svd_cf_score', 'store_total_views', 'interactions_day_u_p', 'views_week_u_p', 'city_unique_stores', 'store_unique_products', 'purchase_trend', 'session_length', 'views_month_u_p', 'city_total_views', 'product_total_interactions'}
2025-05-05 04:18:57,853 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['user_segment', 'city_name', 'source_type']
2025-05-05 04:18:57,855 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 04:19:00,688 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_eea2663e747c09fad5b02e705a394f1a.pkl
2025-05-05 04:19:00,782 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 04:19:00,785 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf
2025-05-05 04:19:00,786 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 04:19:00,787 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 04:19:01,312 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 04:19:01,431 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 04:19:01,996 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 04:19:02,497 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 04:19:02,973 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 04:19:03,994 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 04:19:04,365 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 04:19:04,674 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 04:19:04,987 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 04:19:05,506 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_temporal_patterns
2025-05-05 04:19:05,756 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_store
2025-05-05 04:19:06,132 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_features
2025-05-05 04:19:06,183 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_window_user_product
2025-05-05 04:19:06,633 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: session_features
2025-05-05 04:19:08,424 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: frequency_features
2025-05-05 04:19:12,571 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_popularity_trend
2025-05-05 04:19:13,093 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 04:19:13,712 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 04:19:14,004 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 04:19:14,317 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 04:19:14,875 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cross_features
2025-05-05 04:19:14,885 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_segments
2025-05-05 04:19:15,222 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: memory-based-cf
2025-05-05 04:19:17,269 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: npmi-cf
2025-05-05 04:19:44,303 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: puresvd-cf
2025-05-05 04:20:08,680 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: svd-cf
2025-05-05 04:20:12,235 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 04:20:12,239 - lavka_recsys.FeatureFactory - INFO - All column names: {'user_total_views', 'source_type', 'month', 'std_purchase_hour', 'session_unique_products', 'user_total_purchases', 'purchases_day_u_p', 'day_of_week_relevance', 'hour_of_day', 'user_unique_products', 'count_purchase_u_p', 'puresvd_cf_score', 'cart_to_purchase_rate', 'cf_score', 'session_duration_seconds', 'store_total_interactions', 'user_product_purchase_cross', 'session_purchases', 'product_unique_users', 'days_since_interaction_u_s', 'store_total_purchases', 'is_weekend', 'views_day_u_p', 'most_common_purchase_day', 'count_purchase_u_s', 'purchases_week_u_p', 'interactions_month_u_p', 'avg_purchase_hour', 'user_total_interactions', 'city_name', 'mean_interval_days', 'interactions_week_u_p', 'purchase_view_ratio', 'days_since_interaction_u_p', 'user_store_purchase_cross', 'city_total_purchases', 'city_total_interactions', 'ctr_product', 'hour_relevance', 'user_segment', 'session_unique_stores', 'product_total_views', 'day_of_week', 'purchases_month_u_p', 'interaction_trend', 'npmi_cf_score', 'product_total_purchases', 'user_product_store_cross', 'svd_cf_score', 'store_total_views', 'interactions_day_u_p', 'views_week_u_p', 'city_unique_stores', 'store_unique_products', 'purchase_trend', 'session_length', 'views_month_u_p', 'city_total_views', 'product_total_interactions'}
2025-05-05 04:20:12,240 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['user_segment', 'city_name', 'source_type']
2025-05-05 04:20:12,243 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 04:20:15,065 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_0a8474df115bf334998e6bcb7079362b.pkl
2025-05-05 04:20:15,066 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 500, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 04:20:15,413 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 04:20:18,663 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 04:20:21,707 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 04:20:21,751 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 04:20:21,770 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 04:20:23,203 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 04:20:23,229 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 04:20:23,248 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 04:20:24,573 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoostClassifier model with columns: ['user_total_views', 'source_type', 'month', 'std_purchase_hour', 'session_unique_products', 'user_total_purchases', 'purchases_day_u_p', 'day_of_week_relevance', 'hour_of_day', 'user_unique_products', 'count_purchase_u_p', 'puresvd_cf_score', 'cart_to_purchase_rate', 'cf_score', 'session_duration_seconds', 'store_total_interactions', 'user_product_purchase_cross', 'session_purchases', 'product_unique_users', 'days_since_interaction_u_s', 'store_total_purchases', 'is_weekend', 'views_day_u_p', 'most_common_purchase_day', 'count_purchase_u_s', 'purchases_week_u_p', 'interactions_month_u_p', 'avg_purchase_hour', 'user_total_interactions', 'city_name', 'mean_interval_days', 'interactions_week_u_p', 'purchase_view_ratio', 'days_since_interaction_u_p', 'user_store_purchase_cross', 'city_total_purchases', 'city_total_interactions', 'ctr_product', 'hour_relevance', 'user_segment', 'session_unique_stores', 'product_total_views', 'day_of_week', 'purchases_month_u_p', 'interaction_trend', 'npmi_cf_score', 'product_total_purchases', 'user_product_store_cross', 'svd_cf_score', 'store_total_views', 'interactions_day_u_p', 'views_week_u_p', 'city_unique_stores', 'store_unique_products', 'purchase_trend', 'session_length', 'views_month_u_p', 'city_total_views', 'product_total_interactions'] (cat_columns: ['user_segment', 'city_name', 'source_type'])
2025-05-05 04:20:55,334 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Training completed in 40.25s
2025-05-05 04:20:55,339 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Evaluating on holdout.
2025-05-05 04:20:55,400 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 04:20:55,401 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf
2025-05-05 04:20:55,402 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 04:20:55,402 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 04:20:55,847 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 04:20:55,949 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 04:20:56,514 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 04:20:56,916 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 04:20:57,351 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 04:20:58,365 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 04:20:58,696 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 04:20:59,023 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 04:20:59,343 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 04:20:59,935 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_temporal_patterns
2025-05-05 04:21:00,147 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_store
2025-05-05 04:21:00,523 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_features
2025-05-05 04:21:00,571 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_window_user_product
2025-05-05 04:21:00,973 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: session_features
2025-05-05 04:21:02,894 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: frequency_features
2025-05-05 04:21:07,383 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_popularity_trend
2025-05-05 04:21:07,915 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 04:21:08,263 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 04:21:08,583 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 04:21:08,888 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 04:21:09,414 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cross_features
2025-05-05 04:21:09,418 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_segments
2025-05-05 04:21:09,795 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: memory-based-cf
2025-05-05 04:21:11,771 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: npmi-cf
2025-05-05 04:21:46,538 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: puresvd-cf
2025-05-05 04:22:12,787 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: svd-cf
2025-05-05 04:22:16,117 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 04:22:16,120 - lavka_recsys.FeatureFactory - INFO - All column names: {'user_total_views', 'source_type', 'month', 'std_purchase_hour', 'session_unique_products', 'user_total_purchases', 'purchases_day_u_p', 'day_of_week_relevance', 'hour_of_day', 'user_unique_products', 'count_purchase_u_p', 'puresvd_cf_score', 'cart_to_purchase_rate', 'cf_score', 'session_duration_seconds', 'store_total_interactions', 'user_product_purchase_cross', 'session_purchases', 'product_unique_users', 'days_since_interaction_u_s', 'store_total_purchases', 'is_weekend', 'views_day_u_p', 'most_common_purchase_day', 'count_purchase_u_s', 'purchases_week_u_p', 'interactions_month_u_p', 'avg_purchase_hour', 'user_total_interactions', 'city_name', 'mean_interval_days', 'interactions_week_u_p', 'purchase_view_ratio', 'days_since_interaction_u_p', 'user_store_purchase_cross', 'city_total_purchases', 'city_total_interactions', 'ctr_product', 'hour_relevance', 'user_segment', 'session_unique_stores', 'product_total_views', 'day_of_week', 'purchases_month_u_p', 'interaction_trend', 'npmi_cf_score', 'product_total_purchases', 'user_product_store_cross', 'svd_cf_score', 'store_total_views', 'interactions_day_u_p', 'views_week_u_p', 'city_unique_stores', 'store_unique_products', 'purchase_trend', 'session_length', 'views_month_u_p', 'city_total_views', 'product_total_interactions'}
2025-05-05 04:22:16,123 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['user_segment', 'city_name', 'source_type']
2025-05-05 04:22:16,128 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 04:22:18,679 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_1879e9aab22f20d41fd15e001434badd.pkl
2025-05-05 04:22:18,897 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 04:22:18,940 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 04:22:18,964 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 04:22:31,017 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Run results saved: results/catboost_classifier_140e76_results.json
2025-05-05 04:22:31,020 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Run finished and results saved.
2025-05-05 04:25:59,661 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Computing predictions...
2025-05-05 04:25:59,667 - lavka_recsys.DataLoader - INFO - Holdout data merged back into training data.
2025-05-05 04:25:59,703 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 04:25:59,731 - lavka_recsys.DataLoader - INFO -   history: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 04:25:59,736 - lavka_recsys.DataLoader - INFO -   target: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 04:25:59,765 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_1879e9aab22f20d41fd15e001434badd.pkl
2025-05-05 04:26:00,778 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 04:26:00,780 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 110, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 04:26:01,034 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 04:26:04,113 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 04:26:04,133 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 04:26:04,152 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 04:26:05,563 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoostClassifier model with columns: ['user_total_views', 'source_type', 'month', 'std_purchase_hour', 'session_unique_products', 'user_total_purchases', 'purchases_day_u_p', 'day_of_week_relevance', 'hour_of_day', 'user_unique_products', 'count_purchase_u_p', 'puresvd_cf_score', 'cart_to_purchase_rate', 'cf_score', 'session_duration_seconds', 'store_total_interactions', 'user_product_purchase_cross', 'session_purchases', 'product_unique_users', 'days_since_interaction_u_s', 'store_total_purchases', 'is_weekend', 'views_day_u_p', 'most_common_purchase_day', 'count_purchase_u_s', 'purchases_week_u_p', 'interactions_month_u_p', 'avg_purchase_hour', 'user_total_interactions', 'city_name', 'mean_interval_days', 'interactions_week_u_p', 'purchase_view_ratio', 'days_since_interaction_u_p', 'user_store_purchase_cross', 'city_total_purchases', 'city_total_interactions', 'ctr_product', 'hour_relevance', 'user_segment', 'session_unique_stores', 'product_total_views', 'day_of_week', 'purchases_month_u_p', 'interaction_trend', 'npmi_cf_score', 'product_total_purchases', 'user_product_store_cross', 'svd_cf_score', 'store_total_views', 'interactions_day_u_p', 'views_week_u_p', 'city_unique_stores', 'store_unique_products', 'purchase_trend', 'session_length', 'views_month_u_p', 'city_total_views', 'product_total_interactions'] (cat_columns: ['user_segment', 'city_name', 'source_type'])
2025-05-05 04:26:22,089 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Training completed in 21.31s
2025-05-05 04:26:22,134 - lavka_recsys.DataLoader - INFO - Holdout data merged back into training data.
2025-05-05 04:26:22,167 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 04:26:22,169 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf
2025-05-05 04:26:22,169 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 04:26:22,169 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 04:26:22,275 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 04:26:22,347 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 04:26:22,931 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 04:26:23,337 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 04:26:23,749 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 04:26:24,884 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 04:26:25,246 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 04:26:25,584 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 04:26:25,914 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 04:26:26,540 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_temporal_patterns
2025-05-05 04:26:26,700 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_store
2025-05-05 04:26:27,102 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_features
2025-05-05 04:26:27,112 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_window_user_product
2025-05-05 04:26:27,411 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: session_features
2025-05-05 04:26:29,315 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: frequency_features
2025-05-05 04:26:33,911 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_popularity_trend
2025-05-05 04:26:34,495 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 04:26:34,863 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 04:26:35,196 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 04:26:35,516 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 04:26:36,074 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cross_features
2025-05-05 04:26:36,076 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_segments
2025-05-05 04:26:36,420 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: memory-based-cf
2025-05-05 04:26:37,436 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: npmi-cf
2025-05-05 04:27:11,971 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: puresvd-cf
2025-05-05 04:27:38,039 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: svd-cf
2025-05-05 04:27:39,455 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 04:27:39,457 - lavka_recsys.FeatureFactory - INFO - All column names: {'user_total_views', 'source_type', 'month', 'std_purchase_hour', 'session_unique_products', 'user_total_purchases', 'purchases_day_u_p', 'day_of_week_relevance', 'hour_of_day', 'user_unique_products', 'count_purchase_u_p', 'puresvd_cf_score', 'cart_to_purchase_rate', 'cf_score', 'session_duration_seconds', 'store_total_interactions', 'user_product_purchase_cross', 'session_purchases', 'product_unique_users', 'days_since_interaction_u_s', 'store_total_purchases', 'is_weekend', 'views_day_u_p', 'most_common_purchase_day', 'count_purchase_u_s', 'purchases_week_u_p', 'interactions_month_u_p', 'avg_purchase_hour', 'user_total_interactions', 'city_name', 'mean_interval_days', 'interactions_week_u_p', 'purchase_view_ratio', 'days_since_interaction_u_p', 'user_store_purchase_cross', 'city_total_purchases', 'city_total_interactions', 'ctr_product', 'hour_relevance', 'user_segment', 'session_unique_stores', 'product_total_views', 'day_of_week', 'purchases_month_u_p', 'interaction_trend', 'npmi_cf_score', 'product_total_purchases', 'user_product_store_cross', 'svd_cf_score', 'store_total_views', 'interactions_day_u_p', 'views_week_u_p', 'city_unique_stores', 'store_unique_products', 'purchase_trend', 'session_length', 'views_month_u_p', 'city_total_views', 'product_total_interactions'}
2025-05-05 04:27:39,458 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['user_segment', 'city_name', 'source_type']
2025-05-05 04:27:39,527 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 04:27:39,540 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 04:27:39,551 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 11:24:31,402 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Initialized experiment: catboost_classifier_140e76
2025-05-05 11:24:31,411 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Config saved: results/catboost_classifier_140e76_config.json
2025-05-05 11:24:31,412 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Setting up experiment environment...
2025-05-05 11:24:31,413 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 11:24:31,739 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 11:24:31,795 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 11:24:31,840 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 11:24:32,133 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 11:24:32,159 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 11:24:32,164 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 11:24:32,165 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Setup complete.
2025-05-05 11:24:32,166 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Starting experiment run...
2025-05-05 11:24:32,699 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 11:24:32,724 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 11:24:32,727 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 11:24:32,751 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 11:24:32,756 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 11:24:32,781 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_eea2663e747c09fad5b02e705a394f1a.pkl
2025-05-05 11:24:34,143 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 11:24:34,169 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_0a8474df115bf334998e6bcb7079362b.pkl
2025-05-05 11:24:35,424 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 11:24:35,429 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 500, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 11:24:35,805 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 11:24:39,561 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 11:24:43,177 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 11:24:43,202 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 11:24:43,223 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 11:24:45,029 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 11:24:45,051 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 11:24:45,080 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 11:24:46,890 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoostClassifier model with columns: ['user_total_views', 'source_type', 'month', 'std_purchase_hour', 'session_unique_products', 'user_total_purchases', 'purchases_day_u_p', 'day_of_week_relevance', 'hour_of_day', 'user_unique_products', 'count_purchase_u_p', 'puresvd_cf_score', 'cart_to_purchase_rate', 'cf_score', 'session_duration_seconds', 'store_total_interactions', 'user_product_purchase_cross', 'session_purchases', 'product_unique_users', 'days_since_interaction_u_s', 'store_total_purchases', 'is_weekend', 'views_day_u_p', 'most_common_purchase_day', 'count_purchase_u_s', 'purchases_week_u_p', 'interactions_month_u_p', 'avg_purchase_hour', 'user_total_interactions', 'city_name', 'mean_interval_days', 'interactions_week_u_p', 'purchase_view_ratio', 'days_since_interaction_u_p', 'user_store_purchase_cross', 'city_total_purchases', 'city_total_interactions', 'ctr_product', 'hour_relevance', 'user_segment', 'session_unique_stores', 'product_total_views', 'day_of_week', 'purchases_month_u_p', 'interaction_trend', 'npmi_cf_score', 'product_total_purchases', 'user_product_store_cross', 'svd_cf_score', 'store_total_views', 'interactions_day_u_p', 'views_week_u_p', 'city_unique_stores', 'store_unique_products', 'purchase_trend', 'session_length', 'views_month_u_p', 'city_total_views', 'product_total_interactions'] (cat_columns: ['user_segment', 'city_name', 'source_type'])
2025-05-05 11:25:17,909 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Training completed in 42.46s
2025-05-05 11:25:17,914 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Evaluating on holdout.
2025-05-05 11:25:18,027 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_1879e9aab22f20d41fd15e001434badd.pkl
2025-05-05 11:25:19,325 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 11:25:19,635 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 11:25:19,669 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 11:25:19,700 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 11:25:33,495 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Run results saved: results/catboost_classifier_140e76_results.json
2025-05-05 11:25:33,499 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Run finished and results saved.
2025-05-05 11:30:55,498 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Computing predictions...
2025-05-05 11:30:55,506 - lavka_recsys.DataLoader - INFO - Holdout data merged back into training data.
2025-05-05 11:30:55,554 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 11:30:55,608 - lavka_recsys.DataLoader - INFO -   history: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 11:30:55,613 - lavka_recsys.DataLoader - INFO -   target: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 11:30:55,648 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_1879e9aab22f20d41fd15e001434badd.pkl
2025-05-05 11:30:56,957 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 11:30:56,959 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 110, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 11:30:57,213 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 11:31:00,479 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 11:31:00,502 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 11:31:00,523 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 11:31:02,124 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoostClassifier model with columns: ['user_total_views', 'source_type', 'month', 'std_purchase_hour', 'session_unique_products', 'user_total_purchases', 'purchases_day_u_p', 'day_of_week_relevance', 'hour_of_day', 'user_unique_products', 'count_purchase_u_p', 'puresvd_cf_score', 'cart_to_purchase_rate', 'cf_score', 'session_duration_seconds', 'store_total_interactions', 'user_product_purchase_cross', 'session_purchases', 'product_unique_users', 'days_since_interaction_u_s', 'store_total_purchases', 'is_weekend', 'views_day_u_p', 'most_common_purchase_day', 'count_purchase_u_s', 'purchases_week_u_p', 'interactions_month_u_p', 'avg_purchase_hour', 'user_total_interactions', 'city_name', 'mean_interval_days', 'interactions_week_u_p', 'purchase_view_ratio', 'days_since_interaction_u_p', 'user_store_purchase_cross', 'city_total_purchases', 'city_total_interactions', 'ctr_product', 'hour_relevance', 'user_segment', 'session_unique_stores', 'product_total_views', 'day_of_week', 'purchases_month_u_p', 'interaction_trend', 'npmi_cf_score', 'product_total_purchases', 'user_product_store_cross', 'svd_cf_score', 'store_total_views', 'interactions_day_u_p', 'views_week_u_p', 'city_unique_stores', 'store_unique_products', 'purchase_trend', 'session_length', 'views_month_u_p', 'city_total_views', 'product_total_interactions'] (cat_columns: ['user_segment', 'city_name', 'source_type'])
2025-05-05 11:31:20,510 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Training completed in 23.55s
2025-05-05 11:31:20,559 - lavka_recsys.DataLoader - INFO - Holdout data merged back into training data.
2025-05-05 11:31:20,588 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 11:31:20,590 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf
2025-05-05 11:31:20,590 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 11:31:20,590 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 11:31:20,840 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 11:31:20,908 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 11:31:21,531 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 11:31:21,961 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 11:31:22,529 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 11:31:23,772 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 11:31:24,262 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 11:31:24,652 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 11:31:24,985 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 11:31:25,566 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_temporal_patterns
2025-05-05 11:31:25,710 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_store
2025-05-05 11:31:26,218 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_features
2025-05-05 11:31:26,228 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_window_user_product
2025-05-05 11:31:26,535 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: session_features
2025-05-05 11:31:28,517 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: frequency_features
2025-05-05 11:31:34,195 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_popularity_trend
2025-05-05 11:31:34,774 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 11:31:35,133 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 11:31:35,489 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 11:31:35,805 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 11:31:36,358 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cross_features
2025-05-05 11:31:36,359 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_segments
2025-05-05 11:31:36,750 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: memory-based-cf
2025-05-05 11:31:38,019 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: npmi-cf
2025-05-05 11:32:11,297 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: puresvd-cf
2025-05-05 11:32:42,410 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: svd-cf
2025-05-05 11:32:44,004 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 11:32:44,007 - lavka_recsys.FeatureFactory - INFO - All column names: {'city_total_interactions', 'count_purchase_u_s', 'hour_of_day', 'store_total_views', 'source_type', 'count_purchase_u_p', 'user_unique_products', 'cart_to_purchase_rate', 'session_length', 'interaction_trend', 'user_product_purchase_cross', 'city_total_purchases', 'city_unique_stores', 'user_product_store_cross', 'is_weekend', 'user_segment', 'interactions_day_u_p', 'session_duration_seconds', 'city_name', 'product_unique_users', 'store_unique_products', 'product_total_purchases', 'avg_purchase_hour', 'std_purchase_hour', 'purchase_view_ratio', 'user_total_purchases', 'purchase_trend', 'views_day_u_p', 'session_purchases', 'purchases_week_u_p', 'user_total_interactions', 'day_of_week', 'user_store_purchase_cross', 'interactions_week_u_p', 'svd_cf_score', 'user_total_views', 'puresvd_cf_score', 'days_since_interaction_u_p', 'product_total_interactions', 'store_total_interactions', 'most_common_purchase_day', 'ctr_product', 'session_unique_products', 'interactions_month_u_p', 'views_month_u_p', 'cf_score', 'views_week_u_p', 'day_of_week_relevance', 'city_total_views', 'month', 'purchases_day_u_p', 'mean_interval_days', 'store_total_purchases', 'npmi_cf_score', 'hour_relevance', 'days_since_interaction_u_s', 'purchases_month_u_p', 'product_total_views', 'session_unique_stores'}
2025-05-05 11:32:44,008 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['city_name', 'user_segment', 'source_type']
2025-05-05 11:32:44,082 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 11:32:44,095 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 11:32:44,106 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 11:32:44,552 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Submission saved: results/submissions/catboost_classifier_140e76_submission.csv
2025-05-05 11:32:44,593 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Submission model saved: results/submissions/catboost_classifier_140e76_model.pkl
2025-05-05 11:38:57,101 - lavka_recsys.Experiment(catboost_classifier_6810b4) - INFO - Initialized experiment: catboost_classifier_6810b4
2025-05-05 11:38:57,111 - lavka_recsys.Experiment(catboost_classifier_6810b4) - INFO - Config saved: results/catboost_classifier_6810b4_config.json
2025-05-05 11:38:57,236 - lavka_recsys.Experiment(catboost_classifier_6810b4) - INFO - Setting up experiment environment...
2025-05-05 11:38:57,238 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 11:38:57,606 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 11:38:57,686 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 11:38:57,702 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 11:38:57,848 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 11:38:57,874 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 11:38:57,878 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 11:38:57,879 - lavka_recsys.Experiment(catboost_classifier_6810b4) - INFO - Setup complete.
2025-05-05 11:38:57,880 - lavka_recsys.Experiment(catboost_classifier_6810b4) - INFO - Starting experiment run...
2025-05-05 11:38:58,122 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 11:38:58,144 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 11:38:58,148 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 11:38:58,173 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 11:38:58,176 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 11:38:58,205 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 11:38:58,206 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio
2025-05-05 11:38:58,207 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 11:38:58,208 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 11:38:58,464 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 11:38:58,593 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 11:38:59,240 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 11:38:59,685 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 11:39:00,089 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 11:39:00,090 - lavka_recsys.FeatureFactory - INFO - All column names: {'count_purchase_u_s', 'source_type', 'count_purchase_u_p', 'cart_to_purchase_rate', 'purchase_view_ratio', 'ctr_product'}
2025-05-05 11:39:00,091 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type']
2025-05-05 11:39:00,092 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 11:39:01,307 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_879c7d36348127b9d7af9923a7ce71aa.pkl
2025-05-05 11:39:01,334 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 11:39:01,335 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio
2025-05-05 11:39:01,337 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 11:39:01,337 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 11:39:01,715 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 11:39:01,799 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 11:39:02,223 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 11:39:02,664 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 11:39:03,056 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 11:39:03,058 - lavka_recsys.FeatureFactory - INFO - All column names: {'count_purchase_u_s', 'source_type', 'count_purchase_u_p', 'cart_to_purchase_rate', 'purchase_view_ratio', 'ctr_product'}
2025-05-05 11:39:03,060 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type']
2025-05-05 11:39:03,063 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 11:39:04,406 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_5dfa3b2714322e2031c534298178f055.pkl
2025-05-05 11:39:04,407 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 500, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 11:39:04,524 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 11:39:07,070 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 11:39:09,810 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 11:39:10,939 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 11:39:11,894 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoostClassifier model with columns: ['count_purchase_u_s', 'source_type', 'count_purchase_u_p', 'cart_to_purchase_rate', 'purchase_view_ratio', 'ctr_product'] (cat_columns: ['source_type'])
2025-05-05 11:39:43,407 - lavka_recsys.Experiment(catboost_classifier_6810b4) - INFO - Training completed in 39.00s
2025-05-05 11:39:43,409 - lavka_recsys.Experiment(catboost_classifier_6810b4) - INFO - Evaluating on holdout.
2025-05-05 11:39:43,484 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 11:39:43,486 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio
2025-05-05 11:39:43,487 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 11:39:43,487 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 11:39:43,826 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 11:39:43,918 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 11:39:44,378 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 11:39:44,823 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 11:39:45,256 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 11:39:45,257 - lavka_recsys.FeatureFactory - INFO - All column names: {'count_purchase_u_s', 'source_type', 'count_purchase_u_p', 'cart_to_purchase_rate', 'purchase_view_ratio', 'ctr_product'}
2025-05-05 11:39:45,258 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type']
2025-05-05 11:39:45,259 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 11:39:46,440 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_b40166dddc5fba496941f5f8db2e6539.pkl
2025-05-05 11:39:46,534 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 11:39:59,655 - lavka_recsys.Experiment(catboost_classifier_6810b4) - INFO - Run results saved: results/catboost_classifier_6810b4_results.json
2025-05-05 11:39:59,660 - lavka_recsys.Experiment(catboost_classifier_6810b4) - INFO - Run finished and results saved.
2025-05-05 11:40:51,656 - lavka_recsys.Experiment(catboost_classifier_79beb2) - INFO - Initialized experiment: catboost_classifier_79beb2
2025-05-05 11:40:51,666 - lavka_recsys.Experiment(catboost_classifier_79beb2) - INFO - Config saved: results/catboost_classifier_79beb2_config.json
2025-05-05 11:40:51,920 - lavka_recsys.Experiment(catboost_classifier_79beb2) - INFO - Setting up experiment environment...
2025-05-05 11:40:51,935 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 11:40:52,158 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 11:40:52,227 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 11:40:52,247 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 11:40:52,386 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 11:40:52,439 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 11:40:52,443 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 11:40:52,445 - lavka_recsys.Experiment(catboost_classifier_79beb2) - INFO - Setup complete.
2025-05-05 11:40:52,446 - lavka_recsys.Experiment(catboost_classifier_79beb2) - INFO - Starting experiment run...
2025-05-05 11:40:52,765 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 11:40:52,786 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 11:40:52,790 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 11:40:52,817 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 11:40:52,821 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 11:40:52,846 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 11:40:52,847 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product
2025-05-05 11:40:52,847 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 11:40:52,847 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 11:40:53,070 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 11:40:53,072 - lavka_recsys.FeatureFactory - INFO - All column names: {'source_type', 'count_purchase_u_p'}
2025-05-05 11:40:53,074 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type']
2025-05-05 11:40:53,078 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 11:40:54,205 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_aa8cb783deb7d34845d9cb287f90ff11.pkl
2025-05-05 11:40:54,230 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 11:40:54,231 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product
2025-05-05 11:40:54,232 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 11:40:54,233 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 11:40:54,469 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 11:40:54,471 - lavka_recsys.FeatureFactory - INFO - All column names: {'source_type', 'count_purchase_u_p'}
2025-05-05 11:40:54,473 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type']
2025-05-05 11:40:54,476 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 11:40:55,623 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_7379eb788b28b2e3ba319b4f7a6d34f3.pkl
2025-05-05 11:40:55,624 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 500, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 11:40:55,749 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 11:40:58,404 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 11:41:01,095 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 11:41:02,355 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 11:41:03,504 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoostClassifier model with columns: ['source_type', 'count_purchase_u_p'] (cat_columns: ['source_type'])
2025-05-05 11:41:20,975 - lavka_recsys.Experiment(catboost_classifier_79beb2) - INFO - Training completed in 25.35s
2025-05-05 11:41:20,979 - lavka_recsys.Experiment(catboost_classifier_79beb2) - INFO - Evaluating on holdout.
2025-05-05 11:41:21,017 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 11:41:21,018 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product
2025-05-05 11:41:21,019 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 11:41:21,019 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 11:41:21,237 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 11:41:21,239 - lavka_recsys.FeatureFactory - INFO - All column names: {'source_type', 'count_purchase_u_p'}
2025-05-05 11:41:21,240 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type']
2025-05-05 11:41:21,242 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 11:41:22,421 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_37d2a6f2ecddf1a9099e1e8523bb45bd.pkl
2025-05-05 11:41:22,504 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 11:41:35,187 - lavka_recsys.Experiment(catboost_classifier_79beb2) - INFO - Run results saved: results/catboost_classifier_79beb2_results.json
2025-05-05 11:41:35,188 - lavka_recsys.Experiment(catboost_classifier_79beb2) - INFO - Run finished and results saved.
2025-05-05 11:46:38,903 - lavka_recsys.Experiment(catboost_classifier_79beb2) - INFO - Computing predictions...
2025-05-05 11:46:38,910 - lavka_recsys.DataLoader - INFO - Holdout data merged back into training data.
2025-05-05 11:46:38,946 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 11:46:38,974 - lavka_recsys.DataLoader - INFO -   history: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 11:46:38,978 - lavka_recsys.DataLoader - INFO -   target: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 11:46:39,008 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_37d2a6f2ecddf1a9099e1e8523bb45bd.pkl
2025-05-05 11:46:39,137 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 11:46:39,139 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 18, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 11:46:39,239 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 11:46:41,592 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 11:46:42,658 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoostClassifier model with columns: ['source_type', 'count_purchase_u_p'] (cat_columns: ['source_type'])
2025-05-05 11:46:44,954 - lavka_recsys.Experiment(catboost_classifier_79beb2) - INFO - Training completed in 5.81s
2025-05-05 11:46:44,988 - lavka_recsys.DataLoader - INFO - Holdout data merged back into training data.
2025-05-05 11:46:45,018 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 11:46:45,019 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product
2025-05-05 11:46:45,020 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 11:46:45,020 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 11:46:45,131 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 11:46:45,132 - lavka_recsys.FeatureFactory - INFO - All column names: {'source_type', 'count_purchase_u_p'}
2025-05-05 11:46:45,133 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type']
2025-05-05 11:46:45,171 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 11:46:45,340 - lavka_recsys.Experiment(catboost_classifier_79beb2) - INFO - Submission saved: results/submissions/catboost_classifier_79beb2_submission.csv
2025-05-05 11:46:45,399 - lavka_recsys.Experiment(catboost_classifier_79beb2) - INFO - Submission model saved: results/submissions/catboost_classifier_79beb2_model.pkl
2025-05-05 12:00:48,755 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Initialized experiment: random_baseline_f11639
2025-05-05 12:00:48,763 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Config saved: results/random_baseline_f11639_config.json
2025-05-05 12:00:48,764 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Setting up experiment environment...
2025-05-05 12:00:48,765 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 12:00:49,029 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 12:00:49,068 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 12:00:49,078 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 12:00:49,198 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 12:00:49,224 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 12:00:49,228 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 12:00:49,229 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Setup complete.
2025-05-05 12:00:49,229 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Starting experiment run...
2025-05-05 12:00:49,544 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 12:00:49,565 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 12:00:49,569 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 12:00:49,594 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 12:00:49,600 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 12:00:49,632 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_aa8cb783deb7d34845d9cb287f90ff11.pkl
2025-05-05 12:00:49,788 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 12:00:49,821 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_7379eb788b28b2e3ba319b4f7a6d34f3.pkl
2025-05-05 12:00:49,961 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 12:01:03,634 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Initialized experiment: random_baseline_f11639
2025-05-05 12:01:03,643 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Config saved: results/random_baseline_f11639_config.json
2025-05-05 12:01:03,645 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Setting up experiment environment...
2025-05-05 12:01:03,646 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 12:01:03,982 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 12:01:04,045 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 12:01:04,075 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 12:01:04,355 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 12:01:04,383 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 12:01:04,387 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 12:01:04,388 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Setup complete.
2025-05-05 12:01:04,388 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Starting experiment run...
2025-05-05 12:01:04,884 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 12:01:04,906 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 12:01:04,910 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 12:01:04,936 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 12:01:04,942 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 12:01:04,969 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_aa8cb783deb7d34845d9cb287f90ff11.pkl
2025-05-05 12:01:05,135 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 12:01:05,162 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_7379eb788b28b2e3ba319b4f7a6d34f3.pkl
2025-05-05 12:01:05,315 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 12:01:05,318 - lavka_recsys.ModelFactory - INFO - Creating random_baseline model with params: {'task_type': 'CPU', 'thread_count': -1}
2025-05-05 12:01:05,319 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Training completed in 0.00s
2025-05-05 12:01:05,321 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Evaluating on holdout.
2025-05-05 12:01:05,353 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_37d2a6f2ecddf1a9099e1e8523bb45bd.pkl
2025-05-05 12:01:05,478 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 12:01:17,357 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Run results saved: results/random_baseline_f11639_results.json
2025-05-05 12:01:17,363 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Run finished and results saved.
