2025-05-05 02:26:12,423 - lavka_recsys.Experiment(catboost_classifier_2f618b) - INFO - Initialized experiment: catboost_classifier_2f618b
2025-05-05 02:26:12,438 - lavka_recsys.Experiment(catboost_classifier_2f618b) - INFO - Config saved: results/full_experiment_20250505_022520/classifier/catboost_classifier_2f618b_config.json
2025-05-05 02:26:12,439 - lavka_recsys.Experiment(catboost_classifier_2f618b) - INFO - Setting up experiment environment...
2025-05-05 02:27:05,086 - lavka_recsys.Experiment(catboost_classifier_b029b8) - INFO - Initialized experiment: catboost_classifier_b029b8
2025-05-05 02:27:05,097 - lavka_recsys.Experiment(catboost_classifier_b029b8) - INFO - Config saved: results/full_experiment_20250505_022701/classifier/catboost_classifier_b029b8_config.json
2025-05-05 02:27:05,097 - lavka_recsys.Experiment(catboost_classifier_b029b8) - INFO - Setting up experiment environment...
2025-05-05 02:27:05,098 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 02:27:05,409 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 02:27:05,463 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:27:05,504 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:27:05,758 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 02:27:05,785 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15070276 rows)
2025-05-05 02:27:05,789 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1438338 rows)
2025-05-05 02:27:05,792 - lavka_recsys.Experiment(catboost_classifier_b029b8) - INFO - Setup complete.
2025-05-05 02:27:05,793 - lavka_recsys.Experiment(catboost_classifier_b029b8) - INFO - Starting experiment run...
2025-05-05 02:27:06,345 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 02:27:06,368 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12082523 rows)
2025-05-05 02:27:06,372 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1498126 rows)
2025-05-05 02:27:06,404 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13580649 rows)
2025-05-05 02:27:06,409 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1489627 rows)
2025-05-05 02:27:06,423 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 02:27:06,424 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf, product_embeddings, category_embeddings, user_product_distance, text_similarity_cluster, text_diversity_features
2025-05-05 02:27:06,425 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 02:27:06,425 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 02:27:06,784 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 02:27:06,889 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 02:27:07,343 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 02:27:07,713 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 02:27:08,345 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 02:27:09,507 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 02:27:09,837 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 02:27:10,177 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 02:27:10,462 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 02:27:10,993 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_temporal_patterns
2025-05-05 02:27:11,233 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_store
2025-05-05 02:27:11,646 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_features
2025-05-05 02:27:11,683 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_window_user_product
2025-05-05 02:27:12,256 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: session_features
2025-05-05 02:27:13,917 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: frequency_features
2025-05-05 02:27:17,906 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_popularity_trend
2025-05-05 02:27:18,369 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 02:27:18,728 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 02:27:19,010 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 02:27:19,258 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 02:27:19,750 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cross_features
2025-05-05 02:27:19,756 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_segments
2025-05-05 02:27:20,062 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: memory-based-cf
2025-05-05 02:27:22,142 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: npmi-cf
2025-05-05 02:27:46,412 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: puresvd-cf
2025-05-05 02:28:10,045 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: svd-cf
2025-05-05 02:28:13,883 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_embeddings
2025-05-05 02:28:13,894 - lavka_recsys.TextProcessor - ERROR - sentence-transformers not available. Install with: pip install sentence-transformers
2025-05-05 02:28:14,480 - lavka_recsys.TextProcessor - WARNING - No text model loaded. Returning zero embeddings.
2025-05-05 02:28:14,543 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: category_embeddings
2025-05-05 02:28:14,560 - lavka_recsys.TextProcessor - ERROR - sentence-transformers not available. Install with: pip install sentence-transformers
2025-05-05 02:28:14,881 - lavka_recsys.TextProcessor - WARNING - No text model loaded. Returning zero embeddings.
2025-05-05 02:28:14,924 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_product_distance
2025-05-05 02:28:14,942 - lavka_recsys.TextProcessor - ERROR - sentence-transformers not available. Install with: pip install sentence-transformers
2025-05-05 02:28:15,316 - lavka_recsys.TextProcessor - WARNING - No text model loaded. Returning zero embeddings.
2025-05-05 02:28:52,085 - lavka_recsys.Experiment(catboost_classifier_bad914) - INFO - Initialized experiment: catboost_classifier_bad914
2025-05-05 02:28:52,094 - lavka_recsys.Experiment(catboost_classifier_bad914) - INFO - Config saved: results/full_experiment_20250505_022701/classifier/catboost_classifier_bad914_config.json
2025-05-05 02:28:52,096 - lavka_recsys.Experiment(catboost_classifier_bad914) - INFO - Setting up experiment environment...
2025-05-05 02:28:52,097 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 02:28:52,362 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 02:28:52,426 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:28:52,445 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:28:52,653 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 02:28:52,681 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15070276 rows)
2025-05-05 02:28:52,685 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1438338 rows)
2025-05-05 02:28:52,686 - lavka_recsys.Experiment(catboost_classifier_bad914) - INFO - Setup complete.
2025-05-05 02:28:52,687 - lavka_recsys.Experiment(catboost_classifier_bad914) - INFO - Starting experiment run...
2025-05-05 02:28:53,036 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 02:28:53,059 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12082523 rows)
2025-05-05 02:28:53,063 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1498126 rows)
2025-05-05 02:28:53,089 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13580649 rows)
2025-05-05 02:28:53,094 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1489627 rows)
2025-05-05 02:28:53,108 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 02:28:53,110 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf, product_embeddings, category_embeddings
2025-05-05 02:28:53,111 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 02:28:53,111 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 02:28:53,505 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 02:28:53,590 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 02:28:54,197 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 02:28:54,564 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 02:28:54,942 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 02:28:55,897 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 02:28:56,203 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 02:28:56,499 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 02:28:56,774 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 02:28:57,212 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_temporal_patterns
2025-05-05 02:28:57,373 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_store
2025-05-05 02:28:57,706 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_features
2025-05-05 02:28:57,747 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_window_user_product
2025-05-05 02:28:58,127 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: session_features
2025-05-05 02:28:59,957 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: frequency_features
2025-05-05 02:29:03,819 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_popularity_trend
2025-05-05 02:29:04,295 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 02:29:04,569 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 02:29:04,859 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 02:29:05,136 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 02:29:05,690 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cross_features
2025-05-05 02:29:05,697 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_segments
2025-05-05 02:29:05,984 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: memory-based-cf
2025-05-05 02:29:07,875 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: npmi-cf
2025-05-05 02:29:35,497 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: puresvd-cf
2025-05-05 02:29:58,146 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: svd-cf
2025-05-05 02:30:01,803 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_embeddings
2025-05-05 02:30:01,813 - lavka_recsys.TextProcessor - ERROR - sentence-transformers not available. Install with: pip install sentence-transformers
2025-05-05 02:30:02,282 - lavka_recsys.TextProcessor - WARNING - No text model loaded. Returning zero embeddings.
2025-05-05 02:30:02,328 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: category_embeddings
2025-05-05 02:30:02,339 - lavka_recsys.TextProcessor - ERROR - sentence-transformers not available. Install with: pip install sentence-transformers
2025-05-05 02:30:02,604 - lavka_recsys.TextProcessor - WARNING - No text model loaded. Returning zero embeddings.
2025-05-05 02:30:02,630 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 02:30:02,631 - lavka_recsys.FeatureFactory - INFO - All column names: {'user_store_purchase_cross', 'user_total_views', 'user_product_store_cross', 'cart_to_purchase_rate', 'product_embed_5', 'category_embed_0', 'category_embed_1', 'session_unique_stores', 'cf_score', 'product_unique_users', 'product_embed_2', 'product_total_purchases', 'purchase_trend', 'user_product_purchase_cross', 'views_week_u_p', 'most_common_purchase_day', 'hour_relevance', 'category_embed_8', 'purchases_month_u_p', 'product_embed_9', 'purchases_week_u_p', 'category_embed_3', 'store_total_interactions', 'product_embed_7', 'day_of_week', 'avg_purchase_hour', 'is_weekend', 'product_embed_3', 'count_purchase_u_s', 'month', 'product_total_views', 'interaction_trend', 'store_unique_products', 'session_unique_products', 'product_embed_6', 'city_total_purchases', 'product_embed_8', 'puresvd_cf_score', 'category_embed_7', 'category_embed_2', 'day_of_week_relevance', 'count_purchase_u_p', 'interactions_month_u_p', 'std_purchase_hour', 'session_duration_seconds', 'category_embed_4', 'product_total_interactions', 'user_total_interactions', 'interactions_day_u_p', 'category_embed_6', 'svd_cf_score', 'product_embed_0', 'interactions_week_u_p', 'product_embed_4', 'city_unique_stores', 'npmi_cf_score', 'session_purchases', 'category_embed_9', 'user_unique_products', 'category_embed_5', 'last_interaction_u_p', 'source_type', 'last_interaction_u_s', 'purchase_view_ratio', 'session_length', 'city_name', 'city_total_interactions', 'city_total_views', 'views_month_u_p', 'views_day_u_p', 'purchases_day_u_p', 'store_total_views', 'product_embed_1', 'user_segment', 'mean_interval_days', 'ctr_product', 'user_total_purchases', 'hour_of_day', 'store_total_purchases'}
2025-05-05 02:30:02,632 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['user_segment', 'source_type', 'city_name']
2025-05-05 02:33:36,275 - lavka_recsys.Experiment(catboost_classifier_8b6f1c) - INFO - Initialized experiment: catboost_classifier_8b6f1c
2025-05-05 02:33:36,286 - lavka_recsys.Experiment(catboost_classifier_8b6f1c) - INFO - Config saved: results/full_experiment_20250505_022701/classifier/catboost_classifier_8b6f1c_config.json
2025-05-05 02:33:36,287 - lavka_recsys.Experiment(catboost_classifier_8b6f1c) - INFO - Setting up experiment environment...
2025-05-05 02:33:36,289 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 02:33:36,591 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 02:33:36,653 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:33:36,669 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:33:36,847 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 02:33:36,873 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15070276 rows)
2025-05-05 02:33:36,877 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1438338 rows)
2025-05-05 02:33:36,878 - lavka_recsys.Experiment(catboost_classifier_8b6f1c) - INFO - Setup complete.
2025-05-05 02:33:36,879 - lavka_recsys.Experiment(catboost_classifier_8b6f1c) - INFO - Starting experiment run...
2025-05-05 02:33:37,213 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 02:33:37,234 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12082523 rows)
2025-05-05 02:33:37,238 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1498126 rows)
2025-05-05 02:33:37,263 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13580649 rows)
2025-05-05 02:33:37,271 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1489627 rows)
2025-05-05 02:33:37,294 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 02:33:37,295 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf
2025-05-05 02:33:37,296 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 02:33:37,296 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 02:33:37,528 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 02:33:37,601 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 02:33:38,015 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 02:33:38,380 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 02:33:38,715 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 02:33:39,759 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 02:33:40,079 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 02:33:40,346 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 02:33:40,605 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 02:33:41,104 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_temporal_patterns
2025-05-05 02:33:41,258 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_store
2025-05-05 02:33:41,607 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_features
2025-05-05 02:33:41,645 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_window_user_product
2025-05-05 02:33:42,033 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: session_features
2025-05-05 02:33:43,518 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: frequency_features
2025-05-05 02:33:47,970 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_popularity_trend
2025-05-05 02:33:48,519 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 02:33:48,870 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 02:33:49,147 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 02:33:49,421 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 02:33:49,889 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cross_features
2025-05-05 02:33:49,898 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_segments
2025-05-05 02:33:50,222 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: memory-based-cf
2025-05-05 02:33:52,371 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: npmi-cf
2025-05-05 02:34:16,298 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: puresvd-cf
2025-05-05 02:34:38,884 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: svd-cf
2025-05-05 02:34:42,433 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 02:34:42,439 - lavka_recsys.FeatureFactory - INFO - All column names: {'hour_relevance', 'user_unique_products', 'purchases_month_u_p', 'user_store_purchase_cross', 'last_interaction_u_p', 'source_type', 'user_total_views', 'last_interaction_u_s', 'purchases_week_u_p', 'purchase_view_ratio', 'session_unique_products', 'user_product_store_cross', 'city_total_purchases', 'session_length', 'puresvd_cf_score', 'day_of_week_relevance', 'count_purchase_u_p', 'cart_to_purchase_rate', 'store_total_interactions', 'interactions_month_u_p', 'city_name', 'day_of_week', 'city_total_interactions', 'city_total_views', 'views_month_u_p', 'session_unique_stores', 'std_purchase_hour', 'avg_purchase_hour', 'views_day_u_p', 'is_weekend', 'product_total_interactions', 'session_duration_seconds', 'user_total_interactions', 'purchases_day_u_p', 'cf_score', 'interactions_day_u_p', 'store_total_views', 'product_unique_users', 'svd_cf_score', 'product_total_purchases', 'purchase_trend', 'interactions_week_u_p', 'mean_interval_days', 'count_purchase_u_s', 'user_product_purchase_cross', 'city_unique_stores', 'user_segment', 'views_week_u_p', 'npmi_cf_score', 'ctr_product', 'month', 'user_total_purchases', 'product_total_views', 'hour_of_day', 'most_common_purchase_day', 'interaction_trend', 'store_unique_products', 'session_purchases', 'store_total_purchases'}
2025-05-05 02:34:42,440 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['user_segment', 'source_type', 'city_name']
2025-05-05 02:35:43,883 - lavka_recsys.Experiment(catboost_classifier_8b6f1c) - INFO - Initialized experiment: catboost_classifier_8b6f1c
2025-05-05 02:35:43,892 - lavka_recsys.Experiment(catboost_classifier_8b6f1c) - INFO - Config saved: results/full_experiment_20250505_022701/classifier/catboost_classifier_8b6f1c_config.json
2025-05-05 02:35:43,893 - lavka_recsys.Experiment(catboost_classifier_8b6f1c) - INFO - Setting up experiment environment...
2025-05-05 02:35:43,894 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 02:35:44,150 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 02:35:44,200 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:35:44,218 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:35:44,409 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 02:35:44,435 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15070276 rows)
2025-05-05 02:35:44,439 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1438338 rows)
2025-05-05 02:35:44,440 - lavka_recsys.Experiment(catboost_classifier_8b6f1c) - INFO - Setup complete.
2025-05-05 02:35:44,441 - lavka_recsys.Experiment(catboost_classifier_8b6f1c) - INFO - Starting experiment run...
2025-05-05 02:35:44,759 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 02:35:44,787 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12082523 rows)
2025-05-05 02:35:44,791 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1498126 rows)
2025-05-05 02:35:44,816 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13580649 rows)
2025-05-05 02:35:44,820 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1489627 rows)
2025-05-05 02:35:44,833 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 02:35:44,835 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf
2025-05-05 02:35:44,836 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 02:35:44,836 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 02:35:45,117 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 02:35:45,205 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 02:35:45,670 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 02:35:45,999 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 02:35:46,343 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 02:35:47,287 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 02:35:47,585 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 02:35:47,888 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 02:35:48,163 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 02:35:48,638 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_temporal_patterns
2025-05-05 02:35:48,831 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_store
2025-05-05 02:35:49,193 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_features
2025-05-05 02:35:49,245 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_window_user_product
2025-05-05 02:35:49,654 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: session_features
2025-05-05 02:35:51,169 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: frequency_features
2025-05-05 02:36:37,123 - lavka_recsys.Experiment(catboost_classifier_3cb920) - INFO - Initialized experiment: catboost_classifier_3cb920
2025-05-05 02:36:37,147 - lavka_recsys.Experiment(catboost_classifier_3cb920) - INFO - Config saved: results/catboost_classifier_3cb920_config.json
2025-05-05 02:36:37,149 - lavka_recsys.Experiment(catboost_classifier_3cb920) - INFO - Setting up experiment environment...
2025-05-05 02:36:37,150 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 02:36:37,462 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 02:36:37,525 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:36:37,577 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:36:37,802 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 02:36:37,833 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15070276 rows, 367 days)
2025-05-05 02:36:37,837 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1438338 rows, 29 days)
2025-05-05 02:36:37,838 - lavka_recsys.Experiment(catboost_classifier_3cb920) - INFO - Setup complete.
2025-05-05 02:36:37,839 - lavka_recsys.Experiment(catboost_classifier_3cb920) - INFO - Starting experiment run...
2025-05-05 02:36:38,369 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 02:36:38,391 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12082523 rows, 307 days)
2025-05-05 02:36:38,395 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1498126 rows, 29 days)
2025-05-05 02:36:38,421 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13580649 rows, 337 days)
2025-05-05 02:36:38,425 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1489627 rows, 29 days)
2025-05-05 02:36:38,439 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 02:36:38,440 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf
2025-05-05 02:36:38,443 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 02:36:38,443 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 02:36:38,723 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 02:36:38,812 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 02:36:39,275 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 02:36:39,612 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 02:36:39,936 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 02:36:40,941 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 02:36:41,277 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 02:36:41,605 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 02:36:41,961 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 02:36:42,424 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_temporal_patterns
2025-05-05 02:36:42,607 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_store
2025-05-05 02:36:42,962 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_features
2025-05-05 02:36:43,002 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_window_user_product
2025-05-05 02:36:43,391 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: session_features
2025-05-05 02:36:45,306 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: frequency_features
2025-05-05 02:36:49,591 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_popularity_trend
2025-05-05 02:36:50,189 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 02:36:50,503 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 02:36:50,805 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 02:36:51,051 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 02:36:51,554 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cross_features
2025-05-05 02:36:51,571 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_segments
2025-05-05 02:36:51,894 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: memory-based-cf
2025-05-05 02:36:53,880 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: npmi-cf
2025-05-05 02:37:17,692 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: puresvd-cf
2025-05-05 02:37:41,023 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: svd-cf
2025-05-05 02:37:45,024 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 02:37:45,029 - lavka_recsys.FeatureFactory - INFO - All column names: {'purchase_trend', 'session_duration_seconds', 'month', 'days_since_interaction_u_p', 'store_total_views', 'user_product_purchase_cross', 'user_total_views', 'product_unique_users', 'mean_interval_days', 'purchases_day_u_p', 'purchases_week_u_p', 'store_unique_products', 'day_of_week', 'views_month_u_p', 'product_total_interactions', 'user_total_purchases', 'session_unique_products', 'city_total_views', 'views_week_u_p', 'city_unique_stores', 'avg_purchase_hour', 'count_purchase_u_p', 'session_unique_stores', 'product_total_views', 'user_product_store_cross', 'days_since_interaction_u_s', 'svd_cf_score', 'city_total_purchases', 'user_store_purchase_cross', 'is_weekend', 'cart_to_purchase_rate', 'views_day_u_p', 'most_common_purchase_day', 'user_unique_products', 'interactions_day_u_p', 'source_type', 'ctr_product', 'session_length', 'product_total_purchases', 'cf_score', 'count_purchase_u_s', 'interactions_month_u_p', 'user_total_interactions', 'city_name', 'interactions_week_u_p', 'session_purchases', 'hour_relevance', 'city_total_interactions', 'user_segment', 'puresvd_cf_score', 'day_of_week_relevance', 'hour_of_day', 'purchase_view_ratio', 'interaction_trend', 'npmi_cf_score', 'std_purchase_hour', 'purchases_month_u_p', 'store_total_purchases', 'store_total_interactions'}
2025-05-05 02:37:45,030 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type', 'user_segment', 'city_name']
2025-05-05 02:37:45,034 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 02:38:30,146 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Initialized experiment: catboost_classifier_97acd4
2025-05-05 02:38:30,155 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Config saved: results/catboost_classifier_97acd4_config.json
2025-05-05 02:38:30,156 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Setting up experiment environment...
2025-05-05 02:38:30,157 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 02:38:30,481 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 02:38:30,547 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:38:30,583 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:38:30,862 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 02:38:30,890 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 02:38:30,893 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 02:38:30,894 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Setup complete.
2025-05-05 02:38:30,895 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Starting experiment run...
2025-05-05 02:38:31,416 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 02:38:31,440 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 02:38:31,444 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 02:38:31,470 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 02:38:31,474 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 02:38:31,487 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 02:38:31,489 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio
2025-05-05 02:38:31,490 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 02:38:31,490 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 02:38:31,777 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 02:38:31,868 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 02:38:32,319 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 02:38:32,701 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 02:38:33,063 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 02:38:33,064 - lavka_recsys.FeatureFactory - INFO - All column names: {'purchase_view_ratio', 'ctr_product', 'count_purchase_u_s', 'count_purchase_u_p', 'source_type', 'cart_to_purchase_rate'}
2025-05-05 02:38:33,065 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type']
2025-05-05 02:38:33,067 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 02:38:34,412 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_807fd2021581198863b69c022ce940a8.pkl
2025-05-05 02:38:34,426 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 02:38:34,428 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio
2025-05-05 02:38:34,429 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 02:38:34,429 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 02:38:34,657 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 02:38:34,739 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 02:38:35,198 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 02:38:35,668 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 02:38:36,042 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 02:38:36,044 - lavka_recsys.FeatureFactory - INFO - All column names: {'purchase_view_ratio', 'ctr_product', 'count_purchase_u_s', 'count_purchase_u_p', 'source_type', 'cart_to_purchase_rate'}
2025-05-05 02:38:36,045 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type']
2025-05-05 02:38:36,049 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 02:38:37,380 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_a9dd1ab83132447dd6edb0ae14e7330e.pkl
2025-05-05 02:38:37,381 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 500, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 02:38:37,535 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 02:38:38,138 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 02:39:07,106 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Initialized experiment: catboost_classifier_97acd4
2025-05-05 02:39:07,115 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Config saved: results/catboost_classifier_97acd4_config.json
2025-05-05 02:39:07,116 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Setting up experiment environment...
2025-05-05 02:39:07,117 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 02:39:07,437 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 02:39:07,492 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:39:07,538 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:39:07,792 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 02:39:07,816 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 02:39:07,820 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 02:39:07,820 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Setup complete.
2025-05-05 02:39:07,821 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Starting experiment run...
2025-05-05 02:39:08,360 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 02:39:08,381 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 02:39:08,385 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 02:39:08,410 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 02:39:08,414 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 02:39:08,426 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_807fd2021581198863b69c022ce940a8.pkl
2025-05-05 02:39:08,706 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 02:39:08,720 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_a9dd1ab83132447dd6edb0ae14e7330e.pkl
2025-05-05 02:39:08,917 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 02:39:08,919 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 500, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 02:39:09,130 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 02:39:09,759 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 02:39:10,194 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoost model with columns: ['purchase_view_ratio', 'ctr_product', 'count_purchase_u_s', 'count_purchase_u_p', 'source_type', 'cart_to_purchase_rate'] (cat_columns: ['source_type'])
2025-05-05 02:50:18,376 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Initialized experiment: catboost_classifier_97acd4
2025-05-05 02:50:18,385 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Config saved: results/catboost_classifier_97acd4_config.json
2025-05-05 02:50:18,386 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Setting up experiment environment...
2025-05-05 02:50:18,388 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 02:50:18,701 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 02:50:18,755 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:50:18,806 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:50:19,057 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 02:50:19,085 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 02:50:19,089 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 02:50:19,090 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Setup complete.
2025-05-05 02:50:19,092 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Starting experiment run...
2025-05-05 02:50:19,556 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 02:50:19,579 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 02:50:19,582 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 02:50:19,608 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 02:50:19,612 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 02:50:19,626 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_807fd2021581198863b69c022ce940a8.pkl
2025-05-05 02:50:19,878 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 02:50:19,895 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_a9dd1ab83132447dd6edb0ae14e7330e.pkl
2025-05-05 02:50:20,112 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 02:50:20,115 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 500, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 02:50:20,285 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 02:51:41,479 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Initialized experiment: catboost_classifier_97acd4
2025-05-05 02:51:41,487 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Config saved: results/catboost_classifier_97acd4_config.json
2025-05-05 02:51:41,488 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Setting up experiment environment...
2025-05-05 02:51:41,490 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 02:51:41,830 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 02:51:41,892 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:51:41,928 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:51:42,208 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 02:51:42,233 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 02:51:42,237 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 02:51:42,238 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Setup complete.
2025-05-05 02:51:42,239 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Starting experiment run...
2025-05-05 02:51:42,614 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 02:51:42,640 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 02:51:42,644 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 02:51:42,674 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 02:51:42,678 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 02:51:42,694 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_807fd2021581198863b69c022ce940a8.pkl
2025-05-05 02:51:42,963 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 02:51:42,977 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_a9dd1ab83132447dd6edb0ae14e7330e.pkl
2025-05-05 02:51:43,183 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 02:51:43,189 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 500, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 02:51:43,533 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 02:53:07,227 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Initialized experiment: catboost_classifier_97acd4
2025-05-05 02:53:07,236 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Config saved: results/catboost_classifier_97acd4_config.json
2025-05-05 02:53:07,238 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Setting up experiment environment...
2025-05-05 02:53:07,240 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 02:53:07,576 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 02:53:07,631 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:53:07,653 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:53:07,901 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 02:53:07,928 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 02:53:07,932 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 02:53:07,933 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Setup complete.
2025-05-05 02:53:07,934 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Starting experiment run...
2025-05-05 02:53:08,504 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 02:53:08,526 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 02:53:08,529 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 02:53:08,555 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 02:53:08,559 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 02:53:08,577 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_807fd2021581198863b69c022ce940a8.pkl
2025-05-05 02:53:08,805 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 02:53:08,820 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_a9dd1ab83132447dd6edb0ae14e7330e.pkl
2025-05-05 02:53:09,020 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 02:53:09,023 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 500, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 02:53:09,196 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 02:53:44,504 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Initialized experiment: catboost_classifier_97acd4
2025-05-05 02:53:44,513 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Config saved: results/catboost_classifier_97acd4_config.json
2025-05-05 02:53:44,514 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Setting up experiment environment...
2025-05-05 02:53:44,515 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 02:53:44,859 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 02:53:44,928 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:53:44,960 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 02:53:45,254 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 02:53:45,280 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 02:53:45,284 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 02:53:45,285 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Setup complete.
2025-05-05 02:53:45,286 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Starting experiment run...
2025-05-05 02:53:45,774 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 02:53:45,796 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 02:53:45,799 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 02:53:45,826 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 02:53:45,829 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 02:53:45,843 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_807fd2021581198863b69c022ce940a8.pkl
2025-05-05 02:53:46,111 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 02:53:46,134 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_a9dd1ab83132447dd6edb0ae14e7330e.pkl
2025-05-05 02:53:46,332 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 02:53:46,335 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 500, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 02:53:46,502 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 03:21:39,180 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Initialized experiment: catboost_classifier_97acd4
2025-05-05 03:21:39,188 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Config saved: results/catboost_classifier_97acd4_config.json
2025-05-05 03:21:39,190 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Setting up experiment environment...
2025-05-05 03:21:39,192 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 03:21:39,488 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 03:21:39,540 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 03:21:39,573 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 03:21:39,838 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 03:21:39,865 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 03:21:39,868 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 03:21:39,869 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Setup complete.
2025-05-05 03:21:39,871 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Starting experiment run...
2025-05-05 03:21:40,388 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 03:21:40,410 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 03:21:40,416 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 03:21:40,441 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 03:21:40,445 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 03:21:40,458 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_807fd2021581198863b69c022ce940a8.pkl
2025-05-05 03:21:40,685 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 03:21:40,699 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_a9dd1ab83132447dd6edb0ae14e7330e.pkl
2025-05-05 03:21:40,895 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 03:21:40,907 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 500, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 03:21:41,092 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 03:21:43,355 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 03:21:45,653 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 03:21:46,719 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 03:21:47,560 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoost model with columns: ['purchase_view_ratio', 'ctr_product', 'count_purchase_u_s', 'count_purchase_u_p', 'source_type', 'cart_to_purchase_rate'] (cat_columns: ['source_type'])
2025-05-05 03:22:23,800 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Training completed in 42.85s
2025-05-05 03:22:23,803 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Evaluating on holdout.
2025-05-05 03:22:23,901 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 03:22:23,903 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio
2025-05-05 03:22:23,904 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 03:22:23,904 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 03:22:24,429 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 03:22:24,521 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 03:22:25,074 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 03:22:25,545 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 03:22:25,972 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 03:22:25,975 - lavka_recsys.FeatureFactory - INFO - All column names: {'ctr_product', 'cart_to_purchase_rate', 'count_purchase_u_s', 'purchase_view_ratio', 'count_purchase_u_p', 'source_type'}
2025-05-05 03:22:25,976 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type']
2025-05-05 03:22:25,981 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 03:22:27,265 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_19f692debef267747df811cb88093d2c.pkl
2025-05-05 03:23:47,749 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Initialized experiment: catboost_classifier_97acd4
2025-05-05 03:23:47,758 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Config saved: results/catboost_classifier_97acd4_config.json
2025-05-05 03:23:47,760 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Setting up experiment environment...
2025-05-05 03:23:47,761 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 03:23:48,044 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 03:23:48,100 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 03:23:48,139 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 03:23:48,418 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 03:23:48,443 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 03:23:48,446 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 03:23:48,447 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Setup complete.
2025-05-05 03:23:48,448 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Starting experiment run...
2025-05-05 03:23:49,023 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 03:23:49,050 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 03:23:49,054 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 03:23:49,079 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 03:23:49,083 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 03:23:49,098 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_807fd2021581198863b69c022ce940a8.pkl
2025-05-05 03:23:49,329 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 03:23:49,344 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_a9dd1ab83132447dd6edb0ae14e7330e.pkl
2025-05-05 03:23:49,547 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 03:23:49,550 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 500, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 03:23:49,719 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 03:23:51,962 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 03:23:54,093 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 03:23:54,999 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 03:23:55,806 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoost model with columns: ['purchase_view_ratio', 'ctr_product', 'count_purchase_u_s', 'count_purchase_u_p', 'source_type', 'cart_to_purchase_rate'] (cat_columns: ['source_type'])
2025-05-05 03:24:32,260 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Training completed in 42.69s
2025-05-05 03:24:32,264 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Evaluating on holdout.
2025-05-05 03:24:32,361 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_19f692debef267747df811cb88093d2c.pkl
2025-05-05 03:24:32,549 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 03:24:32,689 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 03:24:44,460 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Run results saved: results/catboost_classifier_97acd4_results.json
2025-05-05 03:24:44,465 - lavka_recsys.Experiment(catboost_classifier_97acd4) - INFO - Run finished and results saved.
2025-05-05 03:25:13,049 - lavka_recsys.Experiment(catboost_classifier_3cb920) - INFO - Initialized experiment: catboost_classifier_3cb920
2025-05-05 03:25:13,059 - lavka_recsys.Experiment(catboost_classifier_3cb920) - INFO - Config saved: results/catboost_classifier_3cb920_config.json
2025-05-05 03:25:13,298 - lavka_recsys.Experiment(catboost_classifier_3cb920) - INFO - Setting up experiment environment...
2025-05-05 03:25:13,300 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 03:25:13,773 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 03:25:13,832 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 03:25:13,859 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 03:25:14,047 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 03:25:14,073 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 03:25:14,076 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 03:25:14,077 - lavka_recsys.Experiment(catboost_classifier_3cb920) - INFO - Setup complete.
2025-05-05 03:25:14,078 - lavka_recsys.Experiment(catboost_classifier_3cb920) - INFO - Starting experiment run...
2025-05-05 03:25:14,417 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 03:25:14,440 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 03:25:14,444 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 03:25:14,469 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 03:25:14,473 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 03:25:14,488 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 03:25:14,489 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf
2025-05-05 03:25:14,490 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 03:25:14,490 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 03:25:14,832 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 03:25:14,932 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 03:25:15,439 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 03:25:15,775 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 03:25:16,155 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 03:25:17,079 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 03:25:17,378 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 03:25:17,742 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 03:25:18,024 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 03:25:18,468 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_temporal_patterns
2025-05-05 03:25:18,654 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_store
2025-05-05 03:25:19,022 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_features
2025-05-05 03:25:19,076 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_window_user_product
2025-05-05 03:25:19,491 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: session_features
2025-05-05 03:25:20,971 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: frequency_features
2025-05-05 03:25:24,340 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_popularity_trend
2025-05-05 03:25:24,842 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 03:25:25,148 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 03:25:25,425 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 03:25:25,697 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 03:25:26,168 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cross_features
2025-05-05 03:25:26,178 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_segments
2025-05-05 03:25:26,446 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: memory-based-cf
2025-05-05 03:25:28,485 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: npmi-cf
2025-05-05 03:25:52,457 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: puresvd-cf
2025-05-05 03:26:15,142 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: svd-cf
2025-05-05 03:26:19,048 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 03:26:19,051 - lavka_recsys.FeatureFactory - INFO - All column names: {'product_total_purchases', 'month', 'days_since_interaction_u_s', 'city_unique_stores', 'user_total_purchases', 'purchases_week_u_p', 'puresvd_cf_score', 'svd_cf_score', 'session_unique_stores', 'mean_interval_days', 'ctr_product', 'interaction_trend', 'hour_of_day', 'session_length', 'views_week_u_p', 'day_of_week', 'count_purchase_u_s', 'session_unique_products', 'most_common_purchase_day', 'purchase_trend', 'user_product_purchase_cross', 'city_total_views', 'session_duration_seconds', 'city_total_purchases', 'day_of_week_relevance', 'store_total_interactions', 'purchase_view_ratio', 'city_total_interactions', 'std_purchase_hour', 'interactions_week_u_p', 'purchases_day_u_p', 'product_total_views', 'avg_purchase_hour', 'store_total_purchases', 'interactions_month_u_p', 'purchases_month_u_p', 'user_store_purchase_cross', 'count_purchase_u_p', 'cart_to_purchase_rate', 'user_product_store_cross', 'product_total_interactions', 'cf_score', 'session_purchases', 'views_month_u_p', 'hour_relevance', 'user_total_interactions', 'store_unique_products', 'product_unique_users', 'views_day_u_p', 'npmi_cf_score', 'user_segment', 'user_total_views', 'store_total_views', 'user_unique_products', 'city_name', 'is_weekend', 'days_since_interaction_u_p', 'source_type', 'interactions_day_u_p'}
2025-05-05 03:26:19,052 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['city_name', 'source_type', 'user_segment']
2025-05-05 03:26:19,054 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 03:26:21,662 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_e2cea473ae2de94a90929a1d8c5e4952.pkl
2025-05-05 03:26:21,707 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 03:26:21,709 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf
2025-05-05 03:26:21,710 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 03:26:21,711 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 03:26:22,125 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 03:26:22,242 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 03:26:22,726 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 03:26:23,081 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 03:26:23,467 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 03:26:24,506 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 03:26:24,861 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 03:26:25,307 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 03:26:25,670 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 03:26:26,318 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_temporal_patterns
2025-05-05 03:26:26,541 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_store
2025-05-05 03:26:26,969 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_features
2025-05-05 03:26:27,029 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_window_user_product
2025-05-05 03:26:27,454 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: session_features
2025-05-05 03:26:29,308 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: frequency_features
2025-05-05 03:26:33,522 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_popularity_trend
2025-05-05 03:26:34,050 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 03:26:34,376 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 03:26:34,711 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 03:26:35,054 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 03:26:35,519 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cross_features
2025-05-05 03:26:35,526 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_segments
2025-05-05 03:26:35,850 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: memory-based-cf
2025-05-05 03:26:37,860 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: npmi-cf
2025-05-05 03:27:04,797 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: puresvd-cf
2025-05-05 03:27:30,487 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: svd-cf
2025-05-05 03:27:34,192 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 03:27:34,197 - lavka_recsys.FeatureFactory - INFO - All column names: {'product_total_purchases', 'month', 'days_since_interaction_u_s', 'city_unique_stores', 'user_total_purchases', 'purchases_week_u_p', 'puresvd_cf_score', 'svd_cf_score', 'session_unique_stores', 'mean_interval_days', 'ctr_product', 'interaction_trend', 'hour_of_day', 'session_length', 'views_week_u_p', 'day_of_week', 'count_purchase_u_s', 'session_unique_products', 'most_common_purchase_day', 'purchase_trend', 'user_product_purchase_cross', 'city_total_views', 'session_duration_seconds', 'city_total_purchases', 'day_of_week_relevance', 'store_total_interactions', 'purchase_view_ratio', 'city_total_interactions', 'std_purchase_hour', 'interactions_week_u_p', 'purchases_day_u_p', 'product_total_views', 'avg_purchase_hour', 'store_total_purchases', 'interactions_month_u_p', 'purchases_month_u_p', 'user_store_purchase_cross', 'count_purchase_u_p', 'cart_to_purchase_rate', 'user_product_store_cross', 'product_total_interactions', 'cf_score', 'session_purchases', 'views_month_u_p', 'hour_relevance', 'user_total_interactions', 'store_unique_products', 'product_unique_users', 'views_day_u_p', 'npmi_cf_score', 'user_segment', 'user_total_views', 'store_total_views', 'user_unique_products', 'city_name', 'is_weekend', 'days_since_interaction_u_p', 'source_type', 'interactions_day_u_p'}
2025-05-05 03:27:34,198 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['city_name', 'source_type', 'user_segment']
2025-05-05 03:27:34,204 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 03:27:36,897 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_ac5f5e86f44f608c0d04faf318225b89.pkl
2025-05-05 03:27:36,898 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 500, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 03:27:37,235 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 03:27:40,629 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 03:27:43,635 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 03:27:43,655 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 03:27:43,678 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 03:27:45,217 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 03:27:45,238 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 03:27:45,263 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 03:27:46,694 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoost model with columns: ['product_total_purchases', 'month', 'days_since_interaction_u_s', 'city_unique_stores', 'user_total_purchases', 'purchases_week_u_p', 'puresvd_cf_score', 'svd_cf_score', 'session_unique_stores', 'mean_interval_days', 'ctr_product', 'interaction_trend', 'hour_of_day', 'session_length', 'views_week_u_p', 'day_of_week', 'count_purchase_u_s', 'session_unique_products', 'most_common_purchase_day', 'purchase_trend', 'user_product_purchase_cross', 'city_total_views', 'session_duration_seconds', 'city_total_purchases', 'day_of_week_relevance', 'store_total_interactions', 'purchase_view_ratio', 'city_total_interactions', 'std_purchase_hour', 'interactions_week_u_p', 'purchases_day_u_p', 'product_total_views', 'avg_purchase_hour', 'store_total_purchases', 'interactions_month_u_p', 'purchases_month_u_p', 'user_store_purchase_cross', 'count_purchase_u_p', 'cart_to_purchase_rate', 'user_product_store_cross', 'product_total_interactions', 'cf_score', 'session_purchases', 'views_month_u_p', 'hour_relevance', 'user_total_interactions', 'store_unique_products', 'product_unique_users', 'views_day_u_p', 'npmi_cf_score', 'user_segment', 'user_total_views', 'store_total_views', 'user_unique_products', 'city_name', 'is_weekend', 'days_since_interaction_u_p', 'source_type', 'interactions_day_u_p'] (cat_columns: ['city_name', 'source_type', 'user_segment'])
2025-05-05 03:28:52,302 - lavka_recsys.Experiment(catboost_classifier_3cb920) - INFO - Training completed in 75.40s
2025-05-05 03:28:52,306 - lavka_recsys.Experiment(catboost_classifier_3cb920) - INFO - Evaluating on holdout.
2025-05-05 03:28:52,354 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 03:28:52,355 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf
2025-05-05 03:28:52,356 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 03:28:52,356 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 03:28:52,732 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 03:28:52,836 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 03:28:53,361 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 03:28:53,830 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 03:28:54,217 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 03:28:55,273 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 03:28:55,632 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 03:28:56,020 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 03:28:56,348 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 03:28:56,832 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_temporal_patterns
2025-05-05 03:28:57,007 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_store
2025-05-05 03:28:57,438 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_features
2025-05-05 03:28:57,490 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_window_user_product
2025-05-05 03:28:57,835 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: session_features
2025-05-05 03:28:59,628 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: frequency_features
2025-05-05 03:29:03,912 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_popularity_trend
2025-05-05 03:29:04,440 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 03:29:04,787 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 03:29:05,107 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 03:29:05,426 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 03:29:05,943 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cross_features
2025-05-05 03:29:05,949 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_segments
2025-05-05 03:29:06,280 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: memory-based-cf
2025-05-05 03:29:08,377 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: npmi-cf
2025-05-05 03:29:38,343 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: puresvd-cf
2025-05-05 03:30:04,953 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: svd-cf
2025-05-05 03:30:08,572 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 03:30:08,574 - lavka_recsys.FeatureFactory - INFO - All column names: {'product_total_purchases', 'month', 'days_since_interaction_u_s', 'city_unique_stores', 'user_total_purchases', 'purchases_week_u_p', 'puresvd_cf_score', 'svd_cf_score', 'session_unique_stores', 'mean_interval_days', 'ctr_product', 'interaction_trend', 'hour_of_day', 'session_length', 'views_week_u_p', 'day_of_week', 'count_purchase_u_s', 'session_unique_products', 'most_common_purchase_day', 'purchase_trend', 'user_product_purchase_cross', 'city_total_views', 'session_duration_seconds', 'city_total_purchases', 'day_of_week_relevance', 'store_total_interactions', 'purchase_view_ratio', 'city_total_interactions', 'std_purchase_hour', 'interactions_week_u_p', 'purchases_day_u_p', 'product_total_views', 'avg_purchase_hour', 'store_total_purchases', 'interactions_month_u_p', 'purchases_month_u_p', 'user_store_purchase_cross', 'count_purchase_u_p', 'cart_to_purchase_rate', 'user_product_store_cross', 'product_total_interactions', 'cf_score', 'session_purchases', 'views_month_u_p', 'hour_relevance', 'user_total_interactions', 'store_unique_products', 'product_unique_users', 'views_day_u_p', 'npmi_cf_score', 'user_segment', 'user_total_views', 'store_total_views', 'user_unique_products', 'city_name', 'is_weekend', 'days_since_interaction_u_p', 'source_type', 'interactions_day_u_p'}
2025-05-05 03:30:08,576 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['city_name', 'source_type', 'user_segment']
2025-05-05 03:30:08,579 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 03:30:11,051 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_7ee8d53fe77e25622ba623dcc06b9812.pkl
2025-05-05 03:30:11,290 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 03:30:11,325 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 03:30:11,343 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 03:30:23,925 - lavka_recsys.Experiment(catboost_classifier_3cb920) - INFO - Run results saved: results/catboost_classifier_3cb920_results.json
2025-05-05 03:30:23,927 - lavka_recsys.Experiment(catboost_classifier_3cb920) - INFO - Run finished and results saved.
2025-05-05 03:31:24,963 - lavka_recsys.Experiment(catboost_ranker_692adf) - INFO - Initialized experiment: catboost_ranker_692adf
2025-05-05 03:31:24,973 - lavka_recsys.Experiment(catboost_ranker_692adf) - INFO - Config saved: results/catboost_ranker_692adf_config.json
2025-05-05 03:31:24,975 - lavka_recsys.Experiment(catboost_ranker_692adf) - INFO - Setting up experiment environment...
2025-05-05 03:31:24,976 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 03:31:25,220 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 03:31:25,282 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 03:31:25,307 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 03:31:25,469 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 03:31:25,495 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 03:31:25,498 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 03:31:25,499 - lavka_recsys.Experiment(catboost_ranker_692adf) - INFO - Setup complete.
2025-05-05 03:31:25,500 - lavka_recsys.Experiment(catboost_ranker_692adf) - INFO - Starting experiment run...
2025-05-05 03:31:25,789 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 03:31:25,813 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 03:31:25,818 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 03:31:25,846 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 03:31:25,850 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 03:31:25,865 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_e2cea473ae2de94a90929a1d8c5e4952.pkl
2025-05-05 03:31:26,921 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 03:31:26,936 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_ac5f5e86f44f608c0d04faf318225b89.pkl
2025-05-05 03:31:28,039 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 03:31:28,042 - lavka_recsys.ModelFactory - INFO - Creating catboost_ranker model with params: {'iterations': 500, 'verbose': 1, 'loss_function': 'YetiRankPairwise', 'eval_metric': 'NDCG', 'early_stopping_rounds': 50, 'custom_metric': ['NDCG:top=10', 'PrecisionAt:top=10', 'RecallAt:top=10'], 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 03:31:28,280 - lavka_recsys.CatBoostRankerModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 03:31:31,445 - lavka_recsys.CatBoostRankerModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 03:31:34,730 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 03:31:34,753 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 03:31:34,778 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 03:31:36,353 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 03:31:36,375 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 03:31:36,402 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 03:42:09,243 - lavka_recsys.Experiment(catboost_ranker_692adf) - INFO - Training completed in 641.20s
2025-05-05 03:42:09,248 - lavka_recsys.Experiment(catboost_ranker_692adf) - INFO - Evaluating on holdout.
2025-05-05 03:42:09,298 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_7ee8d53fe77e25622ba623dcc06b9812.pkl
2025-05-05 03:42:10,362 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 03:42:10,612 - lavka_recsys.CatBoostRankerModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 03:42:13,203 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 03:42:13,223 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 03:42:13,250 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 03:42:26,145 - lavka_recsys.Experiment(catboost_ranker_692adf) - INFO - Run results saved: results/catboost_ranker_692adf_results.json
2025-05-05 03:42:26,148 - lavka_recsys.Experiment(catboost_ranker_692adf) - INFO - Run finished and results saved.
2025-05-05 03:45:12,356 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 03:45:12,377 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 03:45:12,380 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 03:45:12,405 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 03:45:12,409 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 03:45:25,492 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 03:45:25,515 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 03:45:25,519 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 03:45:25,545 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 03:45:25,549 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 03:46:39,940 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_e2cea473ae2de94a90929a1d8c5e4952.pkl
2025-05-05 03:46:41,069 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 03:49:43,327 - lavka_recsys.Experiment(catboost_ranker_a9c699) - INFO - Initialized experiment: catboost_ranker_a9c699
2025-05-05 03:49:43,347 - lavka_recsys.Experiment(catboost_ranker_a9c699) - INFO - Config saved: results/catboost_ranker_a9c699_config.json
2025-05-05 03:49:43,348 - lavka_recsys.Experiment(catboost_ranker_a9c699) - INFO - Setting up experiment environment...
2025-05-05 03:49:43,350 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 03:49:43,630 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 03:49:43,668 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 03:49:43,696 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 03:49:43,878 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 03:49:43,905 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 03:49:43,909 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 03:49:43,909 - lavka_recsys.Experiment(catboost_ranker_a9c699) - INFO - Setup complete.
2025-05-05 03:49:43,911 - lavka_recsys.Experiment(catboost_ranker_a9c699) - INFO - Starting experiment run...
2025-05-05 03:49:44,245 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 03:49:44,268 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 03:49:44,274 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 03:49:44,302 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 03:49:44,305 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 03:49:44,319 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_e2cea473ae2de94a90929a1d8c5e4952.pkl
2025-05-05 03:49:45,387 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 03:49:45,402 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_ac5f5e86f44f608c0d04faf318225b89.pkl
2025-05-05 03:49:46,493 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 03:49:46,496 - lavka_recsys.ModelFactory - INFO - Creating catboost_ranker model with params: {'iterations': 500, 'verbose': 1, 'loss_function': 'YetiRankPairwise', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'custom_metric': ['NDCG:top=10', 'PrecisionAt:top=10', 'RecallAt:top=10'], 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 03:49:46,766 - lavka_recsys.CatBoostRankerModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 03:50:04,896 - lavka_recsys.Experiment(catboost_ranker_692adf) - INFO - Computing predictions...
2025-05-05 03:59:48,614 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Initialized experiment: catboost_classifier_140e76
2025-05-05 03:59:48,622 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Config saved: results/catboost_classifier_140e76_config.json
2025-05-05 03:59:48,623 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Setting up experiment environment...
2025-05-05 03:59:48,624 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 03:59:48,900 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 03:59:48,952 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 03:59:48,980 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 03:59:49,247 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 03:59:49,276 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 03:59:49,281 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 03:59:49,282 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Setup complete.
2025-05-05 03:59:49,283 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Starting experiment run...
2025-05-05 03:59:49,710 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 03:59:49,731 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 03:59:49,734 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 03:59:49,760 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 03:59:49,764 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 03:59:49,778 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_e2cea473ae2de94a90929a1d8c5e4952.pkl
2025-05-05 03:59:51,101 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 03:59:51,115 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_ac5f5e86f44f608c0d04faf318225b89.pkl
2025-05-05 03:59:52,528 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 03:59:52,532 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 500, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 03:59:52,962 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 03:59:56,785 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 04:00:00,298 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 04:00:00,317 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 04:00:00,339 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 04:00:02,222 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 04:00:02,245 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 04:00:02,275 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 04:00:03,917 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoostClassifier model with columns: ['product_total_purchases', 'month', 'days_since_interaction_u_s', 'city_unique_stores', 'user_total_purchases', 'purchases_week_u_p', 'puresvd_cf_score', 'svd_cf_score', 'session_unique_stores', 'mean_interval_days', 'ctr_product', 'interaction_trend', 'hour_of_day', 'session_length', 'views_week_u_p', 'day_of_week', 'count_purchase_u_s', 'session_unique_products', 'most_common_purchase_day', 'purchase_trend', 'user_product_purchase_cross', 'city_total_views', 'session_duration_seconds', 'city_total_purchases', 'day_of_week_relevance', 'store_total_interactions', 'purchase_view_ratio', 'city_total_interactions', 'std_purchase_hour', 'interactions_week_u_p', 'purchases_day_u_p', 'product_total_views', 'avg_purchase_hour', 'store_total_purchases', 'interactions_month_u_p', 'purchases_month_u_p', 'user_store_purchase_cross', 'count_purchase_u_p', 'cart_to_purchase_rate', 'user_product_store_cross', 'product_total_interactions', 'cf_score', 'session_purchases', 'views_month_u_p', 'hour_relevance', 'user_total_interactions', 'store_unique_products', 'product_unique_users', 'views_day_u_p', 'npmi_cf_score', 'user_segment', 'user_total_views', 'store_total_views', 'user_unique_products', 'city_name', 'is_weekend', 'days_since_interaction_u_p', 'source_type', 'interactions_day_u_p'] (cat_columns: ['city_name', 'source_type', 'user_segment'])
2025-05-05 04:01:10,351 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Training completed in 77.80s
2025-05-05 04:01:10,359 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Evaluating on holdout.
2025-05-05 04:01:10,449 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_7ee8d53fe77e25622ba623dcc06b9812.pkl
2025-05-05 04:01:11,711 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 04:01:12,009 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 04:01:12,049 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 04:01:12,067 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 04:01:24,294 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Run results saved: results/catboost_classifier_140e76_results.json
2025-05-05 04:01:24,301 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Run finished and results saved.
2025-05-05 04:03:59,061 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Computing predictions...
2025-05-05 04:06:09,378 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Initialized experiment: catboost_classifier_140e76
2025-05-05 04:06:09,395 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Config saved: results/catboost_classifier_140e76_config.json
2025-05-05 04:06:09,396 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Setting up experiment environment...
2025-05-05 04:06:09,398 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 04:06:09,684 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 04:06:09,745 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 04:06:09,766 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 04:06:10,026 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 04:06:10,053 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 04:06:10,056 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 04:06:10,057 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Setup complete.
2025-05-05 04:06:10,058 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Starting experiment run...
2025-05-05 04:06:10,654 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 04:06:10,675 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 04:06:10,679 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 04:06:10,711 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 04:06:10,716 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 04:06:10,730 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_e2cea473ae2de94a90929a1d8c5e4952.pkl
2025-05-05 04:06:11,971 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 04:06:11,987 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_ac5f5e86f44f608c0d04faf318225b89.pkl
2025-05-05 04:06:13,146 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 04:06:13,154 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 500, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 04:06:13,571 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 04:06:16,903 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 04:06:19,992 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 04:06:20,012 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 04:06:20,035 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 04:06:21,539 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 04:06:21,559 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 04:06:21,583 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 04:06:22,907 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoostClassifier model with columns: ['product_total_purchases', 'month', 'days_since_interaction_u_s', 'city_unique_stores', 'user_total_purchases', 'purchases_week_u_p', 'puresvd_cf_score', 'svd_cf_score', 'session_unique_stores', 'mean_interval_days', 'ctr_product', 'interaction_trend', 'hour_of_day', 'session_length', 'views_week_u_p', 'day_of_week', 'count_purchase_u_s', 'session_unique_products', 'most_common_purchase_day', 'purchase_trend', 'user_product_purchase_cross', 'city_total_views', 'session_duration_seconds', 'city_total_purchases', 'day_of_week_relevance', 'store_total_interactions', 'purchase_view_ratio', 'city_total_interactions', 'std_purchase_hour', 'interactions_week_u_p', 'purchases_day_u_p', 'product_total_views', 'avg_purchase_hour', 'store_total_purchases', 'interactions_month_u_p', 'purchases_month_u_p', 'user_store_purchase_cross', 'count_purchase_u_p', 'cart_to_purchase_rate', 'user_product_store_cross', 'product_total_interactions', 'cf_score', 'session_purchases', 'views_month_u_p', 'hour_relevance', 'user_total_interactions', 'store_unique_products', 'product_unique_users', 'views_day_u_p', 'npmi_cf_score', 'user_segment', 'user_total_views', 'store_total_views', 'user_unique_products', 'city_name', 'is_weekend', 'days_since_interaction_u_p', 'source_type', 'interactions_day_u_p'] (cat_columns: ['city_name', 'source_type', 'user_segment'])
2025-05-05 04:07:27,846 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Training completed in 74.66s
2025-05-05 04:07:27,854 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Evaluating on holdout.
2025-05-05 04:07:27,958 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_7ee8d53fe77e25622ba623dcc06b9812.pkl
2025-05-05 04:07:29,325 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 04:07:29,613 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 04:07:29,649 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 04:07:29,680 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 04:07:42,082 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Run results saved: results/catboost_classifier_140e76_results.json
2025-05-05 04:07:42,086 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Run finished and results saved.
2025-05-05 04:07:58,327 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Computing predictions...
2025-05-05 04:07:58,333 - lavka_recsys.DataLoader - INFO - Holdout data merged back into training data.
2025-05-05 04:07:58,377 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 04:07:58,415 - lavka_recsys.DataLoader - INFO -   history: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 04:07:58,427 - lavka_recsys.DataLoader - INFO -   target: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 04:07:58,442 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_7ee8d53fe77e25622ba623dcc06b9812.pkl
2025-05-05 04:07:59,693 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 04:07:59,696 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 500, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 04:07:59,975 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 04:08:02,942 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 04:08:02,962 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 04:08:02,983 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 04:08:04,446 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoostClassifier model with columns: ['product_total_purchases', 'month', 'days_since_interaction_u_s', 'city_unique_stores', 'user_total_purchases', 'purchases_week_u_p', 'puresvd_cf_score', 'svd_cf_score', 'session_unique_stores', 'mean_interval_days', 'ctr_product', 'interaction_trend', 'hour_of_day', 'session_length', 'views_week_u_p', 'day_of_week', 'count_purchase_u_s', 'session_unique_products', 'most_common_purchase_day', 'purchase_trend', 'user_product_purchase_cross', 'city_total_views', 'session_duration_seconds', 'city_total_purchases', 'day_of_week_relevance', 'store_total_interactions', 'purchase_view_ratio', 'city_total_interactions', 'std_purchase_hour', 'interactions_week_u_p', 'purchases_day_u_p', 'product_total_views', 'avg_purchase_hour', 'store_total_purchases', 'interactions_month_u_p', 'purchases_month_u_p', 'user_store_purchase_cross', 'count_purchase_u_p', 'cart_to_purchase_rate', 'user_product_store_cross', 'product_total_interactions', 'cf_score', 'session_purchases', 'views_month_u_p', 'hour_relevance', 'user_total_interactions', 'store_unique_products', 'product_unique_users', 'views_day_u_p', 'npmi_cf_score', 'user_segment', 'user_total_views', 'store_total_views', 'user_unique_products', 'city_name', 'is_weekend', 'days_since_interaction_u_p', 'source_type', 'interactions_day_u_p'] (cat_columns: ['city_name', 'source_type', 'user_segment'])
2025-05-05 04:10:14,018 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Training completed in 134.32s
2025-05-05 04:10:14,072 - lavka_recsys.DataLoader - INFO - Holdout data merged back into training data.
2025-05-05 04:10:14,128 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 04:10:14,129 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf
2025-05-05 04:10:14,130 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 04:10:14,130 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 04:10:14,419 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 04:10:14,501 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 04:10:15,092 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 04:10:15,482 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 04:10:16,039 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 04:10:17,198 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 04:10:17,612 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 04:10:17,946 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 04:10:18,293 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 04:10:18,876 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_temporal_patterns
2025-05-05 04:10:19,005 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_store
2025-05-05 04:10:19,405 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_features
2025-05-05 04:10:19,428 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_window_user_product
2025-05-05 04:10:19,744 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: session_features
2025-05-05 04:10:22,473 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: frequency_features
2025-05-05 04:10:27,303 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_popularity_trend
2025-05-05 04:10:27,982 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 04:10:28,364 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 04:10:28,698 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 04:10:29,048 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 04:10:29,603 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cross_features
2025-05-05 04:10:29,606 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_segments
2025-05-05 04:10:29,972 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: memory-based-cf
2025-05-05 04:10:31,178 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: npmi-cf
2025-05-05 04:11:03,505 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: puresvd-cf
2025-05-05 04:11:31,936 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: svd-cf
2025-05-05 04:11:33,391 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 04:11:33,394 - lavka_recsys.FeatureFactory - INFO - All column names: {'most_common_purchase_day', 'store_unique_products', 'hour_relevance', 'count_purchase_u_s', 'purchases_day_u_p', 'days_since_interaction_u_s', 'session_unique_products', 'mean_interval_days', 'interaction_trend', 'day_of_week', 'puresvd_cf_score', 'store_total_interactions', 'hour_of_day', 'is_weekend', 'source_type', 'user_unique_products', 'city_name', 'product_total_interactions', 'user_product_purchase_cross', 'user_store_purchase_cross', 'month', 'product_total_views', 'city_total_purchases', 'views_week_u_p', 'interactions_week_u_p', 'session_unique_stores', 'day_of_week_relevance', 'purchase_trend', 'session_purchases', 'cf_score', 'product_unique_users', 'ctr_product', 'avg_purchase_hour', 'user_segment', 'interactions_month_u_p', 'city_total_views', 'user_total_interactions', 'city_unique_stores', 'user_product_store_cross', 'std_purchase_hour', 'purchases_month_u_p', 'session_duration_seconds', 'session_length', 'product_total_purchases', 'cart_to_purchase_rate', 'days_since_interaction_u_p', 'city_total_interactions', 'svd_cf_score', 'store_total_views', 'user_total_purchases', 'purchases_week_u_p', 'count_purchase_u_p', 'purchase_view_ratio', 'user_total_views', 'npmi_cf_score', 'views_day_u_p', 'views_month_u_p', 'store_total_purchases', 'interactions_day_u_p'}
2025-05-05 04:11:33,395 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['city_name', 'user_segment', 'source_type']
2025-05-05 04:11:33,398 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 04:16:41,799 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Computing predictions...
2025-05-05 04:16:41,805 - lavka_recsys.DataLoader - INFO - Holdout data merged back into training data.
2025-05-05 04:16:41,836 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 04:16:41,867 - lavka_recsys.DataLoader - INFO -   history: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 04:16:41,872 - lavka_recsys.DataLoader - INFO -   target: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 04:16:41,906 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 04:16:41,907 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf
2025-05-05 04:16:41,908 - lavka_recsys.FeatureFactory - ERROR - Feature 'source_type' is not registered
2025-05-05 04:16:41,910 - lavka_recsys.FeatureFactory - ERROR - Available features: []
2025-05-05 04:17:37,734 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Initialized experiment: catboost_classifier_140e76
2025-05-05 04:17:37,746 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Config saved: results/catboost_classifier_140e76_config.json
2025-05-05 04:17:37,747 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Setting up experiment environment...
2025-05-05 04:17:37,749 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 04:17:38,008 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 04:17:38,076 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 04:17:38,102 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 04:17:38,281 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 04:17:38,306 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 04:17:38,309 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 04:17:38,310 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Setup complete.
2025-05-05 04:17:38,311 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Starting experiment run...
2025-05-05 04:17:38,639 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 04:17:38,659 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 04:17:38,663 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 04:17:38,687 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 04:17:38,692 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 04:17:38,716 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 04:17:38,718 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf
2025-05-05 04:17:38,719 - lavka_recsys.FeatureFactory - ERROR - Feature 'source_type' is not registered
2025-05-05 04:17:38,720 - lavka_recsys.FeatureFactory - ERROR - Available features: []
2025-05-05 04:17:51,212 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Initialized experiment: catboost_classifier_140e76
2025-05-05 04:17:51,229 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Config saved: results/catboost_classifier_140e76_config.json
2025-05-05 04:17:51,230 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Setting up experiment environment...
2025-05-05 04:17:51,232 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 04:17:51,516 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 04:17:51,569 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 04:17:51,604 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 04:17:51,863 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 04:17:51,894 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 04:17:51,898 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 04:17:51,898 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Setup complete.
2025-05-05 04:17:51,899 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Starting experiment run...
2025-05-05 04:17:52,355 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 04:17:52,378 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 04:17:52,382 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 04:17:52,409 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 04:17:52,413 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 04:17:52,439 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 04:17:52,441 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf
2025-05-05 04:17:52,442 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 04:17:52,442 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 04:17:52,716 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 04:17:52,797 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 04:17:53,236 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 04:17:53,559 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 04:17:53,879 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 04:17:54,762 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 04:17:55,091 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 04:17:55,373 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 04:17:55,642 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 04:17:56,158 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_temporal_patterns
2025-05-05 04:17:56,368 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_store
2025-05-05 04:17:56,709 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_features
2025-05-05 04:17:56,763 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_window_user_product
2025-05-05 04:17:57,184 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: session_features
2025-05-05 04:17:58,839 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: frequency_features
2025-05-05 04:18:02,479 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_popularity_trend
2025-05-05 04:18:03,370 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 04:18:03,858 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 04:18:04,151 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 04:18:04,456 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 04:18:05,015 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cross_features
2025-05-05 04:18:05,023 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_segments
2025-05-05 04:18:05,309 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: memory-based-cf
2025-05-05 04:18:07,370 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: npmi-cf
2025-05-05 04:18:31,249 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: puresvd-cf
2025-05-05 04:18:54,190 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: svd-cf
2025-05-05 04:18:57,848 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 04:18:57,852 - lavka_recsys.FeatureFactory - INFO - All column names: {'user_total_views', 'source_type', 'month', 'std_purchase_hour', 'session_unique_products', 'user_total_purchases', 'purchases_day_u_p', 'day_of_week_relevance', 'hour_of_day', 'user_unique_products', 'count_purchase_u_p', 'puresvd_cf_score', 'cart_to_purchase_rate', 'cf_score', 'session_duration_seconds', 'store_total_interactions', 'user_product_purchase_cross', 'session_purchases', 'product_unique_users', 'days_since_interaction_u_s', 'store_total_purchases', 'is_weekend', 'views_day_u_p', 'most_common_purchase_day', 'count_purchase_u_s', 'purchases_week_u_p', 'interactions_month_u_p', 'avg_purchase_hour', 'user_total_interactions', 'city_name', 'mean_interval_days', 'interactions_week_u_p', 'purchase_view_ratio', 'days_since_interaction_u_p', 'user_store_purchase_cross', 'city_total_purchases', 'city_total_interactions', 'ctr_product', 'hour_relevance', 'user_segment', 'session_unique_stores', 'product_total_views', 'day_of_week', 'purchases_month_u_p', 'interaction_trend', 'npmi_cf_score', 'product_total_purchases', 'user_product_store_cross', 'svd_cf_score', 'store_total_views', 'interactions_day_u_p', 'views_week_u_p', 'city_unique_stores', 'store_unique_products', 'purchase_trend', 'session_length', 'views_month_u_p', 'city_total_views', 'product_total_interactions'}
2025-05-05 04:18:57,853 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['user_segment', 'city_name', 'source_type']
2025-05-05 04:18:57,855 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 04:19:00,688 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_eea2663e747c09fad5b02e705a394f1a.pkl
2025-05-05 04:19:00,782 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 04:19:00,785 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf
2025-05-05 04:19:00,786 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 04:19:00,787 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 04:19:01,312 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 04:19:01,431 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 04:19:01,996 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 04:19:02,497 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 04:19:02,973 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 04:19:03,994 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 04:19:04,365 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 04:19:04,674 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 04:19:04,987 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 04:19:05,506 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_temporal_patterns
2025-05-05 04:19:05,756 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_store
2025-05-05 04:19:06,132 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_features
2025-05-05 04:19:06,183 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_window_user_product
2025-05-05 04:19:06,633 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: session_features
2025-05-05 04:19:08,424 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: frequency_features
2025-05-05 04:19:12,571 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_popularity_trend
2025-05-05 04:19:13,093 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 04:19:13,712 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 04:19:14,004 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 04:19:14,317 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 04:19:14,875 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cross_features
2025-05-05 04:19:14,885 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_segments
2025-05-05 04:19:15,222 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: memory-based-cf
2025-05-05 04:19:17,269 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: npmi-cf
2025-05-05 04:19:44,303 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: puresvd-cf
2025-05-05 04:20:08,680 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: svd-cf
2025-05-05 04:20:12,235 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 04:20:12,239 - lavka_recsys.FeatureFactory - INFO - All column names: {'user_total_views', 'source_type', 'month', 'std_purchase_hour', 'session_unique_products', 'user_total_purchases', 'purchases_day_u_p', 'day_of_week_relevance', 'hour_of_day', 'user_unique_products', 'count_purchase_u_p', 'puresvd_cf_score', 'cart_to_purchase_rate', 'cf_score', 'session_duration_seconds', 'store_total_interactions', 'user_product_purchase_cross', 'session_purchases', 'product_unique_users', 'days_since_interaction_u_s', 'store_total_purchases', 'is_weekend', 'views_day_u_p', 'most_common_purchase_day', 'count_purchase_u_s', 'purchases_week_u_p', 'interactions_month_u_p', 'avg_purchase_hour', 'user_total_interactions', 'city_name', 'mean_interval_days', 'interactions_week_u_p', 'purchase_view_ratio', 'days_since_interaction_u_p', 'user_store_purchase_cross', 'city_total_purchases', 'city_total_interactions', 'ctr_product', 'hour_relevance', 'user_segment', 'session_unique_stores', 'product_total_views', 'day_of_week', 'purchases_month_u_p', 'interaction_trend', 'npmi_cf_score', 'product_total_purchases', 'user_product_store_cross', 'svd_cf_score', 'store_total_views', 'interactions_day_u_p', 'views_week_u_p', 'city_unique_stores', 'store_unique_products', 'purchase_trend', 'session_length', 'views_month_u_p', 'city_total_views', 'product_total_interactions'}
2025-05-05 04:20:12,240 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['user_segment', 'city_name', 'source_type']
2025-05-05 04:20:12,243 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 04:20:15,065 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_0a8474df115bf334998e6bcb7079362b.pkl
2025-05-05 04:20:15,066 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 500, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 04:20:15,413 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 04:20:18,663 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 04:20:21,707 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 04:20:21,751 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 04:20:21,770 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 04:20:23,203 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 04:20:23,229 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 04:20:23,248 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 04:20:24,573 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoostClassifier model with columns: ['user_total_views', 'source_type', 'month', 'std_purchase_hour', 'session_unique_products', 'user_total_purchases', 'purchases_day_u_p', 'day_of_week_relevance', 'hour_of_day', 'user_unique_products', 'count_purchase_u_p', 'puresvd_cf_score', 'cart_to_purchase_rate', 'cf_score', 'session_duration_seconds', 'store_total_interactions', 'user_product_purchase_cross', 'session_purchases', 'product_unique_users', 'days_since_interaction_u_s', 'store_total_purchases', 'is_weekend', 'views_day_u_p', 'most_common_purchase_day', 'count_purchase_u_s', 'purchases_week_u_p', 'interactions_month_u_p', 'avg_purchase_hour', 'user_total_interactions', 'city_name', 'mean_interval_days', 'interactions_week_u_p', 'purchase_view_ratio', 'days_since_interaction_u_p', 'user_store_purchase_cross', 'city_total_purchases', 'city_total_interactions', 'ctr_product', 'hour_relevance', 'user_segment', 'session_unique_stores', 'product_total_views', 'day_of_week', 'purchases_month_u_p', 'interaction_trend', 'npmi_cf_score', 'product_total_purchases', 'user_product_store_cross', 'svd_cf_score', 'store_total_views', 'interactions_day_u_p', 'views_week_u_p', 'city_unique_stores', 'store_unique_products', 'purchase_trend', 'session_length', 'views_month_u_p', 'city_total_views', 'product_total_interactions'] (cat_columns: ['user_segment', 'city_name', 'source_type'])
2025-05-05 04:20:55,334 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Training completed in 40.25s
2025-05-05 04:20:55,339 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Evaluating on holdout.
2025-05-05 04:20:55,400 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 04:20:55,401 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf
2025-05-05 04:20:55,402 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 04:20:55,402 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 04:20:55,847 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 04:20:55,949 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 04:20:56,514 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 04:20:56,916 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 04:20:57,351 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 04:20:58,365 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 04:20:58,696 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 04:20:59,023 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 04:20:59,343 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 04:20:59,935 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_temporal_patterns
2025-05-05 04:21:00,147 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_store
2025-05-05 04:21:00,523 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_features
2025-05-05 04:21:00,571 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_window_user_product
2025-05-05 04:21:00,973 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: session_features
2025-05-05 04:21:02,894 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: frequency_features
2025-05-05 04:21:07,383 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_popularity_trend
2025-05-05 04:21:07,915 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 04:21:08,263 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 04:21:08,583 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 04:21:08,888 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 04:21:09,414 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cross_features
2025-05-05 04:21:09,418 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_segments
2025-05-05 04:21:09,795 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: memory-based-cf
2025-05-05 04:21:11,771 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: npmi-cf
2025-05-05 04:21:46,538 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: puresvd-cf
2025-05-05 04:22:12,787 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: svd-cf
2025-05-05 04:22:16,117 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 04:22:16,120 - lavka_recsys.FeatureFactory - INFO - All column names: {'user_total_views', 'source_type', 'month', 'std_purchase_hour', 'session_unique_products', 'user_total_purchases', 'purchases_day_u_p', 'day_of_week_relevance', 'hour_of_day', 'user_unique_products', 'count_purchase_u_p', 'puresvd_cf_score', 'cart_to_purchase_rate', 'cf_score', 'session_duration_seconds', 'store_total_interactions', 'user_product_purchase_cross', 'session_purchases', 'product_unique_users', 'days_since_interaction_u_s', 'store_total_purchases', 'is_weekend', 'views_day_u_p', 'most_common_purchase_day', 'count_purchase_u_s', 'purchases_week_u_p', 'interactions_month_u_p', 'avg_purchase_hour', 'user_total_interactions', 'city_name', 'mean_interval_days', 'interactions_week_u_p', 'purchase_view_ratio', 'days_since_interaction_u_p', 'user_store_purchase_cross', 'city_total_purchases', 'city_total_interactions', 'ctr_product', 'hour_relevance', 'user_segment', 'session_unique_stores', 'product_total_views', 'day_of_week', 'purchases_month_u_p', 'interaction_trend', 'npmi_cf_score', 'product_total_purchases', 'user_product_store_cross', 'svd_cf_score', 'store_total_views', 'interactions_day_u_p', 'views_week_u_p', 'city_unique_stores', 'store_unique_products', 'purchase_trend', 'session_length', 'views_month_u_p', 'city_total_views', 'product_total_interactions'}
2025-05-05 04:22:16,123 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['user_segment', 'city_name', 'source_type']
2025-05-05 04:22:16,128 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 04:22:18,679 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_1879e9aab22f20d41fd15e001434badd.pkl
2025-05-05 04:22:18,897 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 04:22:18,940 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 04:22:18,964 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 04:22:31,017 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Run results saved: results/catboost_classifier_140e76_results.json
2025-05-05 04:22:31,020 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Run finished and results saved.
2025-05-05 04:25:59,661 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Computing predictions...
2025-05-05 04:25:59,667 - lavka_recsys.DataLoader - INFO - Holdout data merged back into training data.
2025-05-05 04:25:59,703 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 04:25:59,731 - lavka_recsys.DataLoader - INFO -   history: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 04:25:59,736 - lavka_recsys.DataLoader - INFO -   target: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 04:25:59,765 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_1879e9aab22f20d41fd15e001434badd.pkl
2025-05-05 04:26:00,778 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 04:26:00,780 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 110, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 04:26:01,034 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 04:26:04,113 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 04:26:04,133 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 04:26:04,152 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 04:26:05,563 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoostClassifier model with columns: ['user_total_views', 'source_type', 'month', 'std_purchase_hour', 'session_unique_products', 'user_total_purchases', 'purchases_day_u_p', 'day_of_week_relevance', 'hour_of_day', 'user_unique_products', 'count_purchase_u_p', 'puresvd_cf_score', 'cart_to_purchase_rate', 'cf_score', 'session_duration_seconds', 'store_total_interactions', 'user_product_purchase_cross', 'session_purchases', 'product_unique_users', 'days_since_interaction_u_s', 'store_total_purchases', 'is_weekend', 'views_day_u_p', 'most_common_purchase_day', 'count_purchase_u_s', 'purchases_week_u_p', 'interactions_month_u_p', 'avg_purchase_hour', 'user_total_interactions', 'city_name', 'mean_interval_days', 'interactions_week_u_p', 'purchase_view_ratio', 'days_since_interaction_u_p', 'user_store_purchase_cross', 'city_total_purchases', 'city_total_interactions', 'ctr_product', 'hour_relevance', 'user_segment', 'session_unique_stores', 'product_total_views', 'day_of_week', 'purchases_month_u_p', 'interaction_trend', 'npmi_cf_score', 'product_total_purchases', 'user_product_store_cross', 'svd_cf_score', 'store_total_views', 'interactions_day_u_p', 'views_week_u_p', 'city_unique_stores', 'store_unique_products', 'purchase_trend', 'session_length', 'views_month_u_p', 'city_total_views', 'product_total_interactions'] (cat_columns: ['user_segment', 'city_name', 'source_type'])
2025-05-05 04:26:22,089 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Training completed in 21.31s
2025-05-05 04:26:22,134 - lavka_recsys.DataLoader - INFO - Holdout data merged back into training data.
2025-05-05 04:26:22,167 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 04:26:22,169 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf
2025-05-05 04:26:22,169 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 04:26:22,169 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 04:26:22,275 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 04:26:22,347 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 04:26:22,931 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 04:26:23,337 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 04:26:23,749 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 04:26:24,884 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 04:26:25,246 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 04:26:25,584 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 04:26:25,914 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 04:26:26,540 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_temporal_patterns
2025-05-05 04:26:26,700 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_store
2025-05-05 04:26:27,102 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_features
2025-05-05 04:26:27,112 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_window_user_product
2025-05-05 04:26:27,411 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: session_features
2025-05-05 04:26:29,315 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: frequency_features
2025-05-05 04:26:33,911 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_popularity_trend
2025-05-05 04:26:34,495 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 04:26:34,863 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 04:26:35,196 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 04:26:35,516 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 04:26:36,074 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cross_features
2025-05-05 04:26:36,076 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_segments
2025-05-05 04:26:36,420 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: memory-based-cf
2025-05-05 04:26:37,436 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: npmi-cf
2025-05-05 04:27:11,971 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: puresvd-cf
2025-05-05 04:27:38,039 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: svd-cf
2025-05-05 04:27:39,455 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 04:27:39,457 - lavka_recsys.FeatureFactory - INFO - All column names: {'user_total_views', 'source_type', 'month', 'std_purchase_hour', 'session_unique_products', 'user_total_purchases', 'purchases_day_u_p', 'day_of_week_relevance', 'hour_of_day', 'user_unique_products', 'count_purchase_u_p', 'puresvd_cf_score', 'cart_to_purchase_rate', 'cf_score', 'session_duration_seconds', 'store_total_interactions', 'user_product_purchase_cross', 'session_purchases', 'product_unique_users', 'days_since_interaction_u_s', 'store_total_purchases', 'is_weekend', 'views_day_u_p', 'most_common_purchase_day', 'count_purchase_u_s', 'purchases_week_u_p', 'interactions_month_u_p', 'avg_purchase_hour', 'user_total_interactions', 'city_name', 'mean_interval_days', 'interactions_week_u_p', 'purchase_view_ratio', 'days_since_interaction_u_p', 'user_store_purchase_cross', 'city_total_purchases', 'city_total_interactions', 'ctr_product', 'hour_relevance', 'user_segment', 'session_unique_stores', 'product_total_views', 'day_of_week', 'purchases_month_u_p', 'interaction_trend', 'npmi_cf_score', 'product_total_purchases', 'user_product_store_cross', 'svd_cf_score', 'store_total_views', 'interactions_day_u_p', 'views_week_u_p', 'city_unique_stores', 'store_unique_products', 'purchase_trend', 'session_length', 'views_month_u_p', 'city_total_views', 'product_total_interactions'}
2025-05-05 04:27:39,458 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['user_segment', 'city_name', 'source_type']
2025-05-05 04:27:39,527 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 04:27:39,540 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 04:27:39,551 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 11:24:31,402 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Initialized experiment: catboost_classifier_140e76
2025-05-05 11:24:31,411 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Config saved: results/catboost_classifier_140e76_config.json
2025-05-05 11:24:31,412 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Setting up experiment environment...
2025-05-05 11:24:31,413 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 11:24:31,739 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 11:24:31,795 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 11:24:31,840 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 11:24:32,133 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 11:24:32,159 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 11:24:32,164 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 11:24:32,165 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Setup complete.
2025-05-05 11:24:32,166 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Starting experiment run...
2025-05-05 11:24:32,699 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 11:24:32,724 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 11:24:32,727 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 11:24:32,751 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 11:24:32,756 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 11:24:32,781 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_eea2663e747c09fad5b02e705a394f1a.pkl
2025-05-05 11:24:34,143 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 11:24:34,169 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_0a8474df115bf334998e6bcb7079362b.pkl
2025-05-05 11:24:35,424 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 11:24:35,429 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 500, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 11:24:35,805 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 11:24:39,561 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 11:24:43,177 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 11:24:43,202 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 11:24:43,223 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 11:24:45,029 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 11:24:45,051 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 11:24:45,080 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 11:24:46,890 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoostClassifier model with columns: ['user_total_views', 'source_type', 'month', 'std_purchase_hour', 'session_unique_products', 'user_total_purchases', 'purchases_day_u_p', 'day_of_week_relevance', 'hour_of_day', 'user_unique_products', 'count_purchase_u_p', 'puresvd_cf_score', 'cart_to_purchase_rate', 'cf_score', 'session_duration_seconds', 'store_total_interactions', 'user_product_purchase_cross', 'session_purchases', 'product_unique_users', 'days_since_interaction_u_s', 'store_total_purchases', 'is_weekend', 'views_day_u_p', 'most_common_purchase_day', 'count_purchase_u_s', 'purchases_week_u_p', 'interactions_month_u_p', 'avg_purchase_hour', 'user_total_interactions', 'city_name', 'mean_interval_days', 'interactions_week_u_p', 'purchase_view_ratio', 'days_since_interaction_u_p', 'user_store_purchase_cross', 'city_total_purchases', 'city_total_interactions', 'ctr_product', 'hour_relevance', 'user_segment', 'session_unique_stores', 'product_total_views', 'day_of_week', 'purchases_month_u_p', 'interaction_trend', 'npmi_cf_score', 'product_total_purchases', 'user_product_store_cross', 'svd_cf_score', 'store_total_views', 'interactions_day_u_p', 'views_week_u_p', 'city_unique_stores', 'store_unique_products', 'purchase_trend', 'session_length', 'views_month_u_p', 'city_total_views', 'product_total_interactions'] (cat_columns: ['user_segment', 'city_name', 'source_type'])
2025-05-05 11:25:17,909 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Training completed in 42.46s
2025-05-05 11:25:17,914 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Evaluating on holdout.
2025-05-05 11:25:18,027 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_1879e9aab22f20d41fd15e001434badd.pkl
2025-05-05 11:25:19,325 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 11:25:19,635 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 11:25:19,669 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 11:25:19,700 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 11:25:33,495 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Run results saved: results/catboost_classifier_140e76_results.json
2025-05-05 11:25:33,499 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Run finished and results saved.
2025-05-05 11:30:55,498 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Computing predictions...
2025-05-05 11:30:55,506 - lavka_recsys.DataLoader - INFO - Holdout data merged back into training data.
2025-05-05 11:30:55,554 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 11:30:55,608 - lavka_recsys.DataLoader - INFO -   history: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 11:30:55,613 - lavka_recsys.DataLoader - INFO -   target: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 11:30:55,648 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_1879e9aab22f20d41fd15e001434badd.pkl
2025-05-05 11:30:56,957 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 11:30:56,959 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 110, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 11:30:57,213 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 11:31:00,479 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 11:31:00,502 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 11:31:00,523 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 11:31:02,124 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoostClassifier model with columns: ['user_total_views', 'source_type', 'month', 'std_purchase_hour', 'session_unique_products', 'user_total_purchases', 'purchases_day_u_p', 'day_of_week_relevance', 'hour_of_day', 'user_unique_products', 'count_purchase_u_p', 'puresvd_cf_score', 'cart_to_purchase_rate', 'cf_score', 'session_duration_seconds', 'store_total_interactions', 'user_product_purchase_cross', 'session_purchases', 'product_unique_users', 'days_since_interaction_u_s', 'store_total_purchases', 'is_weekend', 'views_day_u_p', 'most_common_purchase_day', 'count_purchase_u_s', 'purchases_week_u_p', 'interactions_month_u_p', 'avg_purchase_hour', 'user_total_interactions', 'city_name', 'mean_interval_days', 'interactions_week_u_p', 'purchase_view_ratio', 'days_since_interaction_u_p', 'user_store_purchase_cross', 'city_total_purchases', 'city_total_interactions', 'ctr_product', 'hour_relevance', 'user_segment', 'session_unique_stores', 'product_total_views', 'day_of_week', 'purchases_month_u_p', 'interaction_trend', 'npmi_cf_score', 'product_total_purchases', 'user_product_store_cross', 'svd_cf_score', 'store_total_views', 'interactions_day_u_p', 'views_week_u_p', 'city_unique_stores', 'store_unique_products', 'purchase_trend', 'session_length', 'views_month_u_p', 'city_total_views', 'product_total_interactions'] (cat_columns: ['user_segment', 'city_name', 'source_type'])
2025-05-05 11:31:20,510 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Training completed in 23.55s
2025-05-05 11:31:20,559 - lavka_recsys.DataLoader - INFO - Holdout data merged back into training data.
2025-05-05 11:31:20,588 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 11:31:20,590 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf
2025-05-05 11:31:20,590 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 11:31:20,590 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 11:31:20,840 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 11:31:20,908 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 11:31:21,531 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 11:31:21,961 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 11:31:22,529 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 11:31:23,772 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 11:31:24,262 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 11:31:24,652 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 11:31:24,985 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 11:31:25,566 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_temporal_patterns
2025-05-05 11:31:25,710 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_store
2025-05-05 11:31:26,218 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_features
2025-05-05 11:31:26,228 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_window_user_product
2025-05-05 11:31:26,535 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: session_features
2025-05-05 11:31:28,517 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: frequency_features
2025-05-05 11:31:34,195 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_popularity_trend
2025-05-05 11:31:34,774 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 11:31:35,133 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 11:31:35,489 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 11:31:35,805 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 11:31:36,358 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cross_features
2025-05-05 11:31:36,359 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_segments
2025-05-05 11:31:36,750 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: memory-based-cf
2025-05-05 11:31:38,019 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: npmi-cf
2025-05-05 11:32:11,297 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: puresvd-cf
2025-05-05 11:32:42,410 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: svd-cf
2025-05-05 11:32:44,004 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 11:32:44,007 - lavka_recsys.FeatureFactory - INFO - All column names: {'city_total_interactions', 'count_purchase_u_s', 'hour_of_day', 'store_total_views', 'source_type', 'count_purchase_u_p', 'user_unique_products', 'cart_to_purchase_rate', 'session_length', 'interaction_trend', 'user_product_purchase_cross', 'city_total_purchases', 'city_unique_stores', 'user_product_store_cross', 'is_weekend', 'user_segment', 'interactions_day_u_p', 'session_duration_seconds', 'city_name', 'product_unique_users', 'store_unique_products', 'product_total_purchases', 'avg_purchase_hour', 'std_purchase_hour', 'purchase_view_ratio', 'user_total_purchases', 'purchase_trend', 'views_day_u_p', 'session_purchases', 'purchases_week_u_p', 'user_total_interactions', 'day_of_week', 'user_store_purchase_cross', 'interactions_week_u_p', 'svd_cf_score', 'user_total_views', 'puresvd_cf_score', 'days_since_interaction_u_p', 'product_total_interactions', 'store_total_interactions', 'most_common_purchase_day', 'ctr_product', 'session_unique_products', 'interactions_month_u_p', 'views_month_u_p', 'cf_score', 'views_week_u_p', 'day_of_week_relevance', 'city_total_views', 'month', 'purchases_day_u_p', 'mean_interval_days', 'store_total_purchases', 'npmi_cf_score', 'hour_relevance', 'days_since_interaction_u_s', 'purchases_month_u_p', 'product_total_views', 'session_unique_stores'}
2025-05-05 11:32:44,008 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['city_name', 'user_segment', 'source_type']
2025-05-05 11:32:44,082 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 11:32:44,095 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 11:32:44,106 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 11:32:44,552 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Submission saved: results/submissions/catboost_classifier_140e76_submission.csv
2025-05-05 11:32:44,593 - lavka_recsys.Experiment(catboost_classifier_140e76) - INFO - Submission model saved: results/submissions/catboost_classifier_140e76_model.pkl
2025-05-05 11:38:57,101 - lavka_recsys.Experiment(catboost_classifier_6810b4) - INFO - Initialized experiment: catboost_classifier_6810b4
2025-05-05 11:38:57,111 - lavka_recsys.Experiment(catboost_classifier_6810b4) - INFO - Config saved: results/catboost_classifier_6810b4_config.json
2025-05-05 11:38:57,236 - lavka_recsys.Experiment(catboost_classifier_6810b4) - INFO - Setting up experiment environment...
2025-05-05 11:38:57,238 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 11:38:57,606 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 11:38:57,686 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 11:38:57,702 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 11:38:57,848 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 11:38:57,874 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 11:38:57,878 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 11:38:57,879 - lavka_recsys.Experiment(catboost_classifier_6810b4) - INFO - Setup complete.
2025-05-05 11:38:57,880 - lavka_recsys.Experiment(catboost_classifier_6810b4) - INFO - Starting experiment run...
2025-05-05 11:38:58,122 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 11:38:58,144 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 11:38:58,148 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 11:38:58,173 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 11:38:58,176 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 11:38:58,205 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 11:38:58,206 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio
2025-05-05 11:38:58,207 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 11:38:58,208 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 11:38:58,464 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 11:38:58,593 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 11:38:59,240 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 11:38:59,685 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 11:39:00,089 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 11:39:00,090 - lavka_recsys.FeatureFactory - INFO - All column names: {'count_purchase_u_s', 'source_type', 'count_purchase_u_p', 'cart_to_purchase_rate', 'purchase_view_ratio', 'ctr_product'}
2025-05-05 11:39:00,091 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type']
2025-05-05 11:39:00,092 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 11:39:01,307 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_879c7d36348127b9d7af9923a7ce71aa.pkl
2025-05-05 11:39:01,334 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 11:39:01,335 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio
2025-05-05 11:39:01,337 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 11:39:01,337 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 11:39:01,715 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 11:39:01,799 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 11:39:02,223 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 11:39:02,664 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 11:39:03,056 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 11:39:03,058 - lavka_recsys.FeatureFactory - INFO - All column names: {'count_purchase_u_s', 'source_type', 'count_purchase_u_p', 'cart_to_purchase_rate', 'purchase_view_ratio', 'ctr_product'}
2025-05-05 11:39:03,060 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type']
2025-05-05 11:39:03,063 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 11:39:04,406 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_5dfa3b2714322e2031c534298178f055.pkl
2025-05-05 11:39:04,407 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 500, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 11:39:04,524 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 11:39:07,070 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 11:39:09,810 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 11:39:10,939 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 11:39:11,894 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoostClassifier model with columns: ['count_purchase_u_s', 'source_type', 'count_purchase_u_p', 'cart_to_purchase_rate', 'purchase_view_ratio', 'ctr_product'] (cat_columns: ['source_type'])
2025-05-05 11:39:43,407 - lavka_recsys.Experiment(catboost_classifier_6810b4) - INFO - Training completed in 39.00s
2025-05-05 11:39:43,409 - lavka_recsys.Experiment(catboost_classifier_6810b4) - INFO - Evaluating on holdout.
2025-05-05 11:39:43,484 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 11:39:43,486 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio
2025-05-05 11:39:43,487 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 11:39:43,487 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 11:39:43,826 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 11:39:43,918 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 11:39:44,378 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 11:39:44,823 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 11:39:45,256 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 11:39:45,257 - lavka_recsys.FeatureFactory - INFO - All column names: {'count_purchase_u_s', 'source_type', 'count_purchase_u_p', 'cart_to_purchase_rate', 'purchase_view_ratio', 'ctr_product'}
2025-05-05 11:39:45,258 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type']
2025-05-05 11:39:45,259 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 11:39:46,440 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_b40166dddc5fba496941f5f8db2e6539.pkl
2025-05-05 11:39:46,534 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 11:39:59,655 - lavka_recsys.Experiment(catboost_classifier_6810b4) - INFO - Run results saved: results/catboost_classifier_6810b4_results.json
2025-05-05 11:39:59,660 - lavka_recsys.Experiment(catboost_classifier_6810b4) - INFO - Run finished and results saved.
2025-05-05 11:40:51,656 - lavka_recsys.Experiment(catboost_classifier_79beb2) - INFO - Initialized experiment: catboost_classifier_79beb2
2025-05-05 11:40:51,666 - lavka_recsys.Experiment(catboost_classifier_79beb2) - INFO - Config saved: results/catboost_classifier_79beb2_config.json
2025-05-05 11:40:51,920 - lavka_recsys.Experiment(catboost_classifier_79beb2) - INFO - Setting up experiment environment...
2025-05-05 11:40:51,935 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 11:40:52,158 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 11:40:52,227 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 11:40:52,247 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 11:40:52,386 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 11:40:52,439 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 11:40:52,443 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 11:40:52,445 - lavka_recsys.Experiment(catboost_classifier_79beb2) - INFO - Setup complete.
2025-05-05 11:40:52,446 - lavka_recsys.Experiment(catboost_classifier_79beb2) - INFO - Starting experiment run...
2025-05-05 11:40:52,765 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 11:40:52,786 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 11:40:52,790 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 11:40:52,817 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 11:40:52,821 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 11:40:52,846 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 11:40:52,847 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product
2025-05-05 11:40:52,847 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 11:40:52,847 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 11:40:53,070 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 11:40:53,072 - lavka_recsys.FeatureFactory - INFO - All column names: {'source_type', 'count_purchase_u_p'}
2025-05-05 11:40:53,074 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type']
2025-05-05 11:40:53,078 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 11:40:54,205 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_aa8cb783deb7d34845d9cb287f90ff11.pkl
2025-05-05 11:40:54,230 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 11:40:54,231 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product
2025-05-05 11:40:54,232 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 11:40:54,233 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 11:40:54,469 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 11:40:54,471 - lavka_recsys.FeatureFactory - INFO - All column names: {'source_type', 'count_purchase_u_p'}
2025-05-05 11:40:54,473 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type']
2025-05-05 11:40:54,476 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 11:40:55,623 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_7379eb788b28b2e3ba319b4f7a6d34f3.pkl
2025-05-05 11:40:55,624 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 500, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 11:40:55,749 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 11:40:58,404 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 11:41:01,095 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 11:41:02,355 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 11:41:03,504 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoostClassifier model with columns: ['source_type', 'count_purchase_u_p'] (cat_columns: ['source_type'])
2025-05-05 11:41:20,975 - lavka_recsys.Experiment(catboost_classifier_79beb2) - INFO - Training completed in 25.35s
2025-05-05 11:41:20,979 - lavka_recsys.Experiment(catboost_classifier_79beb2) - INFO - Evaluating on holdout.
2025-05-05 11:41:21,017 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 11:41:21,018 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product
2025-05-05 11:41:21,019 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 11:41:21,019 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 11:41:21,237 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 11:41:21,239 - lavka_recsys.FeatureFactory - INFO - All column names: {'source_type', 'count_purchase_u_p'}
2025-05-05 11:41:21,240 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type']
2025-05-05 11:41:21,242 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 11:41:22,421 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_37d2a6f2ecddf1a9099e1e8523bb45bd.pkl
2025-05-05 11:41:22,504 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 11:41:35,187 - lavka_recsys.Experiment(catboost_classifier_79beb2) - INFO - Run results saved: results/catboost_classifier_79beb2_results.json
2025-05-05 11:41:35,188 - lavka_recsys.Experiment(catboost_classifier_79beb2) - INFO - Run finished and results saved.
2025-05-05 11:46:38,903 - lavka_recsys.Experiment(catboost_classifier_79beb2) - INFO - Computing predictions...
2025-05-05 11:46:38,910 - lavka_recsys.DataLoader - INFO - Holdout data merged back into training data.
2025-05-05 11:46:38,946 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 11:46:38,974 - lavka_recsys.DataLoader - INFO -   history: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 11:46:38,978 - lavka_recsys.DataLoader - INFO -   target: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 11:46:39,008 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_37d2a6f2ecddf1a9099e1e8523bb45bd.pkl
2025-05-05 11:46:39,137 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 11:46:39,139 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'iterations': 18, 'learning_rate': 0.1, 'depth': 6, 'l2_leaf_reg': 3.0, 'verbose': 10, 'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 11:46:39,239 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 11:46:41,592 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 11:46:42,658 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoostClassifier model with columns: ['source_type', 'count_purchase_u_p'] (cat_columns: ['source_type'])
2025-05-05 11:46:44,954 - lavka_recsys.Experiment(catboost_classifier_79beb2) - INFO - Training completed in 5.81s
2025-05-05 11:46:44,988 - lavka_recsys.DataLoader - INFO - Holdout data merged back into training data.
2025-05-05 11:46:45,018 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 11:46:45,019 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product
2025-05-05 11:46:45,020 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 11:46:45,020 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 11:46:45,131 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 11:46:45,132 - lavka_recsys.FeatureFactory - INFO - All column names: {'source_type', 'count_purchase_u_p'}
2025-05-05 11:46:45,133 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type']
2025-05-05 11:46:45,171 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 11:46:45,340 - lavka_recsys.Experiment(catboost_classifier_79beb2) - INFO - Submission saved: results/submissions/catboost_classifier_79beb2_submission.csv
2025-05-05 11:46:45,399 - lavka_recsys.Experiment(catboost_classifier_79beb2) - INFO - Submission model saved: results/submissions/catboost_classifier_79beb2_model.pkl
2025-05-05 12:00:48,755 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Initialized experiment: random_baseline_f11639
2025-05-05 12:00:48,763 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Config saved: results/random_baseline_f11639_config.json
2025-05-05 12:00:48,764 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Setting up experiment environment...
2025-05-05 12:00:48,765 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 12:00:49,029 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 12:00:49,068 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 12:00:49,078 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 12:00:49,198 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 12:00:49,224 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 12:00:49,228 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 12:00:49,229 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Setup complete.
2025-05-05 12:00:49,229 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Starting experiment run...
2025-05-05 12:00:49,544 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 12:00:49,565 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 12:00:49,569 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 12:00:49,594 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 12:00:49,600 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 12:00:49,632 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_aa8cb783deb7d34845d9cb287f90ff11.pkl
2025-05-05 12:00:49,788 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 12:00:49,821 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_7379eb788b28b2e3ba319b4f7a6d34f3.pkl
2025-05-05 12:00:49,961 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 12:01:03,634 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Initialized experiment: random_baseline_f11639
2025-05-05 12:01:03,643 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Config saved: results/random_baseline_f11639_config.json
2025-05-05 12:01:03,645 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Setting up experiment environment...
2025-05-05 12:01:03,646 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 12:01:03,982 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 12:01:04,045 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 12:01:04,075 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 12:01:04,355 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 12:01:04,383 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 12:01:04,387 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 12:01:04,388 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Setup complete.
2025-05-05 12:01:04,388 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Starting experiment run...
2025-05-05 12:01:04,884 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 12:01:04,906 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 12:01:04,910 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 12:01:04,936 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 12:01:04,942 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 12:01:04,969 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_aa8cb783deb7d34845d9cb287f90ff11.pkl
2025-05-05 12:01:05,135 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 12:01:05,162 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_7379eb788b28b2e3ba319b4f7a6d34f3.pkl
2025-05-05 12:01:05,315 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 12:01:05,318 - lavka_recsys.ModelFactory - INFO - Creating random_baseline model with params: {'task_type': 'CPU', 'thread_count': -1}
2025-05-05 12:01:05,319 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Training completed in 0.00s
2025-05-05 12:01:05,321 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Evaluating on holdout.
2025-05-05 12:01:05,353 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_37d2a6f2ecddf1a9099e1e8523bb45bd.pkl
2025-05-05 12:01:05,478 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 12:01:17,357 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Run results saved: results/random_baseline_f11639_results.json
2025-05-05 12:01:17,363 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Run finished and results saved.
2025-05-05 12:04:26,816 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Computing predictions...
2025-05-05 12:04:26,821 - lavka_recsys.DataLoader - INFO - Holdout data merged back into training data.
2025-05-05 12:04:26,853 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 12:04:26,882 - lavka_recsys.DataLoader - INFO -   history: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 12:04:26,886 - lavka_recsys.DataLoader - INFO -   target: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 12:04:26,916 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_37d2a6f2ecddf1a9099e1e8523bb45bd.pkl
2025-05-05 12:04:27,034 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 12:04:27,036 - lavka_recsys.ModelFactory - INFO - Creating random_baseline model with params: {'task_type': 'CPU', 'thread_count': -1}
2025-05-05 12:04:27,037 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Training completed in 0.00s
2025-05-05 12:04:27,043 - lavka_recsys.DataLoader - INFO - Holdout data merged back into training data.
2025-05-05 12:04:27,077 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 12:04:27,078 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product
2025-05-05 12:04:27,080 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 12:04:27,080 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 12:04:27,236 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 12:04:27,238 - lavka_recsys.FeatureFactory - INFO - All column names: {'count_purchase_u_p', 'source_type'}
2025-05-05 12:04:27,240 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type']
2025-05-05 12:04:27,324 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Submission saved: results/submissions/random_baseline_f11639_submission.csv
2025-05-05 12:04:27,326 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Submission model saved: results/submissions/random_baseline_f11639_model.pkl
2025-05-05 12:15:31,799 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Initialized experiment: random_baseline_f11639
2025-05-05 12:15:31,809 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Config saved: results/random_baseline_f11639_config.json
2025-05-05 12:15:31,810 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Setting up experiment environment...
2025-05-05 12:15:31,812 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 12:15:32,107 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 12:15:32,162 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 12:15:32,192 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 12:15:32,507 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 12:15:32,534 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 12:15:32,538 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 12:15:32,539 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Setup complete.
2025-05-05 12:15:32,540 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Starting experiment run...
2025-05-05 12:15:32,960 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 12:15:32,982 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 12:15:32,986 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 12:15:33,012 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 12:15:33,016 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 12:15:33,044 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_aa8cb783deb7d34845d9cb287f90ff11.pkl
2025-05-05 12:15:33,234 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 12:15:33,268 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_7379eb788b28b2e3ba319b4f7a6d34f3.pkl
2025-05-05 12:15:33,419 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 12:15:33,424 - lavka_recsys.ModelFactory - INFO - Creating random_baseline model with params: {'task_type': 'CPU', 'thread_count': -1}
2025-05-05 12:15:33,425 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Training completed in 0.00s
2025-05-05 12:15:33,427 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Evaluating on holdout.
2025-05-05 12:15:33,458 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_37d2a6f2ecddf1a9099e1e8523bb45bd.pkl
2025-05-05 12:15:33,577 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 12:15:45,232 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Run results saved: results/random_baseline_f11639_results.json
2025-05-05 12:15:45,234 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Run finished and results saved.
2025-05-05 12:17:35,320 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Initialized experiment: random_baseline_f11639
2025-05-05 12:17:35,330 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Config saved: results/random_baseline_f11639_config.json
2025-05-05 12:17:35,331 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Setting up experiment environment...
2025-05-05 12:17:35,333 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 12:17:35,663 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 12:17:35,702 - lavka_recsys.DataLoader - DEBUG - Converting train_df 'timestamp' from epoch[s] to datetime
2025-05-05 12:17:35,731 - lavka_recsys.DataLoader - DEBUG - Converting test_df 'timestamp' from epoch[s] to datetime
2025-05-05 12:17:36,044 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 12:17:36,074 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 12:17:36,078 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 12:17:36,079 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Setup complete.
2025-05-05 12:17:36,080 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Starting experiment run...
2025-05-05 12:17:36,580 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 12:17:36,601 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 12:17:36,605 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 12:17:36,658 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 12:17:36,662 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 12:17:36,686 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_aa8cb783deb7d34845d9cb287f90ff11.pkl
2025-05-05 12:17:36,835 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 12:17:36,862 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_7379eb788b28b2e3ba319b4f7a6d34f3.pkl
2025-05-05 12:17:37,007 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 12:17:37,014 - lavka_recsys.ModelFactory - INFO - Creating random_baseline model with params: {'task_type': 'CPU', 'thread_count': -1}
2025-05-05 12:17:37,015 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Training completed in 0.00s
2025-05-05 12:17:37,017 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Evaluating on holdout.
2025-05-05 12:17:37,052 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_37d2a6f2ecddf1a9099e1e8523bb45bd.pkl
2025-05-05 12:17:37,177 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 12:17:48,322 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Run results saved: results/random_baseline_f11639_results.json
2025-05-05 12:17:48,324 - lavka_recsys.Experiment(random_baseline_f11639) - INFO - Run finished and results saved.
2025-05-05 12:55:30,236 - lavka_recsys.Experiment(random_baseline_657d53) - INFO - Initialized experiment: random_baseline_657d53
2025-05-05 12:55:30,243 - lavka_recsys.Experiment(random_baseline_657d53) - INFO - Config saved: results/random_baseline_657d53_config.json
2025-05-05 12:55:30,244 - lavka_recsys.Experiment(random_baseline_657d53) - INFO - Setting up experiment environment...
2025-05-05 12:55:30,246 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 12:55:30,589 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 12:55:30,649 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 12:55:31,799 - lavka_recsys.DataPreprocessor - DEBUG - Removing sessions without a single non-view action.
2025-05-05 12:56:26,473 - lavka_recsys.Experiment(random_baseline_657d53) - INFO - Initialized experiment: random_baseline_657d53
2025-05-05 12:56:26,485 - lavka_recsys.Experiment(random_baseline_657d53) - INFO - Config saved: results/random_baseline_657d53_config.json
2025-05-05 12:56:26,486 - lavka_recsys.Experiment(random_baseline_657d53) - INFO - Setting up experiment environment...
2025-05-05 12:56:26,488 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 12:56:26,835 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 12:56:26,908 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 12:56:28,136 - lavka_recsys.DataPreprocessor - DEBUG - Removing sessions without a single non-view action.
2025-05-05 12:56:28,137 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 12:56:59,468 - lavka_recsys.Experiment(random_baseline_657d53) - INFO - Initialized experiment: random_baseline_657d53
2025-05-05 12:56:59,475 - lavka_recsys.Experiment(random_baseline_657d53) - INFO - Config saved: results/random_baseline_657d53_config.json
2025-05-05 12:56:59,476 - lavka_recsys.Experiment(random_baseline_657d53) - INFO - Setting up experiment environment...
2025-05-05 12:56:59,477 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 12:56:59,790 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 12:56:59,844 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 12:57:01,164 - lavka_recsys.DataPreprocessor - DEBUG - Removing sessions without a single non-view action.
2025-05-05 12:57:01,168 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 12:58:01,646 - lavka_recsys.Experiment(random_baseline_657d53) - INFO - Initialized experiment: random_baseline_657d53
2025-05-05 12:58:01,653 - lavka_recsys.Experiment(random_baseline_657d53) - INFO - Config saved: results/random_baseline_657d53_config.json
2025-05-05 12:58:01,654 - lavka_recsys.Experiment(random_baseline_657d53) - INFO - Setting up experiment environment...
2025-05-05 12:58:01,656 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 12:58:01,962 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 12:58:02,012 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 12:58:03,300 - lavka_recsys.DataPreprocessor - DEBUG - Removing sessions without a single non-view action.
2025-05-05 12:58:03,304 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 12:59:28,088 - lavka_recsys.Experiment(random_baseline_657d53) - INFO - Initialized experiment: random_baseline_657d53
2025-05-05 12:59:28,095 - lavka_recsys.Experiment(random_baseline_657d53) - INFO - Config saved: results/random_baseline_657d53_config.json
2025-05-05 12:59:28,096 - lavka_recsys.Experiment(random_baseline_657d53) - INFO - Setting up experiment environment...
2025-05-05 12:59:28,097 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 12:59:28,423 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 12:59:28,486 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 12:59:29,734 - lavka_recsys.DataPreprocessor - DEBUG - Removing sessions without a single non-view action.
2025-05-05 12:59:29,739 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 12:59:29,928 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 12:59:29,947 - lavka_recsys.DataLoader - INFO -   train: 2023-01-01 00:45:47 → 2024-01-03 16:53:15 (8_114_480 rows, 367 days)
2025-05-05 12:59:29,950 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:05:00 → 2024-02-02 16:58:16 (731_553 rows, 29 days)
2025-05-05 12:59:29,951 - lavka_recsys.Experiment(random_baseline_657d53) - INFO - Setup complete.
2025-05-05 12:59:29,953 - lavka_recsys.Experiment(random_baseline_657d53) - INFO - Starting experiment run...
2025-05-05 12:59:30,197 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 12:59:30,209 - lavka_recsys.DataLoader - INFO -   train_history: 2023-01-01 00:45:47 → 2023-11-04 15:32:27 (6_555_943 rows, 307 days)
2025-05-05 12:59:30,211 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 15:55:39 → 2023-12-04 15:51:13 (784_864 rows, 29 days)
2025-05-05 12:59:30,225 - lavka_recsys.DataLoader - INFO -   val_history: 2023-01-01 00:45:47 → 2023-12-04 15:51:13 (7_340_807 rows, 337 days)
2025-05-05 12:59:30,227 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 20:08:57 → 2024-01-03 16:53:15 (773_673 rows, 29 days)
2025-05-05 12:59:30,239 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 12:59:30,240 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product
2025-05-05 12:59:30,241 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 12:59:30,241 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 12:59:30,338 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 12:59:30,339 - lavka_recsys.FeatureFactory - INFO - All column names: {'source_type', 'count_purchase_u_p'}
2025-05-05 12:59:30,340 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type']
2025-05-05 12:59:30,341 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 12:59:30,626 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_f23452e06e52325892f2029d15b0c9e4.pkl
2025-05-05 12:59:30,641 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 12:59:30,642 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product
2025-05-05 12:59:30,643 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 12:59:30,643 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 12:59:30,727 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 12:59:30,728 - lavka_recsys.FeatureFactory - INFO - All column names: {'source_type', 'count_purchase_u_p'}
2025-05-05 12:59:30,729 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type']
2025-05-05 12:59:30,730 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 12:59:31,008 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_dd5196d0f7324c2576557131faff64e7.pkl
2025-05-05 12:59:31,009 - lavka_recsys.ModelFactory - INFO - Creating random_baseline model with params: {'task_type': 'CPU', 'thread_count': -1}
2025-05-05 12:59:31,010 - lavka_recsys.Experiment(random_baseline_657d53) - INFO - Training completed in 0.00s
2025-05-05 12:59:31,011 - lavka_recsys.Experiment(random_baseline_657d53) - INFO - Evaluating on holdout.
2025-05-05 12:59:31,025 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 12:59:31,026 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product
2025-05-05 12:59:31,027 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 12:59:31,027 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 12:59:31,138 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 12:59:31,139 - lavka_recsys.FeatureFactory - INFO - All column names: {'source_type', 'count_purchase_u_p'}
2025-05-05 12:59:31,140 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type']
2025-05-05 12:59:31,141 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 12:59:31,347 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_2abbf10af9e81bd85a95576e7d52c1bb.pkl
2025-05-05 12:59:37,822 - lavka_recsys.Experiment(random_baseline_657d53) - INFO - Run results saved: results/random_baseline_657d53_results.json
2025-05-05 12:59:37,824 - lavka_recsys.Experiment(random_baseline_657d53) - INFO - Run finished and results saved.
2025-05-05 13:00:59,204 - lavka_recsys.Experiment(random_baseline_657d53) - INFO - Computing predictions...
2025-05-05 13:00:59,207 - lavka_recsys.DataLoader - INFO - Holdout data merged back into training data.
2025-05-05 13:00:59,256 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 13:00:59,275 - lavka_recsys.DataLoader - INFO -   history: 2023-01-01 00:45:47 → 2024-01-03 16:53:15 (8_114_480 rows, 367 days)
2025-05-05 13:00:59,278 - lavka_recsys.DataLoader - INFO -   target: 2024-01-03 17:05:00 → 2024-02-02 16:58:16 (731_553 rows, 29 days)
2025-05-05 13:00:59,293 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_2abbf10af9e81bd85a95576e7d52c1bb.pkl
2025-05-05 13:00:59,363 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 13:00:59,365 - lavka_recsys.ModelFactory - INFO - Creating random_baseline model with params: {'task_type': 'CPU', 'thread_count': -1}
2025-05-05 13:00:59,365 - lavka_recsys.Experiment(random_baseline_657d53) - INFO - Training completed in 0.00s
2025-05-05 13:00:59,367 - lavka_recsys.DataLoader - INFO - Holdout data merged back into training data.
2025-05-05 13:00:59,383 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 13:00:59,384 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product
2025-05-05 13:00:59,385 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 13:00:59,386 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 13:00:59,642 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 13:00:59,643 - lavka_recsys.FeatureFactory - INFO - All column names: {'source_type', 'count_purchase_u_p'}
2025-05-05 13:00:59,644 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type']
2025-05-05 13:00:59,712 - lavka_recsys.Experiment(random_baseline_657d53) - INFO - Submission saved: results/submissions/random_baseline_657d53_submission.csv
2025-05-05 13:00:59,714 - lavka_recsys.Experiment(random_baseline_657d53) - INFO - Submission model saved: results/submissions/random_baseline_657d53_model.pkl
2025-05-05 13:28:23,368 - lavka_recsys.Experiment(random_baseline_008168) - INFO - Initialized experiment: random_baseline_008168
2025-05-05 13:28:23,386 - lavka_recsys.Experiment(random_baseline_008168) - INFO - Config saved: results/random_baseline_008168_config.json
2025-05-05 13:28:23,387 - lavka_recsys.Experiment(random_baseline_008168) - INFO - Setting up experiment environment...
2025-05-05 13:28:23,389 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 13:28:23,695 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 13:28:23,751 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 13:28:23,778 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 13:28:24,059 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 13:28:24,086 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 13:28:24,090 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 13:28:24,091 - lavka_recsys.Experiment(random_baseline_008168) - INFO - Setup complete.
2025-05-05 13:28:24,092 - lavka_recsys.Experiment(random_baseline_008168) - INFO - Starting experiment run...
2025-05-05 13:28:24,613 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 13:28:24,637 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 13:28:24,641 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 13:28:24,666 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 13:28:24,669 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 13:28:24,694 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 13:28:24,695 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, product_stats
2025-05-05 13:28:24,695 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 13:28:24,695 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 13:28:24,994 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 13:28:25,429 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 13:28:25,433 - lavka_recsys.FeatureFactory - INFO - All column names: {'product_total_interactions', 'product_total_views', 'source_type', 'product_unique_users', 'count_purchase_u_p', 'product_total_purchases'}
2025-05-05 13:28:25,434 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type']
2025-05-05 13:28:25,437 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 13:28:26,494 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_f7921e61aa0dfa49024954b578f991bc.pkl
2025-05-05 13:28:26,520 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 13:28:26,522 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, product_stats
2025-05-05 13:28:26,522 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 13:28:26,523 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 13:28:26,789 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 13:28:27,312 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 13:28:27,315 - lavka_recsys.FeatureFactory - INFO - All column names: {'product_total_interactions', 'product_total_views', 'source_type', 'product_unique_users', 'count_purchase_u_p', 'product_total_purchases'}
2025-05-05 13:28:27,316 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type']
2025-05-05 13:28:27,318 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 13:28:28,595 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_2d5cfff6cb99afdbfb81a19bf5b8947a.pkl
2025-05-05 13:28:28,596 - lavka_recsys.ModelFactory - INFO - Creating random_baseline model with params: {'task_type': 'CPU', 'thread_count': -1}
2025-05-05 13:28:28,598 - lavka_recsys.Experiment(random_baseline_008168) - INFO - Training completed in 0.00s
2025-05-05 13:28:28,601 - lavka_recsys.Experiment(random_baseline_008168) - INFO - Evaluating on holdout.
2025-05-05 13:28:28,633 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 13:28:28,635 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, product_stats
2025-05-05 13:28:28,636 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 13:28:28,636 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 13:28:28,909 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 13:28:29,642 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 13:28:29,644 - lavka_recsys.FeatureFactory - INFO - All column names: {'product_total_interactions', 'product_total_views', 'source_type', 'product_unique_users', 'count_purchase_u_p', 'product_total_purchases'}
2025-05-05 13:28:29,645 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type']
2025-05-05 13:28:29,646 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 13:28:30,825 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_6a083d639549506c921a85eeeadf547c.pkl
2025-05-05 13:28:42,160 - lavka_recsys.Experiment(random_baseline_008168) - INFO - Run results saved: results/random_baseline_008168_results.json
2025-05-05 13:28:42,161 - lavka_recsys.Experiment(random_baseline_008168) - INFO - Run finished and results saved.
2025-05-05 13:29:14,753 - lavka_recsys.Experiment(random_baseline_edfeb5) - INFO - Initialized experiment: random_baseline_edfeb5
2025-05-05 13:29:14,761 - lavka_recsys.Experiment(random_baseline_edfeb5) - INFO - Config saved: results/random_baseline_edfeb5_config.json
2025-05-05 13:29:14,762 - lavka_recsys.Experiment(random_baseline_edfeb5) - INFO - Setting up experiment environment...
2025-05-05 13:29:14,763 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 13:29:14,997 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 13:29:15,039 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 13:29:15,061 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 13:29:15,286 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 13:29:15,314 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 13:29:15,318 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 13:29:15,319 - lavka_recsys.Experiment(random_baseline_edfeb5) - INFO - Setup complete.
2025-05-05 13:29:15,320 - lavka_recsys.Experiment(random_baseline_edfeb5) - INFO - Starting experiment run...
2025-05-05 13:29:15,781 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 13:29:15,805 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 13:29:15,809 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 13:29:15,836 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 13:29:15,839 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 13:29:15,866 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 13:29:15,867 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: 
2025-05-05 13:29:15,867 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 13:29:15,868 - lavka_recsys.FeatureFactory - INFO - All column names: set()
2025-05-05 13:29:15,868 - lavka_recsys.FeatureFactory - INFO - All categorical column names: None
2025-05-05 13:29:15,869 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 13:29:16,865 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_f9eebb52d365d8a3c1da510b7c847a98.pkl
2025-05-05 13:29:16,896 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 13:29:16,897 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: 
2025-05-05 13:29:16,898 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 13:29:16,899 - lavka_recsys.FeatureFactory - INFO - All column names: set()
2025-05-05 13:29:16,902 - lavka_recsys.FeatureFactory - INFO - All categorical column names: None
2025-05-05 13:29:16,903 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 13:29:18,037 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_1664027d06ed0824e8555c7ba55ef5d7.pkl
2025-05-05 13:29:18,038 - lavka_recsys.ModelFactory - INFO - Creating random_baseline model with params: {'task_type': 'CPU', 'thread_count': -1}
2025-05-05 13:29:18,039 - lavka_recsys.Experiment(random_baseline_edfeb5) - INFO - Training completed in 0.00s
2025-05-05 13:29:18,043 - lavka_recsys.Experiment(random_baseline_edfeb5) - INFO - Evaluating on holdout.
2025-05-05 13:29:18,082 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 13:29:18,083 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: 
2025-05-05 13:29:18,085 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 13:29:18,086 - lavka_recsys.FeatureFactory - INFO - All column names: set()
2025-05-05 13:29:18,088 - lavka_recsys.FeatureFactory - INFO - All categorical column names: None
2025-05-05 13:29:18,089 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 13:29:19,109 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_f5b8e6689c544e07286b7c8500180b00.pkl
2025-05-05 13:33:11,093 - lavka_recsys.Experiment(random_baseline_d3e578) - INFO - Initialized experiment: random_baseline_d3e578
2025-05-05 13:33:11,101 - lavka_recsys.Experiment(random_baseline_d3e578) - INFO - Config saved: results/random_baseline_d3e578_config.json
2025-05-05 13:33:11,102 - lavka_recsys.Experiment(random_baseline_d3e578) - INFO - Setting up experiment environment...
2025-05-05 13:33:11,104 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 13:33:11,402 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 13:33:11,455 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 13:33:11,495 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 13:33:11,822 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 13:33:11,855 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 13:33:11,860 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 13:33:11,862 - lavka_recsys.Experiment(random_baseline_d3e578) - INFO - Setup complete.
2025-05-05 13:33:11,864 - lavka_recsys.Experiment(random_baseline_d3e578) - INFO - Starting experiment run...
2025-05-05 13:33:12,363 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 13:33:12,385 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 13:33:12,390 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 13:33:12,415 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 13:33:12,420 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 13:33:12,446 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 13:33:12,447 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: random_noise
2025-05-05 13:33:12,448 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: random_noise
2025-05-05 13:33:12,465 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 13:33:12,467 - lavka_recsys.FeatureFactory - INFO - All column names: {'random_noise'}
2025-05-05 13:33:12,468 - lavka_recsys.FeatureFactory - INFO - All categorical column names: None
2025-05-05 13:33:12,469 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 13:33:13,452 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_5388820807483b1dbe1f865aa9b8872d.pkl
2025-05-05 13:33:13,478 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 13:33:13,480 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: random_noise
2025-05-05 13:33:13,481 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: random_noise
2025-05-05 13:33:13,498 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 13:33:13,499 - lavka_recsys.FeatureFactory - INFO - All column names: {'random_noise'}
2025-05-05 13:33:13,500 - lavka_recsys.FeatureFactory - INFO - All categorical column names: None
2025-05-05 13:33:13,502 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 13:33:14,549 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_a6549304fb5303e4e7e63eae726ecdd5.pkl
2025-05-05 13:33:14,550 - lavka_recsys.ModelFactory - INFO - Creating random_baseline model with params: {'task_type': 'CPU', 'thread_count': -1}
2025-05-05 13:33:14,552 - lavka_recsys.Experiment(random_baseline_d3e578) - INFO - Training completed in 0.00s
2025-05-05 13:33:14,554 - lavka_recsys.Experiment(random_baseline_d3e578) - INFO - Evaluating on holdout.
2025-05-05 13:33:14,586 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 13:33:14,588 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: random_noise
2025-05-05 13:33:14,589 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: random_noise
2025-05-05 13:33:14,602 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 13:33:14,604 - lavka_recsys.FeatureFactory - INFO - All column names: {'random_noise'}
2025-05-05 13:33:14,606 - lavka_recsys.FeatureFactory - INFO - All categorical column names: None
2025-05-05 13:33:14,607 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 13:33:15,675 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_10a606a28690b7c2f44f295f71f07b39.pkl
2025-05-05 13:33:27,755 - lavka_recsys.Experiment(random_baseline_d3e578) - INFO - Run results saved: results/random_baseline_d3e578_results.json
2025-05-05 13:33:27,761 - lavka_recsys.Experiment(random_baseline_d3e578) - INFO - Run finished and results saved.
2025-05-05 13:34:16,704 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Initialized experiment: popularity_baseline_9550a7
2025-05-05 13:34:16,711 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Config saved: results/popularity_baseline_9550a7_config.json
2025-05-05 13:34:16,712 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Setting up experiment environment...
2025-05-05 13:34:16,713 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 13:34:17,089 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 13:34:17,153 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 13:34:17,182 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 13:34:17,432 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 13:34:17,463 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 13:34:17,467 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 13:34:17,468 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Setup complete.
2025-05-05 13:34:17,469 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Starting experiment run...
2025-05-05 13:34:17,980 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 13:34:18,001 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 13:34:18,005 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 13:34:18,030 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 13:34:18,035 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 13:34:18,066 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 13:34:18,067 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: product_stats
2025-05-05 13:34:18,069 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 13:34:18,561 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 13:34:18,562 - lavka_recsys.FeatureFactory - INFO - All column names: {'product_unique_users', 'product_total_views', 'product_total_purchases', 'product_total_interactions'}
2025-05-05 13:34:18,563 - lavka_recsys.FeatureFactory - INFO - All categorical column names: None
2025-05-05 13:34:18,565 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 13:34:19,647 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_d4b3e671a0b4d39f73f92d7447bc65b1.pkl
2025-05-05 13:34:19,678 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 13:34:19,679 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: product_stats
2025-05-05 13:34:19,681 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 13:34:20,234 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 13:34:20,235 - lavka_recsys.FeatureFactory - INFO - All column names: {'product_unique_users', 'product_total_views', 'product_total_purchases', 'product_total_interactions'}
2025-05-05 13:34:20,236 - lavka_recsys.FeatureFactory - INFO - All categorical column names: None
2025-05-05 13:34:20,237 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 13:34:21,372 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_a96f1fef7779a98755c81c10b65c1729.pkl
2025-05-05 13:34:21,373 - lavka_recsys.ModelFactory - INFO - Creating single_feature model with params: {'feature_name': 'product_total_purchases', 'desc': True, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 13:35:28,059 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Initialized experiment: popularity_baseline_9550a7
2025-05-05 13:35:28,071 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Config saved: results/popularity_baseline_9550a7_config.json
2025-05-05 13:35:28,073 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Setting up experiment environment...
2025-05-05 13:35:28,074 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 13:35:28,375 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 13:35:28,424 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 13:35:28,443 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 13:35:28,787 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 13:35:28,821 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 13:35:28,824 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 13:35:28,825 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Setup complete.
2025-05-05 13:35:28,826 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Starting experiment run...
2025-05-05 13:35:29,290 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 13:35:29,314 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 13:35:29,318 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 13:35:29,362 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 13:35:29,366 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 13:35:29,392 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_d4b3e671a0b4d39f73f92d7447bc65b1.pkl
2025-05-05 13:35:29,499 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 13:35:29,528 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_a96f1fef7779a98755c81c10b65c1729.pkl
2025-05-05 13:35:29,604 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 13:35:29,607 - lavka_recsys.ModelFactory - INFO - Creating single_feature model with params: {'feature_name': 'product_total_purchases', 'desc': True, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 13:37:23,717 - lavka_recsys.Experiment(random_baseline_01cd4c) - INFO - Initialized experiment: random_baseline_01cd4c
2025-05-05 13:37:23,724 - lavka_recsys.Experiment(random_baseline_01cd4c) - INFO - Config saved: results/random_baseline_01cd4c_config.json
2025-05-05 13:37:23,725 - lavka_recsys.Experiment(random_baseline_01cd4c) - INFO - Setting up experiment environment...
2025-05-05 13:37:23,726 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 13:37:24,111 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 13:37:24,182 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 13:37:24,222 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 13:37:24,558 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 13:37:24,585 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 13:37:24,589 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 13:37:24,590 - lavka_recsys.Experiment(random_baseline_01cd4c) - INFO - Setup complete.
2025-05-05 13:37:24,590 - lavka_recsys.Experiment(random_baseline_01cd4c) - INFO - Starting experiment run...
2025-05-05 13:37:25,043 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 13:37:25,065 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 13:37:25,069 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 13:37:25,095 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 13:37:25,099 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 13:37:25,124 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 13:37:25,125 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: product_id
2025-05-05 13:37:25,126 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_id
2025-05-05 13:37:25,126 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 13:37:25,127 - lavka_recsys.FeatureFactory - INFO - All column names: {'product_id'}
2025-05-05 13:37:25,128 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['product_id']
2025-05-05 13:37:25,129 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 13:37:26,131 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_2f863302129e783b6ff5f507574cd224.pkl
2025-05-05 13:37:26,163 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 13:37:26,167 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: product_id
2025-05-05 13:37:26,167 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_id
2025-05-05 13:37:26,167 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 13:37:26,168 - lavka_recsys.FeatureFactory - INFO - All column names: {'product_id'}
2025-05-05 13:37:26,168 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['product_id']
2025-05-05 13:37:26,170 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 13:37:27,092 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_171cc55bfa2f1ce43c72e951aa8a1e1b.pkl
2025-05-05 13:37:27,093 - lavka_recsys.ModelFactory - INFO - Creating random_baseline model with params: {'task_type': 'CPU', 'thread_count': -1}
2025-05-05 13:37:27,094 - lavka_recsys.Experiment(random_baseline_01cd4c) - INFO - Training completed in 0.00s
2025-05-05 13:37:27,096 - lavka_recsys.Experiment(random_baseline_01cd4c) - INFO - Evaluating on holdout.
2025-05-05 13:37:27,127 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 13:37:27,128 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: product_id
2025-05-05 13:37:27,130 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_id
2025-05-05 13:37:27,130 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 13:37:27,131 - lavka_recsys.FeatureFactory - INFO - All column names: {'product_id'}
2025-05-05 13:37:27,132 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['product_id']
2025-05-05 13:37:27,134 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 13:37:28,052 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_d3f83032832a33ad717cc8bda841b79f.pkl
2025-05-05 13:37:39,862 - lavka_recsys.Experiment(random_baseline_01cd4c) - INFO - Run results saved: results/random_baseline_01cd4c_results.json
2025-05-05 13:37:39,864 - lavka_recsys.Experiment(random_baseline_01cd4c) - INFO - Run finished and results saved.
2025-05-05 13:37:49,608 - lavka_recsys.Experiment(popularity_baseline_b2ec07) - INFO - Initialized experiment: popularity_baseline_b2ec07
2025-05-05 13:37:49,615 - lavka_recsys.Experiment(popularity_baseline_b2ec07) - INFO - Config saved: results/popularity_baseline_b2ec07_config.json
2025-05-05 13:37:49,616 - lavka_recsys.Experiment(popularity_baseline_b2ec07) - INFO - Setting up experiment environment...
2025-05-05 13:37:49,617 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 13:37:49,884 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 13:37:49,955 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 13:37:49,981 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 13:37:50,230 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 13:37:50,255 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 13:37:50,259 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 13:37:50,260 - lavka_recsys.Experiment(popularity_baseline_b2ec07) - INFO - Setup complete.
2025-05-05 13:37:50,260 - lavka_recsys.Experiment(popularity_baseline_b2ec07) - INFO - Starting experiment run...
2025-05-05 13:37:50,663 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 13:37:50,685 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 13:37:50,689 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 13:37:50,715 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 13:37:50,719 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 13:37:50,743 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 13:37:50,744 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: product_stats, product_id
2025-05-05 13:37:50,745 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 13:37:51,229 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_id
2025-05-05 13:37:51,229 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 13:37:51,230 - lavka_recsys.FeatureFactory - INFO - All column names: {'product_unique_users', 'product_total_interactions', 'product_id', 'product_total_views', 'product_total_purchases'}
2025-05-05 13:37:51,231 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['product_id']
2025-05-05 13:37:51,233 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 13:37:52,344 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_b29e2e376e39842342ec97d7d927804d.pkl
2025-05-05 13:37:52,369 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 13:37:52,370 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: product_stats, product_id
2025-05-05 13:37:52,371 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 13:37:52,871 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_id
2025-05-05 13:37:52,871 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 13:37:52,872 - lavka_recsys.FeatureFactory - INFO - All column names: {'product_unique_users', 'product_total_interactions', 'product_id', 'product_total_views', 'product_total_purchases'}
2025-05-05 13:37:52,872 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['product_id']
2025-05-05 13:37:52,874 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 13:37:53,916 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_5d1efea09e9c4f858a51e910cc6846f4.pkl
2025-05-05 13:37:53,918 - lavka_recsys.ModelFactory - INFO - Creating single_feature model with params: {'feature_name': 'product_total_purchases', 'desc': True, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 13:44:06,743 - lavka_recsys.Experiment(random_baseline_d3e578) - INFO - Initialized experiment: random_baseline_d3e578
2025-05-05 13:44:06,750 - lavka_recsys.Experiment(random_baseline_d3e578) - INFO - Config saved: results/random_baseline_d3e578_config.json
2025-05-05 13:44:06,752 - lavka_recsys.Experiment(random_baseline_d3e578) - INFO - Setting up experiment environment...
2025-05-05 13:44:06,753 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 13:44:07,094 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 13:44:07,149 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 13:44:07,170 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 13:44:07,479 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 13:44:07,508 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 13:44:07,512 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 13:44:07,513 - lavka_recsys.Experiment(random_baseline_d3e578) - INFO - Setup complete.
2025-05-05 13:44:07,514 - lavka_recsys.Experiment(random_baseline_d3e578) - INFO - Starting experiment run...
2025-05-05 13:44:07,966 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 13:44:07,988 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 13:44:07,992 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 13:44:08,018 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 13:44:08,023 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 13:44:08,049 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_5388820807483b1dbe1f865aa9b8872d.pkl
2025-05-05 13:44:08,110 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 13:44:08,137 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_a6549304fb5303e4e7e63eae726ecdd5.pkl
2025-05-05 13:44:08,201 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 13:44:08,203 - lavka_recsys.ModelFactory - INFO - Creating random_baseline model with params: {'task_type': 'CPU', 'thread_count': -1}
2025-05-05 13:44:08,205 - lavka_recsys.Experiment(random_baseline_d3e578) - INFO - Training completed in 0.00s
2025-05-05 13:44:08,206 - lavka_recsys.Experiment(random_baseline_d3e578) - INFO - Evaluating on holdout.
2025-05-05 13:44:08,238 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_10a606a28690b7c2f44f295f71f07b39.pkl
2025-05-05 13:44:08,299 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 13:44:20,013 - lavka_recsys.Experiment(random_baseline_d3e578) - INFO - Run results saved: results/random_baseline_d3e578_results.json
2025-05-05 13:44:20,016 - lavka_recsys.Experiment(random_baseline_d3e578) - INFO - Run finished and results saved.
2025-05-05 13:44:32,389 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Initialized experiment: popularity_baseline_9550a7
2025-05-05 13:44:32,405 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Config saved: results/popularity_baseline_9550a7_config.json
2025-05-05 13:44:32,407 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Setting up experiment environment...
2025-05-05 13:44:32,408 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 13:44:32,657 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 13:44:32,719 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 13:44:32,745 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 13:44:32,994 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 13:44:33,025 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 13:44:33,029 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 13:44:33,030 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Setup complete.
2025-05-05 13:44:33,031 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Starting experiment run...
2025-05-05 13:44:33,453 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 13:44:33,475 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 13:44:33,479 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 13:44:33,505 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 13:44:33,510 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 13:44:33,535 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_d4b3e671a0b4d39f73f92d7447bc65b1.pkl
2025-05-05 13:44:33,618 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 13:44:33,646 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_a96f1fef7779a98755c81c10b65c1729.pkl
2025-05-05 13:44:33,724 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 13:44:33,727 - lavka_recsys.ModelFactory - INFO - Creating single_feature model with params: {'feature_name': 'product_total_purchases', 'desc': True, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 13:44:33,728 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Training completed in 0.00s
2025-05-05 13:44:33,730 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Evaluating on holdout.
2025-05-05 13:44:33,762 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 13:44:33,763 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: product_stats
2025-05-05 13:44:33,764 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 13:44:34,342 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 13:44:34,343 - lavka_recsys.FeatureFactory - INFO - All column names: {'product_total_purchases', 'product_total_interactions', 'product_unique_users', 'product_total_views'}
2025-05-05 13:44:34,345 - lavka_recsys.FeatureFactory - INFO - All categorical column names: None
2025-05-05 13:44:34,347 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 13:44:35,441 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_34dba4fc0062a940cbeb34a41a90b512.pkl
2025-05-05 13:46:51,824 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Initialized experiment: popularity_baseline_9550a7
2025-05-05 13:46:51,830 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Config saved: results/popularity_baseline_9550a7_config.json
2025-05-05 13:46:51,831 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Setting up experiment environment...
2025-05-05 13:46:51,833 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 13:46:52,168 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 13:46:52,222 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 13:46:52,260 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 13:46:52,535 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 13:46:52,563 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 13:46:52,567 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 13:46:52,568 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Setup complete.
2025-05-05 13:46:52,569 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Starting experiment run...
2025-05-05 13:46:53,086 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 13:46:53,109 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 13:46:53,113 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 13:46:53,139 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 13:46:53,144 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 13:46:53,186 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_d4b3e671a0b4d39f73f92d7447bc65b1.pkl
2025-05-05 13:46:53,281 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 13:46:53,313 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_a96f1fef7779a98755c81c10b65c1729.pkl
2025-05-05 13:46:53,396 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 13:46:53,399 - lavka_recsys.ModelFactory - INFO - Creating single_feature model with params: {'feature_name': 'product_total_purchases', 'desc': True, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 13:46:53,400 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Training completed in 0.00s
2025-05-05 13:46:53,401 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Evaluating on holdout.
2025-05-05 13:46:53,433 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_34dba4fc0062a940cbeb34a41a90b512.pkl
2025-05-05 13:46:53,491 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 13:49:51,945 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Initialized experiment: popularity_baseline_9550a7
2025-05-05 13:49:51,952 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Config saved: results/popularity_baseline_9550a7_config.json
2025-05-05 13:49:51,953 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Setting up experiment environment...
2025-05-05 13:49:51,955 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 13:49:52,296 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 13:49:52,355 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 13:49:52,390 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 13:49:52,723 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 13:49:52,750 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 13:49:52,754 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 13:49:52,756 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Setup complete.
2025-05-05 13:49:52,758 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Starting experiment run...
2025-05-05 13:49:53,175 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 13:49:53,198 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 13:49:53,202 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 13:49:53,228 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 13:49:53,233 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 13:49:53,258 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_d4b3e671a0b4d39f73f92d7447bc65b1.pkl
2025-05-05 13:49:53,387 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 13:49:53,416 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_a96f1fef7779a98755c81c10b65c1729.pkl
2025-05-05 13:49:53,502 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 13:49:53,508 - lavka_recsys.ModelFactory - INFO - Creating single_feature model with params: {'feature_name': 'product_total_purchases', 'desc': True, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 13:49:53,509 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Training completed in 0.00s
2025-05-05 13:49:53,512 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Evaluating on holdout.
2025-05-05 13:49:53,545 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_34dba4fc0062a940cbeb34a41a90b512.pkl
2025-05-05 13:49:53,612 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 13:50:45,534 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Initialized experiment: popularity_baseline_9550a7
2025-05-05 13:50:45,543 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Config saved: results/popularity_baseline_9550a7_config.json
2025-05-05 13:50:45,545 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Setting up experiment environment...
2025-05-05 13:50:45,546 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 13:50:45,867 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 13:50:45,918 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 13:50:45,954 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 13:50:46,298 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 13:50:46,324 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 13:50:46,329 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 13:50:46,330 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Setup complete.
2025-05-05 13:50:46,331 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Starting experiment run...
2025-05-05 13:50:46,789 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 13:50:46,811 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 13:50:46,815 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 13:50:46,840 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 13:50:46,844 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 13:50:46,868 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_d4b3e671a0b4d39f73f92d7447bc65b1.pkl
2025-05-05 13:50:46,956 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 13:50:46,984 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_a96f1fef7779a98755c81c10b65c1729.pkl
2025-05-05 13:50:47,074 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 13:50:47,076 - lavka_recsys.ModelFactory - INFO - Creating single_feature model with params: {'feature_name': 'product_total_purchases', 'desc': True, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 13:50:47,077 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Training completed in 0.00s
2025-05-05 13:50:47,078 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Evaluating on holdout.
2025-05-05 13:50:47,109 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_34dba4fc0062a940cbeb34a41a90b512.pkl
2025-05-05 13:50:47,172 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 13:52:15,686 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Initialized experiment: popularity_baseline_9550a7
2025-05-05 13:52:15,696 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Config saved: results/popularity_baseline_9550a7_config.json
2025-05-05 13:52:15,698 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Setting up experiment environment...
2025-05-05 13:52:15,700 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 13:52:15,990 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 13:52:16,045 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 13:52:16,087 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 13:52:16,380 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 13:52:16,409 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 13:52:16,414 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 13:52:16,415 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Setup complete.
2025-05-05 13:52:16,416 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Starting experiment run...
2025-05-05 13:52:16,863 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 13:52:16,884 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 13:52:16,888 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 13:52:16,915 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 13:52:16,932 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 13:52:16,958 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_d4b3e671a0b4d39f73f92d7447bc65b1.pkl
2025-05-05 13:52:17,061 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 13:52:17,087 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_a96f1fef7779a98755c81c10b65c1729.pkl
2025-05-05 13:52:17,170 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 13:52:17,172 - lavka_recsys.ModelFactory - INFO - Creating single_feature model with params: {'feature_name': 'product_total_purchases', 'desc': True, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 13:52:17,174 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Training completed in 0.00s
2025-05-05 13:52:17,175 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Evaluating on holdout.
2025-05-05 13:52:17,205 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_34dba4fc0062a940cbeb34a41a90b512.pkl
2025-05-05 13:52:17,266 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 13:52:28,749 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Run results saved: results/popularity_baseline_9550a7_results.json
2025-05-05 13:52:28,751 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Run finished and results saved.
2025-05-05 13:53:21,963 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Computing predictions...
2025-05-05 13:53:21,970 - lavka_recsys.DataLoader - INFO - Holdout data merged back into training data.
2025-05-05 13:53:22,008 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 13:53:22,039 - lavka_recsys.DataLoader - INFO -   history: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 13:53:22,043 - lavka_recsys.DataLoader - INFO -   target: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 13:53:22,074 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_34dba4fc0062a940cbeb34a41a90b512.pkl
2025-05-05 13:53:22,148 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 13:53:22,151 - lavka_recsys.ModelFactory - INFO - Creating single_feature model with params: {'feature_name': 'product_total_purchases', 'desc': True, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 13:53:22,152 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Training completed in 0.00s
2025-05-05 13:53:22,157 - lavka_recsys.DataLoader - INFO - Holdout data merged back into training data.
2025-05-05 13:53:22,192 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 13:53:22,194 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: product_stats
2025-05-05 13:53:22,196 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 13:53:22,848 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 13:53:22,850 - lavka_recsys.FeatureFactory - INFO - All column names: {'product_total_views', 'product_unique_users', 'product_total_interactions', 'product_total_purchases'}
2025-05-05 13:53:22,851 - lavka_recsys.FeatureFactory - INFO - All categorical column names: None
2025-05-05 13:53:22,938 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Submission saved: results/submissions/popularity_baseline_9550a7_submission.csv
2025-05-05 13:53:22,941 - lavka_recsys.Experiment(popularity_baseline_9550a7) - INFO - Submission model saved: results/submissions/popularity_baseline_9550a7_model.pkl
2025-05-05 16:26:37,714 - lavka_recsys.Experiment(catboost_classifier_04eb5e) - INFO - Initialized experiment: catboost_classifier_04eb5e
2025-05-05 16:26:37,736 - lavka_recsys.Experiment(catboost_classifier_04eb5e) - INFO - Config saved: results/catboost_classifier_04eb5e_config.json
2025-05-05 16:26:37,737 - lavka_recsys.Experiment(catboost_classifier_04eb5e) - INFO - Setting up experiment environment...
2025-05-05 16:26:37,738 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 16:26:37,899 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 16:26:37,952 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 16:26:37,978 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 16:26:38,215 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 16:26:38,242 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 16:26:38,247 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 16:26:38,249 - lavka_recsys.Experiment(catboost_classifier_04eb5e) - INFO - Setup complete.
2025-05-05 16:26:38,254 - lavka_recsys.Experiment(catboost_classifier_04eb5e) - INFO - Starting experiment run...
2025-05-05 16:26:38,677 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 16:26:38,699 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 16:26:38,703 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 16:26:38,729 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 16:26:38,733 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 16:26:38,758 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 16:26:38,760 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats
2025-05-05 16:26:38,761 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 16:26:38,761 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 16:26:39,054 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 16:26:39,141 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 16:26:39,535 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 16:26:39,947 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 16:26:40,356 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 16:26:41,444 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 16:26:41,781 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 16:26:42,169 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 16:26:42,170 - lavka_recsys.FeatureFactory - INFO - All column names: {'source_type', 'count_purchase_u_p', 'user_total_purchases', 'user_unique_products', 'ctr_product', 'user_total_interactions', 'purchase_view_ratio', 'cart_to_purchase_rate', 'product_total_interactions', 'product_total_views', 'product_unique_users', 'user_total_views', 'days_since_interaction_u_p', 'product_total_purchases', 'count_purchase_u_s'}
2025-05-05 16:26:42,171 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type']
2025-05-05 16:26:42,172 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 16:26:43,392 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_bf618251cfa2d097ad4312554b944c57.pkl
2025-05-05 16:26:43,421 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 16:26:43,422 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats
2025-05-05 16:26:43,422 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 16:26:43,423 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 16:26:43,710 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 16:26:43,774 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 16:26:44,203 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 16:26:44,559 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 16:26:45,030 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 16:26:46,068 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 16:26:46,400 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 16:26:46,763 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 16:26:46,765 - lavka_recsys.FeatureFactory - INFO - All column names: {'source_type', 'count_purchase_u_p', 'user_total_purchases', 'user_unique_products', 'ctr_product', 'user_total_interactions', 'purchase_view_ratio', 'cart_to_purchase_rate', 'product_total_interactions', 'product_total_views', 'product_unique_users', 'user_total_views', 'days_since_interaction_u_p', 'product_total_purchases', 'count_purchase_u_s'}
2025-05-05 16:26:46,765 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type']
2025-05-05 16:26:46,767 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 16:26:47,982 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_9367ee9403ef9d1a8a4535588987d34c.pkl
2025-05-05 16:26:47,983 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'loss_function': 'Logloss', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 16:26:48,141 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 16:26:51,113 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 16:26:53,618 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 16:26:54,660 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 16:26:55,645 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoostClassifier model with columns: ['source_type', 'count_purchase_u_p', 'user_total_purchases', 'user_unique_products', 'ctr_product', 'user_total_interactions', 'purchase_view_ratio', 'cart_to_purchase_rate', 'product_total_interactions', 'product_total_views', 'product_unique_users', 'user_total_views', 'days_since_interaction_u_p', 'product_total_purchases', 'count_purchase_u_s'] (cat_columns: ['source_type'])
2025-05-05 16:27:34,859 - lavka_recsys.Experiment(catboost_classifier_04eb5e) - INFO - Training completed in 46.85s
2025-05-05 16:27:34,864 - lavka_recsys.Experiment(catboost_classifier_04eb5e) - INFO - Evaluating on holdout.
2025-05-05 16:27:34,928 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 16:27:34,929 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats
2025-05-05 16:27:34,930 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 16:27:34,930 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 16:27:35,403 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 16:27:35,509 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 16:27:36,118 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 16:27:36,588 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 16:27:37,094 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 16:27:38,337 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 16:27:38,791 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 16:27:39,290 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 16:27:39,291 - lavka_recsys.FeatureFactory - INFO - All column names: {'source_type', 'count_purchase_u_p', 'user_total_purchases', 'user_unique_products', 'ctr_product', 'user_total_interactions', 'purchase_view_ratio', 'cart_to_purchase_rate', 'product_total_interactions', 'product_total_views', 'product_unique_users', 'user_total_views', 'days_since_interaction_u_p', 'product_total_purchases', 'count_purchase_u_s'}
2025-05-05 16:27:39,292 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type']
2025-05-05 16:27:39,293 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: CartUpdate_Purchase_vs_View
2025-05-05 16:27:40,621 - lavka_recsys.CachedFeatureFactory - DEBUG - Saved cache results/feature_cache/cache_00773469f1f0e86c2a746a8f6c1c02a8.pkl
2025-05-05 16:27:40,709 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 16:27:55,127 - lavka_recsys.Experiment(catboost_classifier_04eb5e) - INFO - Run results saved: results/catboost_classifier_04eb5e_results.json
2025-05-05 16:27:55,130 - lavka_recsys.Experiment(catboost_classifier_04eb5e) - INFO - Run finished and results saved.
2025-05-05 16:44:05,491 - lavka_recsys.Experiment(catboost_classifier_b5067f) - INFO - Initialized experiment: catboost_classifier_b5067f
2025-05-05 16:44:05,499 - lavka_recsys.Experiment(catboost_classifier_b5067f) - INFO - Config saved: results/catboost_classifier_b5067f_config.json
2025-05-05 16:44:05,500 - lavka_recsys.Experiment(catboost_classifier_b5067f) - INFO - Setting up experiment environment...
2025-05-05 16:44:05,501 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 16:44:05,843 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 16:44:05,902 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 16:44:05,926 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 16:44:06,251 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 16:44:06,277 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 16:44:06,281 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 16:44:06,282 - lavka_recsys.Experiment(catboost_classifier_b5067f) - INFO - Setup complete.
2025-05-05 16:44:06,282 - lavka_recsys.Experiment(catboost_classifier_b5067f) - INFO - Starting experiment run...
2025-05-05 16:44:06,782 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 16:44:06,806 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 16:44:06,810 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 16:44:06,841 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 16:44:06,848 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 16:44:06,876 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_bf618251cfa2d097ad4312554b944c57.pkl
2025-05-05 16:44:07,312 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 16:44:07,340 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_9367ee9403ef9d1a8a4535588987d34c.pkl
2025-05-05 16:44:07,649 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 16:44:07,652 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'loss_function': 'Logloss', 'eval_metric': 'AUC', 'early_stopping_rounds': 50, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 16:44:07,820 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 16:44:10,516 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 16:44:12,997 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 16:44:14,036 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 16:44:14,913 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoostClassifier model with columns: ['source_type', 'count_purchase_u_p', 'user_total_purchases', 'user_unique_products', 'ctr_product', 'user_total_interactions', 'purchase_view_ratio', 'cart_to_purchase_rate', 'product_total_interactions', 'product_total_views', 'product_unique_users', 'user_total_views', 'days_since_interaction_u_p', 'product_total_purchases', 'count_purchase_u_s'] (cat_columns: ['source_type'])
2025-05-05 16:44:55,901 - lavka_recsys.Experiment(catboost_classifier_b5067f) - INFO - Training completed in 48.21s
2025-05-05 16:44:55,905 - lavka_recsys.Experiment(catboost_classifier_b5067f) - INFO - Evaluating on holdout.
2025-05-05 16:44:56,036 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_00773469f1f0e86c2a746a8f6c1c02a8.pkl
2025-05-05 16:44:56,463 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 16:44:56,591 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 16:45:10,613 - lavka_recsys.Experiment(catboost_classifier_b5067f) - INFO - Run results saved: results/catboost_classifier_b5067f_results.json
2025-05-05 16:45:10,616 - lavka_recsys.Experiment(catboost_classifier_b5067f) - INFO - Run finished and results saved.
2025-05-05 17:03:05,371 - lavka_recsys.Experiment(random_baseline_587898) - INFO - Initialized experiment: random_baseline_587898
2025-05-05 17:03:05,393 - lavka_recsys.Experiment(random_baseline_587898) - INFO - Config saved: results/random_baseline_587898_config.json
2025-05-05 17:03:05,394 - lavka_recsys.Experiment(random_baseline_587898) - INFO - Setting up experiment environment...
2025-05-05 17:03:05,396 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 17:03:05,718 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 17:03:05,770 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 17:03:05,806 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 17:03:06,105 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 17:03:06,133 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 17:03:06,137 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 17:03:06,138 - lavka_recsys.Experiment(random_baseline_587898) - INFO - Setup complete.
2025-05-05 17:03:06,138 - lavka_recsys.Experiment(random_baseline_587898) - INFO - Starting experiment run...
2025-05-05 17:03:06,625 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 17:03:06,649 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 17:03:06,653 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 17:03:06,682 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 17:03:06,685 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 17:03:06,713 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_5388820807483b1dbe1f865aa9b8872d.pkl
2025-05-05 17:03:06,779 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 17:03:06,807 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_a6549304fb5303e4e7e63eae726ecdd5.pkl
2025-05-05 17:03:06,889 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 17:03:06,894 - lavka_recsys.ModelFactory - INFO - Creating random_baseline model with params: {'task_type': 'CPU', 'thread_count': -1}
2025-05-05 17:03:06,896 - lavka_recsys.Experiment(random_baseline_587898) - INFO - Training completed in 0.00s
2025-05-05 17:03:06,897 - lavka_recsys.Experiment(random_baseline_587898) - INFO - Evaluating on holdout.
2025-05-05 17:03:06,929 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_10a606a28690b7c2f44f295f71f07b39.pkl
2025-05-05 17:03:06,991 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 17:03:18,168 - lavka_recsys.Experiment(random_baseline_587898) - INFO - Run results saved: results/random_baseline_587898_results.json
2025-05-05 17:03:18,172 - lavka_recsys.Experiment(random_baseline_587898) - INFO - Run finished and results saved.
2025-05-05 17:03:18,477 - lavka_recsys.Experiment(popularity_baseline_03697e) - INFO - Initialized experiment: popularity_baseline_03697e
2025-05-05 17:03:18,484 - lavka_recsys.Experiment(popularity_baseline_03697e) - INFO - Config saved: results/popularity_baseline_03697e_config.json
2025-05-05 17:03:18,485 - lavka_recsys.Experiment(popularity_baseline_03697e) - INFO - Setting up experiment environment...
2025-05-05 17:03:18,486 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 17:03:18,767 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 17:03:18,831 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 17:03:18,845 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 17:03:18,997 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 17:03:19,024 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 17:03:19,027 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 17:03:19,029 - lavka_recsys.Experiment(popularity_baseline_03697e) - INFO - Setup complete.
2025-05-05 17:03:19,029 - lavka_recsys.Experiment(popularity_baseline_03697e) - INFO - Starting experiment run...
2025-05-05 17:03:19,422 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 17:03:19,444 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 17:03:19,448 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 17:03:19,474 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 17:03:19,479 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 17:03:19,505 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_d4b3e671a0b4d39f73f92d7447bc65b1.pkl
2025-05-05 17:03:19,592 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 17:03:19,620 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_a96f1fef7779a98755c81c10b65c1729.pkl
2025-05-05 17:03:19,708 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 17:03:19,712 - lavka_recsys.ModelFactory - INFO - Creating single_feature model with params: {'feature_name': 'product_total_purchases', 'desc': True, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 17:03:19,715 - lavka_recsys.Experiment(popularity_baseline_03697e) - INFO - Training completed in 0.00s
2025-05-05 17:03:19,717 - lavka_recsys.Experiment(popularity_baseline_03697e) - INFO - Evaluating on holdout.
2025-05-05 17:03:19,754 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_34dba4fc0062a940cbeb34a41a90b512.pkl
2025-05-05 17:03:19,817 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 17:03:30,791 - lavka_recsys.Experiment(popularity_baseline_03697e) - INFO - Run results saved: results/popularity_baseline_03697e_results.json
2025-05-05 17:03:30,794 - lavka_recsys.Experiment(popularity_baseline_03697e) - INFO - Run finished and results saved.
2025-05-05 17:03:44,091 - lavka_recsys.Experiment(catboost_classifier_2b6c6d) - INFO - Initialized experiment: catboost_classifier_2b6c6d
2025-05-05 17:03:44,098 - lavka_recsys.Experiment(catboost_classifier_2b6c6d) - INFO - Config saved: results/catboost_classifier_2b6c6d_config.json
2025-05-05 17:03:44,100 - lavka_recsys.Experiment(catboost_classifier_2b6c6d) - INFO - Setting up experiment environment...
2025-05-05 17:03:44,101 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 17:03:44,442 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 17:03:44,493 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 17:03:44,517 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 17:03:44,721 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 17:03:44,749 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 17:03:44,753 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 17:03:44,754 - lavka_recsys.Experiment(catboost_classifier_2b6c6d) - INFO - Setup complete.
2025-05-05 17:03:44,755 - lavka_recsys.Experiment(catboost_classifier_2b6c6d) - INFO - Starting experiment run...
2025-05-05 17:03:45,218 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 17:03:45,241 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 17:03:45,245 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 17:03:45,270 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 17:03:45,274 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 17:03:45,299 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_bf618251cfa2d097ad4312554b944c57.pkl
2025-05-05 17:03:45,649 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 17:03:45,679 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_9367ee9403ef9d1a8a4535588987d34c.pkl
2025-05-05 17:03:45,999 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 17:03:46,001 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'loss_function': 'Logloss', 'eval_metric': 'AUC', 'early_stopping_rounds': 50, 'custom_metric': ['AUC'], 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 17:03:46,161 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 17:03:48,723 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 17:03:51,215 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 17:03:52,350 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 17:03:53,442 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoostClassifier model with columns: ['source_type', 'count_purchase_u_p', 'user_total_purchases', 'user_unique_products', 'ctr_product', 'user_total_interactions', 'purchase_view_ratio', 'cart_to_purchase_rate', 'product_total_interactions', 'product_total_views', 'product_unique_users', 'user_total_views', 'days_since_interaction_u_p', 'product_total_purchases', 'count_purchase_u_s'] (cat_columns: ['source_type'])
2025-05-05 17:04:33,912 - lavka_recsys.Experiment(catboost_classifier_2b6c6d) - INFO - Training completed in 47.89s
2025-05-05 17:04:33,916 - lavka_recsys.Experiment(catboost_classifier_2b6c6d) - INFO - Evaluating on holdout.
2025-05-05 17:04:33,983 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_00773469f1f0e86c2a746a8f6c1c02a8.pkl
2025-05-05 17:04:34,382 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 17:04:34,471 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 17:04:52,189 - lavka_recsys.Experiment(random_baseline_587898) - INFO - Initialized experiment: random_baseline_587898
2025-05-05 17:04:52,198 - lavka_recsys.Experiment(random_baseline_587898) - INFO - Config saved: results/random_baseline_587898_config.json
2025-05-05 17:04:52,199 - lavka_recsys.Experiment(random_baseline_587898) - INFO - Setting up experiment environment...
2025-05-05 17:04:52,201 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 17:04:52,508 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 17:04:52,576 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 17:04:52,605 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 17:04:52,924 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 17:04:52,951 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 17:04:52,955 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 17:04:52,956 - lavka_recsys.Experiment(random_baseline_587898) - INFO - Setup complete.
2025-05-05 17:04:52,957 - lavka_recsys.Experiment(random_baseline_587898) - INFO - Starting experiment run...
2025-05-05 17:04:53,437 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 17:04:53,459 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 17:04:53,463 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 17:04:53,497 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 17:04:53,504 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 17:04:53,532 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_5388820807483b1dbe1f865aa9b8872d.pkl
2025-05-05 17:04:53,596 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 17:04:53,622 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_a6549304fb5303e4e7e63eae726ecdd5.pkl
2025-05-05 17:04:53,695 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 17:04:53,697 - lavka_recsys.ModelFactory - INFO - Creating random_baseline model with params: {'task_type': 'CPU', 'thread_count': -1}
2025-05-05 17:04:53,698 - lavka_recsys.Experiment(random_baseline_587898) - INFO - Training completed in 0.00s
2025-05-05 17:04:53,698 - lavka_recsys.Experiment(random_baseline_587898) - INFO - Evaluating on holdout.
2025-05-05 17:04:53,730 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_10a606a28690b7c2f44f295f71f07b39.pkl
2025-05-05 17:04:53,795 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 17:05:05,421 - lavka_recsys.Experiment(random_baseline_587898) - INFO - Run results saved: results/random_baseline_587898_results.json
2025-05-05 17:05:05,422 - lavka_recsys.Experiment(random_baseline_587898) - INFO - Run finished and results saved.
2025-05-05 17:05:05,667 - lavka_recsys.Experiment(popularity_baseline_03697e) - INFO - Initialized experiment: popularity_baseline_03697e
2025-05-05 17:05:05,674 - lavka_recsys.Experiment(popularity_baseline_03697e) - INFO - Config saved: results/popularity_baseline_03697e_config.json
2025-05-05 17:05:05,675 - lavka_recsys.Experiment(popularity_baseline_03697e) - INFO - Setting up experiment environment...
2025-05-05 17:05:05,677 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 17:05:06,006 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 17:05:06,087 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 17:05:06,101 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 17:05:06,297 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 17:05:06,324 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 17:05:06,328 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 17:05:06,329 - lavka_recsys.Experiment(popularity_baseline_03697e) - INFO - Setup complete.
2025-05-05 17:05:06,330 - lavka_recsys.Experiment(popularity_baseline_03697e) - INFO - Starting experiment run...
2025-05-05 17:05:06,725 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 17:05:06,745 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 17:05:06,749 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 17:05:06,773 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 17:05:06,777 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 17:05:06,807 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_d4b3e671a0b4d39f73f92d7447bc65b1.pkl
2025-05-05 17:05:06,897 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 17:05:06,923 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_a96f1fef7779a98755c81c10b65c1729.pkl
2025-05-05 17:05:06,997 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 17:05:06,999 - lavka_recsys.ModelFactory - INFO - Creating single_feature model with params: {'feature_name': 'product_total_purchases', 'desc': True, 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 17:05:07,000 - lavka_recsys.Experiment(popularity_baseline_03697e) - INFO - Training completed in 0.00s
2025-05-05 17:05:07,001 - lavka_recsys.Experiment(popularity_baseline_03697e) - INFO - Evaluating on holdout.
2025-05-05 17:05:07,032 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_34dba4fc0062a940cbeb34a41a90b512.pkl
2025-05-05 17:05:07,101 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 17:05:18,649 - lavka_recsys.Experiment(popularity_baseline_03697e) - INFO - Run results saved: results/popularity_baseline_03697e_results.json
2025-05-05 17:05:18,653 - lavka_recsys.Experiment(popularity_baseline_03697e) - INFO - Run finished and results saved.
2025-05-05 17:05:47,136 - lavka_recsys.Experiment(catboost_classifier_2b6c6d) - INFO - Initialized experiment: catboost_classifier_2b6c6d
2025-05-05 17:05:47,143 - lavka_recsys.Experiment(catboost_classifier_2b6c6d) - INFO - Config saved: results/catboost_classifier_2b6c6d_config.json
2025-05-05 17:05:47,145 - lavka_recsys.Experiment(catboost_classifier_2b6c6d) - INFO - Setting up experiment environment...
2025-05-05 17:05:47,146 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 17:05:47,461 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 17:05:47,530 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 17:05:47,551 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 17:05:47,715 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 17:05:47,741 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 17:05:47,745 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 17:05:47,746 - lavka_recsys.Experiment(catboost_classifier_2b6c6d) - INFO - Setup complete.
2025-05-05 17:05:47,746 - lavka_recsys.Experiment(catboost_classifier_2b6c6d) - INFO - Starting experiment run...
2025-05-05 17:05:48,139 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 17:05:48,160 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 17:05:48,164 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 17:05:48,189 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 17:05:48,194 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 17:05:48,219 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_bf618251cfa2d097ad4312554b944c57.pkl
2025-05-05 17:05:48,589 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 17:05:48,621 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_9367ee9403ef9d1a8a4535588987d34c.pkl
2025-05-05 17:05:48,958 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 17:05:48,960 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'loss_function': 'Logloss', 'eval_metric': 'AUC', 'early_stopping_rounds': 50, 'custom_metric': ['AUC'], 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 17:05:49,137 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 17:06:39,006 - lavka_recsys.Experiment(catboost_classifier_2b6c6d) - INFO - Initialized experiment: catboost_classifier_2b6c6d
2025-05-05 17:06:39,015 - lavka_recsys.Experiment(catboost_classifier_2b6c6d) - INFO - Config saved: results/catboost_classifier_2b6c6d_config.json
2025-05-05 17:06:39,017 - lavka_recsys.Experiment(catboost_classifier_2b6c6d) - INFO - Setting up experiment environment...
2025-05-05 17:06:39,018 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 17:06:39,321 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 17:06:39,373 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 17:06:39,404 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 17:06:39,698 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 17:06:39,723 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 17:06:39,727 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 17:06:39,728 - lavka_recsys.Experiment(catboost_classifier_2b6c6d) - INFO - Setup complete.
2025-05-05 17:06:39,729 - lavka_recsys.Experiment(catboost_classifier_2b6c6d) - INFO - Starting experiment run...
2025-05-05 17:06:40,225 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 17:06:40,247 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 17:06:40,251 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 17:06:40,276 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 17:06:40,280 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 17:06:40,305 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_bf618251cfa2d097ad4312554b944c57.pkl
2025-05-05 17:06:40,722 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 17:06:40,748 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_9367ee9403ef9d1a8a4535588987d34c.pkl
2025-05-05 17:06:41,093 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 17:06:41,096 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'loss_function': 'Logloss', 'eval_metric': 'AUC', 'early_stopping_rounds': 50, 'custom_metric': ['AUC'], 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 17:06:41,256 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 17:08:42,245 - lavka_recsys.Experiment(catboost_classifier_2b6c6d) - INFO - Initialized experiment: catboost_classifier_2b6c6d
2025-05-05 17:08:42,254 - lavka_recsys.Experiment(catboost_classifier_2b6c6d) - INFO - Config saved: results/catboost_classifier_2b6c6d_config.json
2025-05-05 17:08:42,256 - lavka_recsys.Experiment(catboost_classifier_2b6c6d) - INFO - Setting up experiment environment...
2025-05-05 17:08:42,257 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 17:08:42,551 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 17:08:42,604 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 17:08:42,633 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 17:08:42,942 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 17:08:42,968 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 17:08:42,972 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 17:08:42,973 - lavka_recsys.Experiment(catboost_classifier_2b6c6d) - INFO - Setup complete.
2025-05-05 17:08:42,974 - lavka_recsys.Experiment(catboost_classifier_2b6c6d) - INFO - Starting experiment run...
2025-05-05 17:08:43,407 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 17:08:43,436 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 17:08:43,440 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 17:08:43,465 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 17:08:43,469 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 17:08:43,493 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_bf618251cfa2d097ad4312554b944c57.pkl
2025-05-05 17:08:43,911 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 17:08:43,946 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_9367ee9403ef9d1a8a4535588987d34c.pkl
2025-05-05 17:08:44,294 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 17:08:44,297 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'loss_function': 'Logloss', 'eval_metric': 'AUC', 'early_stopping_rounds': 50, 'custom_metric': ['AUC'], 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 17:08:44,462 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 17:08:45,160 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 17:08:45,690 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoostClassifier model with columns: ['source_type', 'count_purchase_u_p', 'user_total_purchases', 'user_unique_products', 'ctr_product', 'user_total_interactions', 'purchase_view_ratio', 'cart_to_purchase_rate', 'product_total_interactions', 'product_total_views', 'product_unique_users', 'user_total_views', 'days_since_interaction_u_p', 'product_total_purchases', 'count_purchase_u_s'] (cat_columns: ['source_type'])
2025-05-05 17:10:04,998 - lavka_recsys.Experiment(catboost_classifier_2b6c6d) - INFO - Training completed in 80.68s
2025-05-05 17:10:05,002 - lavka_recsys.Experiment(catboost_classifier_2b6c6d) - INFO - Evaluating on holdout.
2025-05-05 17:10:05,128 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_00773469f1f0e86c2a746a8f6c1c02a8.pkl
2025-05-05 17:10:05,597 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 17:10:05,746 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 17:10:18,980 - lavka_recsys.Experiment(catboost_classifier_2b6c6d) - INFO - Run results saved: results/catboost_classifier_2b6c6d_results.json
2025-05-05 17:10:18,983 - lavka_recsys.Experiment(catboost_classifier_2b6c6d) - INFO - Run finished and results saved.
2025-05-05 17:20:30,294 - lavka_recsys.Experiment(catboost_classifier_a5f03a) - INFO - Initialized experiment: catboost_classifier_a5f03a
2025-05-05 17:20:30,307 - lavka_recsys.Experiment(catboost_classifier_a5f03a) - INFO - Config saved: results/catboost_classifier_a5f03a_config.json
2025-05-05 17:20:30,308 - lavka_recsys.Experiment(catboost_classifier_a5f03a) - INFO - Setting up experiment environment...
2025-05-05 17:20:30,310 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 17:20:30,624 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 17:20:30,681 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 17:20:30,718 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 17:20:31,018 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 17:20:31,047 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 17:20:31,052 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 17:20:31,053 - lavka_recsys.Experiment(catboost_classifier_a5f03a) - INFO - Setup complete.
2025-05-05 17:20:31,054 - lavka_recsys.Experiment(catboost_classifier_a5f03a) - INFO - Starting experiment run...
2025-05-05 17:20:31,551 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 17:20:31,572 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 17:20:31,577 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 17:20:31,603 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 17:20:31,607 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 17:20:31,633 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_bf618251cfa2d097ad4312554b944c57.pkl
2025-05-05 17:20:32,071 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 17:20:32,097 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_9367ee9403ef9d1a8a4535588987d34c.pkl
2025-05-05 17:20:32,442 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 17:20:32,445 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'loss_function': 'Logloss', 'eval_metric': 'AUC', 'early_stopping_rounds': 50, 'custom_metric': ['AUC', 'NDCG:top=10'], 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 17:20:32,624 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 17:20:35,765 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 17:20:38,618 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 17:20:39,797 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 17:20:40,790 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoostClassifier model with columns: Index(['source_type', 'count_purchase_u_p', 'user_total_purchases',
       'user_unique_products', 'ctr_product', 'user_total_interactions',
       'purchase_view_ratio', 'cart_to_purchase_rate',
       'product_total_interactions', 'product_total_views',
       'product_unique_users', 'user_total_views',
       'days_since_interaction_u_p', 'product_total_purchases',
       'count_purchase_u_s'],
      dtype='object') (cat_columns: ['source_type'])
2025-05-05 17:21:55,192 - lavka_recsys.Experiment(catboost_classifier_a5f03a) - INFO - Training completed in 82.72s
2025-05-05 17:21:55,195 - lavka_recsys.Experiment(catboost_classifier_a5f03a) - INFO - Evaluating on holdout.
2025-05-05 17:21:55,259 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_00773469f1f0e86c2a746a8f6c1c02a8.pkl
2025-05-05 17:21:55,623 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 17:21:55,760 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 17:22:09,307 - lavka_recsys.Experiment(catboost_classifier_a5f03a) - INFO - Run results saved: results/catboost_classifier_a5f03a_results.json
2025-05-05 17:22:09,312 - lavka_recsys.Experiment(catboost_classifier_a5f03a) - INFO - Run finished and results saved.
2025-05-05 17:26:27,877 - lavka_recsys.Experiment(catboost_ranker_279422) - INFO - Initialized experiment: catboost_ranker_279422
2025-05-05 17:26:27,884 - lavka_recsys.Experiment(catboost_ranker_279422) - INFO - Config saved: results/catboost_ranker_279422_config.json
2025-05-05 17:26:27,889 - lavka_recsys.Experiment(catboost_ranker_279422) - INFO - Setting up experiment environment...
2025-05-05 17:26:27,891 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 17:26:28,256 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 17:26:28,315 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 17:26:28,331 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 17:26:28,532 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 17:26:28,559 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 17:26:28,562 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 17:26:28,563 - lavka_recsys.Experiment(catboost_ranker_279422) - INFO - Setup complete.
2025-05-05 17:26:28,564 - lavka_recsys.Experiment(catboost_ranker_279422) - INFO - Starting experiment run...
2025-05-05 17:26:28,969 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 17:26:28,993 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 17:26:28,997 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 17:26:29,023 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 17:26:29,027 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 17:26:29,070 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_bf618251cfa2d097ad4312554b944c57.pkl
2025-05-05 17:26:29,464 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 17:26:29,491 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_9367ee9403ef9d1a8a4535588987d34c.pkl
2025-05-05 17:26:29,846 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 17:26:29,849 - lavka_recsys.ModelFactory - INFO - Creating catboost_ranker model with params: {'iterations': 500, 'loss_function': 'YetiRankPairwise', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'custom_metric': ['NDCG:top=10', 'PrecisionAt:top=10', 'RecallAt:top=10'], 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 17:26:29,972 - lavka_recsys.CatBoostRankerModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 17:26:32,899 - lavka_recsys.CatBoostRankerModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 17:26:35,934 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 17:26:37,313 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 17:26:38,377 - lavka_recsys.CatBoostRankerModel - INFO - Training CatBoostRanker model with columns: ['source_type', 'count_purchase_u_p', 'user_total_purchases', 'user_unique_products', 'ctr_product', 'user_total_interactions', 'purchase_view_ratio', 'cart_to_purchase_rate', 'product_total_interactions', 'product_total_views', 'product_unique_users', 'user_total_views', 'days_since_interaction_u_p', 'product_total_purchases', 'count_purchase_u_s'] (cat_columns: ['source_type'])
2025-05-05 17:42:08,207 - lavka_recsys.Experiment(catboost_classifier_f431a3) - INFO - Initialized experiment: catboost_classifier_f431a3
2025-05-05 17:42:08,227 - lavka_recsys.Experiment(catboost_classifier_f431a3) - INFO - Config saved: results/catboost_classifier_f431a3_config.json
2025-05-05 17:42:08,972 - lavka_recsys.Experiment(catboost_classifier_f431a3) - INFO - Setting up experiment environment...
2025-05-05 17:42:08,974 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 17:42:09,267 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 17:42:09,328 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 17:42:09,351 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 17:42:09,582 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 17:42:09,609 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 17:42:09,613 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 17:42:09,614 - lavka_recsys.Experiment(catboost_classifier_f431a3) - INFO - Setup complete.
2025-05-05 17:42:09,615 - lavka_recsys.Experiment(catboost_classifier_f431a3) - INFO - Starting experiment run...
2025-05-05 17:42:09,993 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 17:42:10,016 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 17:42:10,020 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 17:42:10,044 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 17:42:10,048 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 17:42:10,073 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_eea2663e747c09fad5b02e705a394f1a.pkl
2025-05-05 17:42:11,409 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 17:42:11,435 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_0a8474df115bf334998e6bcb7079362b.pkl
2025-05-05 17:42:12,655 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 17:42:12,657 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'loss_function': 'Logloss', 'eval_metric': 'AUC', 'early_stopping_rounds': 50, 'custom_metric': ['AUC', 'NDCG:top=10'], 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 17:42:12,938 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 17:42:16,932 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 17:42:20,949 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 17:42:20,972 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 17:42:21,004 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 17:42:22,921 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 17:42:22,943 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 17:42:22,963 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 17:42:25,172 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoostClassifier model with columns: Index(['user_total_views', 'source_type', 'month', 'std_purchase_hour',
       'session_unique_products', 'user_total_purchases', 'purchases_day_u_p',
       'day_of_week_relevance', 'hour_of_day', 'user_unique_products',
       'count_purchase_u_p', 'puresvd_cf_score', 'cart_to_purchase_rate',
       'cf_score', 'session_duration_seconds', 'store_total_interactions',
       'user_product_purchase_cross', 'session_purchases',
       'product_unique_users', 'days_since_interaction_u_s',
       'store_total_purchases', 'is_weekend', 'views_day_u_p',
       'most_common_purchase_day', 'count_purchase_u_s', 'purchases_week_u_p',
       'interactions_month_u_p', 'avg_purchase_hour',
       'user_total_interactions', 'city_name', 'mean_interval_days',
       'interactions_week_u_p', 'purchase_view_ratio',
       'days_since_interaction_u_p', 'user_store_purchase_cross',
       'city_total_purchases', 'city_total_interactions', 'ctr_product',
       'hour_relevance', 'user_segment', 'session_unique_stores',
       'product_total_views', 'day_of_week', 'purchases_month_u_p',
       'interaction_trend', 'npmi_cf_score', 'product_total_purchases',
       'user_product_store_cross', 'svd_cf_score', 'store_total_views',
       'interactions_day_u_p', 'views_week_u_p', 'city_unique_stores',
       'store_unique_products', 'purchase_trend', 'session_length',
       'views_month_u_p', 'city_total_views', 'product_total_interactions'],
      dtype='object') (cat_columns: ['user_segment', 'city_name', 'source_type'])
2025-05-05 17:43:46,545 - lavka_recsys.Experiment(catboost_classifier_f431a3) - INFO - Training completed in 93.89s
2025-05-05 17:43:46,548 - lavka_recsys.Experiment(catboost_classifier_f431a3) - INFO - Evaluating on holdout.
2025-05-05 17:43:46,610 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_1879e9aab22f20d41fd15e001434badd.pkl
2025-05-05 17:43:47,660 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 17:43:47,866 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 17:43:47,896 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 17:43:47,920 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 17:44:02,498 - lavka_recsys.Experiment(catboost_classifier_f431a3) - INFO - Run results saved: results/catboost_classifier_f431a3_results.json
2025-05-05 17:44:02,503 - lavka_recsys.Experiment(catboost_classifier_f431a3) - INFO - Run finished and results saved.
2025-05-05 17:45:27,958 - lavka_recsys.Experiment(catboost_ranker_e0522c) - INFO - Initialized experiment: catboost_ranker_e0522c
2025-05-05 17:45:27,967 - lavka_recsys.Experiment(catboost_ranker_e0522c) - INFO - Config saved: results/catboost_ranker_e0522c_config.json
2025-05-05 17:45:27,968 - lavka_recsys.Experiment(catboost_ranker_e0522c) - INFO - Setting up experiment environment...
2025-05-05 17:45:27,970 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 17:45:28,274 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 17:45:28,335 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 17:45:28,364 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 17:45:28,572 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 17:45:28,599 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 17:45:28,604 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 17:45:28,605 - lavka_recsys.Experiment(catboost_ranker_e0522c) - INFO - Setup complete.
2025-05-05 17:45:28,607 - lavka_recsys.Experiment(catboost_ranker_e0522c) - INFO - Starting experiment run...
2025-05-05 17:45:29,077 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 17:45:29,099 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 17:45:29,103 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 17:45:29,130 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 17:45:29,134 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 17:45:29,160 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_eea2663e747c09fad5b02e705a394f1a.pkl
2025-05-05 17:45:30,415 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 17:45:30,446 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_0a8474df115bf334998e6bcb7079362b.pkl
2025-05-05 17:45:31,553 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 17:45:31,555 - lavka_recsys.ModelFactory - INFO - Creating catboost_ranker model with params: {'iterations': 500, 'loss_function': 'YetiRankPairwise', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'custom_metric': ['NDCG:top=10', 'PrecisionAt:top=10', 'RecallAt:top=10'], 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 17:45:31,848 - lavka_recsys.CatBoostRankerModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 17:45:35,881 - lavka_recsys.CatBoostRankerModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 17:45:39,606 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 17:45:39,629 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 17:45:39,649 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 17:45:41,434 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 17:45:41,456 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 17:45:41,477 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 17:45:43,196 - lavka_recsys.CatBoostRankerModel - INFO - Training CatBoostRanker model with columns: ['user_total_views', 'source_type', 'month', 'std_purchase_hour', 'session_unique_products', 'user_total_purchases', 'purchases_day_u_p', 'day_of_week_relevance', 'hour_of_day', 'user_unique_products', 'count_purchase_u_p', 'puresvd_cf_score', 'cart_to_purchase_rate', 'cf_score', 'session_duration_seconds', 'store_total_interactions', 'user_product_purchase_cross', 'session_purchases', 'product_unique_users', 'days_since_interaction_u_s', 'store_total_purchases', 'is_weekend', 'views_day_u_p', 'most_common_purchase_day', 'count_purchase_u_s', 'purchases_week_u_p', 'interactions_month_u_p', 'avg_purchase_hour', 'user_total_interactions', 'city_name', 'mean_interval_days', 'interactions_week_u_p', 'purchase_view_ratio', 'days_since_interaction_u_p', 'user_store_purchase_cross', 'city_total_purchases', 'city_total_interactions', 'ctr_product', 'hour_relevance', 'user_segment', 'session_unique_stores', 'product_total_views', 'day_of_week', 'purchases_month_u_p', 'interaction_trend', 'npmi_cf_score', 'product_total_purchases', 'user_product_store_cross', 'svd_cf_score', 'store_total_views', 'interactions_day_u_p', 'views_week_u_p', 'city_unique_stores', 'store_unique_products', 'purchase_trend', 'session_length', 'views_month_u_p', 'city_total_views', 'product_total_interactions'] (cat_columns: ['user_segment', 'city_name', 'source_type'])
2025-05-05 18:24:01,272 - lavka_recsys.Experiment(catboost_ranker_e0522c) - INFO - Training completed in 2309.72s
2025-05-05 18:24:01,277 - lavka_recsys.Experiment(catboost_ranker_e0522c) - INFO - Evaluating on holdout.
2025-05-05 18:24:01,348 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_1879e9aab22f20d41fd15e001434badd.pkl
2025-05-05 18:24:02,507 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 18:26:14,237 - lavka_recsys.Experiment(catboost_classifier_f431a3) - INFO - Computing predictions...
2025-05-05 18:26:14,246 - lavka_recsys.DataLoader - INFO - Holdout data merged back into training data.
2025-05-05 18:26:14,293 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 18:26:14,322 - lavka_recsys.DataLoader - INFO -   history: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 18:26:14,328 - lavka_recsys.DataLoader - INFO -   target: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 18:26:14,377 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_1879e9aab22f20d41fd15e001434badd.pkl
2025-05-05 18:26:15,446 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 18:26:15,448 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'loss_function': 'Logloss', 'eval_metric': 'AUC', 'early_stopping_rounds': 50, 'custom_metric': ['AUC', 'NDCG:top=10'], 'task_type': 'CPU', 'thread_count': -1}
2025-05-05 18:26:15,746 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 18:26:19,090 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 18:26:19,131 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 18:26:19,154 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 18:26:20,653 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoostClassifier model with columns: Index(['user_total_views', 'source_type', 'month', 'std_purchase_hour',
       'session_unique_products', 'user_total_purchases', 'purchases_day_u_p',
       'day_of_week_relevance', 'hour_of_day', 'user_unique_products',
       'count_purchase_u_p', 'puresvd_cf_score', 'cart_to_purchase_rate',
       'cf_score', 'session_duration_seconds', 'store_total_interactions',
       'user_product_purchase_cross', 'session_purchases',
       'product_unique_users', 'days_since_interaction_u_s',
       'store_total_purchases', 'is_weekend', 'views_day_u_p',
       'most_common_purchase_day', 'count_purchase_u_s', 'purchases_week_u_p',
       'interactions_month_u_p', 'avg_purchase_hour',
       'user_total_interactions', 'city_name', 'mean_interval_days',
       'interactions_week_u_p', 'purchase_view_ratio',
       'days_since_interaction_u_p', 'user_store_purchase_cross',
       'city_total_purchases', 'city_total_interactions', 'ctr_product',
       'hour_relevance', 'user_segment', 'session_unique_stores',
       'product_total_views', 'day_of_week', 'purchases_month_u_p',
       'interaction_trend', 'npmi_cf_score', 'product_total_purchases',
       'user_product_store_cross', 'svd_cf_score', 'store_total_views',
       'interactions_day_u_p', 'views_week_u_p', 'city_unique_stores',
       'store_unique_products', 'purchase_trend', 'session_length',
       'views_month_u_p', 'city_total_views', 'product_total_interactions'],
      dtype='object') (cat_columns: ['user_segment', 'city_name', 'source_type'])
2025-05-05 18:27:11,104 - lavka_recsys.Experiment(catboost_classifier_3f6423) - INFO - Initialized experiment: catboost_classifier_3f6423
2025-05-05 18:27:11,112 - lavka_recsys.Experiment(catboost_classifier_3f6423) - INFO - Config saved: results/catboost_classifier_3f6423_config.json
2025-05-05 18:27:11,113 - lavka_recsys.Experiment(catboost_classifier_3f6423) - INFO - Setting up experiment environment...
2025-05-05 18:27:11,115 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 18:27:11,442 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 18:27:11,497 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 18:27:11,538 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 18:27:11,869 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 18:27:11,899 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 18:27:11,903 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 18:27:11,904 - lavka_recsys.Experiment(catboost_classifier_3f6423) - INFO - Setup complete.
2025-05-05 18:27:11,905 - lavka_recsys.Experiment(catboost_classifier_3f6423) - INFO - Starting experiment run...
2025-05-05 18:27:12,430 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 18:27:12,451 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 18:27:12,454 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 18:27:12,479 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 18:27:12,484 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 18:27:12,521 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_eea2663e747c09fad5b02e705a394f1a.pkl
2025-05-05 18:27:13,982 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 18:27:14,014 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_0a8474df115bf334998e6bcb7079362b.pkl
2025-05-05 18:27:15,156 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 18:27:15,159 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'loss_function': 'Logloss', 'eval_metric': 'AUC', 'early_stopping_rounds': 50, 'custom_metric': ['AUC', 'NDCG:top=10'], 'task_type': 'GPU', 'devices': '3,4,5', 'thread_count': -1}
2025-05-05 18:27:42,925 - lavka_recsys.Experiment(catboost_classifier_3f6423) - INFO - Initialized experiment: catboost_classifier_3f6423
2025-05-05 18:27:42,933 - lavka_recsys.Experiment(catboost_classifier_3f6423) - INFO - Config saved: results/catboost_classifier_3f6423_config.json
2025-05-05 18:27:42,935 - lavka_recsys.Experiment(catboost_classifier_3f6423) - INFO - Setting up experiment environment...
2025-05-05 18:27:42,936 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 18:27:43,269 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 18:27:43,345 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 18:27:43,377 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 18:27:43,654 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 18:27:43,682 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 18:27:43,686 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 18:27:43,687 - lavka_recsys.Experiment(catboost_classifier_3f6423) - INFO - Setup complete.
2025-05-05 18:27:43,687 - lavka_recsys.Experiment(catboost_classifier_3f6423) - INFO - Starting experiment run...
2025-05-05 18:27:44,231 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 18:27:44,253 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 18:27:44,257 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 18:27:44,283 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 18:27:44,287 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 18:27:44,319 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_eea2663e747c09fad5b02e705a394f1a.pkl
2025-05-05 18:27:45,606 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 18:27:45,638 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_0a8474df115bf334998e6bcb7079362b.pkl
2025-05-05 18:27:46,778 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 18:27:46,781 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'loss_function': 'Logloss', 'eval_metric': 'AUC', 'early_stopping_rounds': 50, 'custom_metric': ['AUC', 'NDCG:top=10'], 'task_type': 'GPU', 'devices': '3,4,5', 'thread_count': -1}
2025-05-05 18:27:47,113 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 18:27:50,617 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 18:27:53,875 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 18:27:53,901 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 18:27:53,925 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 18:27:55,671 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 18:27:55,695 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 18:27:55,717 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 18:27:57,188 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoostClassifier model with columns: Index(['user_total_views', 'source_type', 'month', 'std_purchase_hour',
       'session_unique_products', 'user_total_purchases', 'purchases_day_u_p',
       'day_of_week_relevance', 'hour_of_day', 'user_unique_products',
       'count_purchase_u_p', 'puresvd_cf_score', 'cart_to_purchase_rate',
       'cf_score', 'session_duration_seconds', 'store_total_interactions',
       'user_product_purchase_cross', 'session_purchases',
       'product_unique_users', 'days_since_interaction_u_s',
       'store_total_purchases', 'is_weekend', 'views_day_u_p',
       'most_common_purchase_day', 'count_purchase_u_s', 'purchases_week_u_p',
       'interactions_month_u_p', 'avg_purchase_hour',
       'user_total_interactions', 'city_name', 'mean_interval_days',
       'interactions_week_u_p', 'purchase_view_ratio',
       'days_since_interaction_u_p', 'user_store_purchase_cross',
       'city_total_purchases', 'city_total_interactions', 'ctr_product',
       'hour_relevance', 'user_segment', 'session_unique_stores',
       'product_total_views', 'day_of_week', 'purchases_month_u_p',
       'interaction_trend', 'npmi_cf_score', 'product_total_purchases',
       'user_product_store_cross', 'svd_cf_score', 'store_total_views',
       'interactions_day_u_p', 'views_week_u_p', 'city_unique_stores',
       'store_unique_products', 'purchase_trend', 'session_length',
       'views_month_u_p', 'city_total_views', 'product_total_interactions'],
      dtype='object') (cat_columns: ['user_segment', 'city_name', 'source_type'])
2025-05-05 18:29:07,851 - lavka_recsys.Experiment(catboost_classifier_3f6423) - INFO - Training completed in 81.05s
2025-05-05 18:29:07,860 - lavka_recsys.Experiment(catboost_classifier_3f6423) - INFO - Evaluating on holdout.
2025-05-05 18:29:07,954 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_1879e9aab22f20d41fd15e001434badd.pkl
2025-05-05 18:29:09,381 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 18:29:09,644 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 18:29:09,691 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 18:29:09,714 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 18:29:24,728 - lavka_recsys.Experiment(catboost_classifier_3f6423) - INFO - Run results saved: results/catboost_classifier_3f6423_results.json
2025-05-05 18:29:24,732 - lavka_recsys.Experiment(catboost_classifier_3f6423) - INFO - Run finished and results saved.
2025-05-05 18:30:06,493 - lavka_recsys.Experiment(catboost_classifier_3f6423) - INFO - Computing predictions...
2025-05-05 18:30:06,500 - lavka_recsys.DataLoader - INFO - Holdout data merged back into training data.
2025-05-05 18:30:06,555 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 18:30:06,584 - lavka_recsys.DataLoader - INFO -   history: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 18:30:06,588 - lavka_recsys.DataLoader - INFO -   target: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 18:30:06,616 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_1879e9aab22f20d41fd15e001434badd.pkl
2025-05-05 18:30:07,838 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 18:30:07,842 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'loss_function': 'Logloss', 'eval_metric': 'AUC', 'early_stopping_rounds': 50, 'custom_metric': ['AUC', 'NDCG:top=10'], 'task_type': 'GPU', 'devices': '3,4,5', 'thread_count': -1}
2025-05-05 18:30:08,102 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 18:30:11,586 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 18:30:11,626 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 18:30:11,662 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 18:30:13,396 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoostClassifier model with columns: Index(['user_total_views', 'source_type', 'month', 'std_purchase_hour',
       'session_unique_products', 'user_total_purchases', 'purchases_day_u_p',
       'day_of_week_relevance', 'hour_of_day', 'user_unique_products',
       'count_purchase_u_p', 'puresvd_cf_score', 'cart_to_purchase_rate',
       'cf_score', 'session_duration_seconds', 'store_total_interactions',
       'user_product_purchase_cross', 'session_purchases',
       'product_unique_users', 'days_since_interaction_u_s',
       'store_total_purchases', 'is_weekend', 'views_day_u_p',
       'most_common_purchase_day', 'count_purchase_u_s', 'purchases_week_u_p',
       'interactions_month_u_p', 'avg_purchase_hour',
       'user_total_interactions', 'city_name', 'mean_interval_days',
       'interactions_week_u_p', 'purchase_view_ratio',
       'days_since_interaction_u_p', 'user_store_purchase_cross',
       'city_total_purchases', 'city_total_interactions', 'ctr_product',
       'hour_relevance', 'user_segment', 'session_unique_stores',
       'product_total_views', 'day_of_week', 'purchases_month_u_p',
       'interaction_trend', 'npmi_cf_score', 'product_total_purchases',
       'user_product_store_cross', 'svd_cf_score', 'store_total_views',
       'interactions_day_u_p', 'views_week_u_p', 'city_unique_stores',
       'store_unique_products', 'purchase_trend', 'session_length',
       'views_month_u_p', 'city_total_views', 'product_total_interactions'],
      dtype='object') (cat_columns: ['user_segment', 'city_name', 'source_type'])
2025-05-05 18:31:30,942 - lavka_recsys.Experiment(catboost_classifier_3f6423) - INFO - Training completed in 83.10s
2025-05-05 18:31:30,949 - lavka_recsys.DataLoader - INFO - Holdout data merged back into training data.
2025-05-05 18:31:31,020 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 18:31:31,021 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf
2025-05-05 18:31:31,022 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 18:31:31,022 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 18:31:31,313 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 18:31:31,396 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 18:31:32,040 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 18:31:32,474 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 18:31:32,993 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 18:31:34,251 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 18:31:34,688 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 18:31:35,172 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 18:31:35,516 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 18:31:36,290 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_temporal_patterns
2025-05-05 18:31:36,436 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_store
2025-05-05 18:31:36,902 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_features
2025-05-05 18:31:36,912 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_window_user_product
2025-05-05 18:31:37,287 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: session_features
2025-05-05 18:31:39,945 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: frequency_features
2025-05-05 18:31:46,353 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_popularity_trend
2025-05-05 18:31:47,139 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 18:31:47,513 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 18:31:47,936 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 18:31:48,305 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 18:31:48,855 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cross_features
2025-05-05 18:31:48,858 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_segments
2025-05-05 18:31:49,233 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: memory-based-cf
2025-05-05 18:31:50,438 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: npmi-cf
2025-05-05 18:32:24,631 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: puresvd-cf
2025-05-05 18:32:53,366 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: svd-cf
2025-05-05 18:32:54,839 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 18:32:54,843 - lavka_recsys.FeatureFactory - INFO - All column names: {'user_total_views', 'product_unique_users', 'city_name', 'ctr_product', 'city_total_purchases', 'session_unique_products', 'user_total_interactions', 'city_unique_stores', 'user_product_purchase_cross', 'month', 'interactions_day_u_p', 'mean_interval_days', 'most_common_purchase_day', 'interactions_month_u_p', 'count_purchase_u_p', 'cart_to_purchase_rate', 'city_total_views', 'npmi_cf_score', 'store_total_interactions', 'is_weekend', 'views_week_u_p', 'session_purchases', 'puresvd_cf_score', 'purchase_view_ratio', 'day_of_week', 'session_duration_seconds', 'interaction_trend', 'store_total_purchases', 'avg_purchase_hour', 'session_length', 'city_total_interactions', 'user_total_purchases', 'source_type', 'user_unique_products', 'days_since_interaction_u_s', 'user_segment', 'hour_of_day', 'std_purchase_hour', 'interactions_week_u_p', 'purchases_day_u_p', 'purchases_month_u_p', 'purchases_week_u_p', 'svd_cf_score', 'session_unique_stores', 'cf_score', 'product_total_interactions', 'hour_relevance', 'views_month_u_p', 'user_store_purchase_cross', 'user_product_store_cross', 'count_purchase_u_s', 'product_total_purchases', 'product_total_views', 'purchase_trend', 'store_total_views', 'day_of_week_relevance', 'days_since_interaction_u_p', 'store_unique_products', 'views_day_u_p'}
2025-05-05 18:32:54,845 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['source_type', 'city_name', 'user_segment']
2025-05-05 18:32:54,941 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 18:32:54,956 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 18:32:54,965 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 18:32:55,464 - lavka_recsys.Experiment(catboost_classifier_3f6423) - INFO - Submission saved: results/submissions/catboost_classifier_3f6423_submission.csv
2025-05-05 18:32:55,496 - lavka_recsys.Experiment(catboost_classifier_3f6423) - INFO - Submission model saved: results/submissions/catboost_classifier_3f6423_model.pkl
2025-05-05 18:36:00,780 - lavka_recsys.Experiment(catboost_ranker_e065d0) - INFO - Initialized experiment: catboost_ranker_e065d0
2025-05-05 18:36:00,803 - lavka_recsys.Experiment(catboost_ranker_e065d0) - INFO - Config saved: results/catboost_ranker_e065d0_config.json
2025-05-05 18:36:00,806 - lavka_recsys.Experiment(catboost_ranker_e065d0) - INFO - Setting up experiment environment...
2025-05-05 18:36:00,808 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 18:36:01,102 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 18:36:01,148 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 18:36:01,176 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 18:36:01,395 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 18:36:01,423 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 18:36:01,426 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 18:36:01,427 - lavka_recsys.Experiment(catboost_ranker_e065d0) - INFO - Setup complete.
2025-05-05 18:36:01,428 - lavka_recsys.Experiment(catboost_ranker_e065d0) - INFO - Starting experiment run...
2025-05-05 18:36:01,793 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 18:36:01,817 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 18:36:01,821 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 18:36:01,850 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 18:36:01,855 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 18:36:01,883 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_eea2663e747c09fad5b02e705a394f1a.pkl
2025-05-05 18:36:03,087 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 18:36:03,116 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_0a8474df115bf334998e6bcb7079362b.pkl
2025-05-05 18:36:04,210 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 18:36:04,213 - lavka_recsys.ModelFactory - INFO - Creating catboost_ranker model with params: {'iterations': 300, 'loss_function': 'YetiRankPairwise', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'custom_metric': ['NDCG:top=10', 'PrecisionAt:top=10', 'RecallAt:top=10'], 'task_type': 'GPU', 'devices': '3,4,5', 'thread_count': -1}
2025-05-05 18:36:04,502 - lavka_recsys.CatBoostRankerModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 18:36:07,862 - lavka_recsys.CatBoostRankerModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 18:36:11,039 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 18:36:11,065 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 18:36:11,086 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 18:36:12,622 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 18:36:12,656 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 18:36:12,678 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 18:36:14,121 - lavka_recsys.CatBoostRankerModel - INFO - Training CatBoostRanker model with columns: ['user_total_views', 'source_type', 'month', 'std_purchase_hour', 'session_unique_products', 'user_total_purchases', 'purchases_day_u_p', 'day_of_week_relevance', 'hour_of_day', 'user_unique_products', 'count_purchase_u_p', 'puresvd_cf_score', 'cart_to_purchase_rate', 'cf_score', 'session_duration_seconds', 'store_total_interactions', 'user_product_purchase_cross', 'session_purchases', 'product_unique_users', 'days_since_interaction_u_s', 'store_total_purchases', 'is_weekend', 'views_day_u_p', 'most_common_purchase_day', 'count_purchase_u_s', 'purchases_week_u_p', 'interactions_month_u_p', 'avg_purchase_hour', 'user_total_interactions', 'city_name', 'mean_interval_days', 'interactions_week_u_p', 'purchase_view_ratio', 'days_since_interaction_u_p', 'user_store_purchase_cross', 'city_total_purchases', 'city_total_interactions', 'ctr_product', 'hour_relevance', 'user_segment', 'session_unique_stores', 'product_total_views', 'day_of_week', 'purchases_month_u_p', 'interaction_trend', 'npmi_cf_score', 'product_total_purchases', 'user_product_store_cross', 'svd_cf_score', 'store_total_views', 'interactions_day_u_p', 'views_week_u_p', 'city_unique_stores', 'store_unique_products', 'purchase_trend', 'session_length', 'views_month_u_p', 'city_total_views', 'product_total_interactions'] (cat_columns: ['user_segment', 'city_name', 'source_type'])
2025-05-05 18:36:59,839 - lavka_recsys.Experiment(catboost_ranker_e065d0) - INFO - Training completed in 55.62s
2025-05-05 18:36:59,844 - lavka_recsys.Experiment(catboost_ranker_e065d0) - INFO - Evaluating on holdout.
2025-05-05 18:36:59,905 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_1879e9aab22f20d41fd15e001434badd.pkl
2025-05-05 18:37:01,079 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 18:37:01,326 - lavka_recsys.CatBoostRankerModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 18:37:03,947 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 18:37:03,973 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 18:37:04,005 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 18:37:18,331 - lavka_recsys.Experiment(catboost_ranker_e065d0) - INFO - Run results saved: results/catboost_ranker_e065d0_results.json
2025-05-05 18:37:18,333 - lavka_recsys.Experiment(catboost_ranker_e065d0) - INFO - Run finished and results saved.
2025-05-05 18:38:03,451 - lavka_recsys.Experiment(catboost_ranker_e065d0) - INFO - Computing predictions...
2025-05-05 18:38:03,455 - lavka_recsys.DataLoader - INFO - Holdout data merged back into training data.
2025-05-05 18:38:03,485 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 18:38:03,514 - lavka_recsys.DataLoader - INFO -   history: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 18:38:03,519 - lavka_recsys.DataLoader - INFO -   target: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 18:38:03,549 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_1879e9aab22f20d41fd15e001434badd.pkl
2025-05-05 18:38:04,623 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 18:38:04,626 - lavka_recsys.ModelFactory - INFO - Creating catboost_ranker model with params: {'iterations': 300, 'loss_function': 'YetiRankPairwise', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'custom_metric': ['NDCG:top=10', 'PrecisionAt:top=10', 'RecallAt:top=10'], 'task_type': 'GPU', 'devices': '3,4,5', 'thread_count': -1}
2025-05-05 18:52:02,326 - lavka_recsys.Experiment(catboost_ranker_c49b38) - INFO - Initialized experiment: catboost_ranker_c49b38
2025-05-05 18:52:02,351 - lavka_recsys.Experiment(catboost_ranker_c49b38) - INFO - Config saved: results/catboost_ranker_c49b38_config.json
2025-05-05 18:52:02,354 - lavka_recsys.Experiment(catboost_ranker_c49b38) - INFO - Setting up experiment environment...
2025-05-05 18:52:02,358 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 18:52:02,728 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 18:52:02,794 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 18:52:02,821 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 18:52:03,167 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 18:52:03,197 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 18:52:03,201 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 18:52:03,202 - lavka_recsys.Experiment(catboost_ranker_c49b38) - INFO - Setup complete.
2025-05-05 18:52:03,203 - lavka_recsys.Experiment(catboost_ranker_c49b38) - INFO - Starting experiment run...
2025-05-05 18:52:03,682 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 18:52:03,703 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 18:52:03,707 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 18:52:03,736 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 18:52:03,742 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 18:52:03,771 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_eea2663e747c09fad5b02e705a394f1a.pkl
2025-05-05 18:52:05,054 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 18:52:05,083 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_0a8474df115bf334998e6bcb7079362b.pkl
2025-05-05 18:52:06,273 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 18:52:06,277 - lavka_recsys.ModelFactory - INFO - Creating catboost_ranker model with params: {'iterations': 50, 'loss_function': 'YetiRankPairwise', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'custom_metric': ['NDCG:top=10', 'PrecisionAt:top=10', 'RecallAt:top=10'], 'task_type': 'GPU', 'devices': '3,4,5', 'thread_count': -1}
2025-05-05 18:52:06,660 - lavka_recsys.CatBoostRankerModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 18:52:10,291 - lavka_recsys.CatBoostRankerModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 18:52:14,264 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 18:52:14,286 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 18:52:14,309 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 18:52:15,905 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 18:52:15,928 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 18:52:15,950 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 18:52:17,419 - lavka_recsys.CatBoostRankerModel - INFO - Training CatBoostRanker model with columns: ['user_total_views', 'source_type', 'month', 'std_purchase_hour', 'session_unique_products', 'user_total_purchases', 'purchases_day_u_p', 'day_of_week_relevance', 'hour_of_day', 'user_unique_products', 'count_purchase_u_p', 'puresvd_cf_score', 'cart_to_purchase_rate', 'cf_score', 'session_duration_seconds', 'store_total_interactions', 'user_product_purchase_cross', 'session_purchases', 'product_unique_users', 'days_since_interaction_u_s', 'store_total_purchases', 'is_weekend', 'views_day_u_p', 'most_common_purchase_day', 'count_purchase_u_s', 'purchases_week_u_p', 'interactions_month_u_p', 'avg_purchase_hour', 'user_total_interactions', 'city_name', 'mean_interval_days', 'interactions_week_u_p', 'purchase_view_ratio', 'days_since_interaction_u_p', 'user_store_purchase_cross', 'city_total_purchases', 'city_total_interactions', 'ctr_product', 'hour_relevance', 'user_segment', 'session_unique_stores', 'product_total_views', 'day_of_week', 'purchases_month_u_p', 'interaction_trend', 'npmi_cf_score', 'product_total_purchases', 'user_product_store_cross', 'svd_cf_score', 'store_total_views', 'interactions_day_u_p', 'views_week_u_p', 'city_unique_stores', 'store_unique_products', 'purchase_trend', 'session_length', 'views_month_u_p', 'city_total_views', 'product_total_interactions'] (cat_columns: ['user_segment', 'city_name', 'source_type'])
2025-05-05 18:52:29,141 - lavka_recsys.Experiment(catboost_ranker_c49b38) - INFO - Training completed in 22.84s
2025-05-05 18:52:29,147 - lavka_recsys.Experiment(catboost_ranker_c49b38) - INFO - Evaluating on holdout.
2025-05-05 18:52:29,260 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_1879e9aab22f20d41fd15e001434badd.pkl
2025-05-05 18:52:30,398 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 18:52:30,603 - lavka_recsys.CatBoostRankerModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 18:52:33,418 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 18:52:33,441 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 18:52:33,467 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 18:52:48,418 - lavka_recsys.Experiment(catboost_ranker_c49b38) - INFO - Run results saved: results/catboost_ranker_c49b38_results.json
2025-05-05 18:52:48,421 - lavka_recsys.Experiment(catboost_ranker_c49b38) - INFO - Run finished and results saved.
2025-05-05 18:52:57,203 - lavka_recsys.Experiment(catboost_ranker_c49b38) - INFO - Computing predictions...
2025-05-05 18:52:57,209 - lavka_recsys.DataLoader - INFO - Holdout data merged back into training data.
2025-05-05 18:52:57,269 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 18:52:57,299 - lavka_recsys.DataLoader - INFO -   history: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 18:52:57,303 - lavka_recsys.DataLoader - INFO -   target: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 18:52:57,329 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_1879e9aab22f20d41fd15e001434badd.pkl
2025-05-05 18:52:58,611 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 18:52:58,618 - lavka_recsys.ModelFactory - INFO - Creating catboost_ranker model with params: {'iterations': 50, 'loss_function': 'YetiRankPairwise', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'custom_metric': ['NDCG:top=10', 'PrecisionAt:top=10', 'RecallAt:top=10'], 'task_type': 'GPU', 'devices': '3,4,5', 'thread_count': -1}
2025-05-05 18:52:58,904 - lavka_recsys.CatBoostRankerModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 18:53:02,082 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 18:53:02,111 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 18:53:02,132 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 18:53:03,519 - lavka_recsys.CatBoostRankerModel - INFO - Training CatBoostRanker model with columns: ['user_total_views', 'source_type', 'month', 'std_purchase_hour', 'session_unique_products', 'user_total_purchases', 'purchases_day_u_p', 'day_of_week_relevance', 'hour_of_day', 'user_unique_products', 'count_purchase_u_p', 'puresvd_cf_score', 'cart_to_purchase_rate', 'cf_score', 'session_duration_seconds', 'store_total_interactions', 'user_product_purchase_cross', 'session_purchases', 'product_unique_users', 'days_since_interaction_u_s', 'store_total_purchases', 'is_weekend', 'views_day_u_p', 'most_common_purchase_day', 'count_purchase_u_s', 'purchases_week_u_p', 'interactions_month_u_p', 'avg_purchase_hour', 'user_total_interactions', 'city_name', 'mean_interval_days', 'interactions_week_u_p', 'purchase_view_ratio', 'days_since_interaction_u_p', 'user_store_purchase_cross', 'city_total_purchases', 'city_total_interactions', 'ctr_product', 'hour_relevance', 'user_segment', 'session_unique_stores', 'product_total_views', 'day_of_week', 'purchases_month_u_p', 'interaction_trend', 'npmi_cf_score', 'product_total_purchases', 'user_product_store_cross', 'svd_cf_score', 'store_total_views', 'interactions_day_u_p', 'views_week_u_p', 'city_unique_stores', 'store_unique_products', 'purchase_trend', 'session_length', 'views_month_u_p', 'city_total_views', 'product_total_interactions'] (cat_columns: ['user_segment', 'city_name', 'source_type'])
2025-05-05 18:53:17,217 - lavka_recsys.Experiment(catboost_ranker_c49b38) - INFO - Training completed in 18.60s
2025-05-05 18:53:17,228 - lavka_recsys.DataLoader - INFO - Holdout data merged back into training data.
2025-05-05 18:53:17,307 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 18:53:17,309 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf
2025-05-05 18:53:17,311 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 18:53:17,311 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 18:53:17,609 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 18:53:17,694 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 18:53:18,337 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 18:53:18,748 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 18:53:19,212 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 18:53:20,474 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 18:53:20,888 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 18:53:21,387 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 18:53:21,778 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 18:53:22,488 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_temporal_patterns
2025-05-05 18:53:22,618 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_store
2025-05-05 18:53:23,057 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_features
2025-05-05 18:53:23,067 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_window_user_product
2025-05-05 18:53:23,428 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: session_features
2025-05-05 18:53:25,593 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: frequency_features
2025-05-05 18:53:30,666 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_popularity_trend
2025-05-05 18:53:31,270 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 18:53:31,655 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 18:53:32,118 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 18:53:32,502 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 18:53:33,151 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cross_features
2025-05-05 18:53:33,154 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_segments
2025-05-05 18:53:33,533 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: memory-based-cf
2025-05-05 18:53:34,695 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: npmi-cf
2025-05-05 18:54:10,842 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: puresvd-cf
2025-05-05 18:54:42,375 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: svd-cf
2025-05-05 18:54:44,113 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 18:54:44,117 - lavka_recsys.FeatureFactory - INFO - All column names: {'store_total_views', 'std_purchase_hour', 'store_unique_products', 'avg_purchase_hour', 'session_length', 'month', 'user_store_purchase_cross', 'purchases_month_u_p', 'is_weekend', 'purchases_week_u_p', 'hour_relevance', 'store_total_interactions', 'session_unique_products', 'user_product_purchase_cross', 'user_product_store_cross', 'city_total_interactions', 'product_unique_users', 'session_purchases', 'purchase_view_ratio', 'product_total_views', 'store_total_purchases', 'user_segment', 'npmi_cf_score', 'puresvd_cf_score', 'days_since_interaction_u_p', 'ctr_product', 'user_total_interactions', 'day_of_week', 'session_unique_stores', 'product_total_purchases', 'product_total_interactions', 'hour_of_day', 'views_day_u_p', 'interaction_trend', 'user_total_purchases', 'user_unique_products', 'user_total_views', 'count_purchase_u_s', 'city_total_views', 'city_unique_stores', 'count_purchase_u_p', 'day_of_week_relevance', 'purchases_day_u_p', 'mean_interval_days', 'cart_to_purchase_rate', 'city_total_purchases', 'most_common_purchase_day', 'city_name', 'interactions_day_u_p', 'views_week_u_p', 'views_month_u_p', 'days_since_interaction_u_s', 'session_duration_seconds', 'purchase_trend', 'cf_score', 'interactions_month_u_p', 'svd_cf_score', 'source_type', 'interactions_week_u_p'}
2025-05-05 18:54:44,118 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['city_name', 'user_segment', 'source_type']
2025-05-05 18:54:44,195 - lavka_recsys.CatBoostRankerModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 18:54:44,492 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 18:54:44,497 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 18:54:44,513 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 18:54:44,947 - lavka_recsys.Experiment(catboost_ranker_c49b38) - INFO - Submission saved: results/submissions/catboost_ranker_c49b38_submission.csv
2025-05-05 18:54:44,992 - lavka_recsys.Experiment(catboost_ranker_c49b38) - INFO - Submission model saved: results/submissions/catboost_ranker_c49b38_model.pkl
2025-05-05 18:54:53,413 - lavka_recsys.Experiment(catboost_ranker_611ad3) - INFO - Initialized experiment: catboost_ranker_611ad3
2025-05-05 18:54:53,423 - lavka_recsys.Experiment(catboost_ranker_611ad3) - INFO - Config saved: results/catboost_ranker_611ad3_config.json
2025-05-05 18:54:53,436 - lavka_recsys.Experiment(catboost_ranker_611ad3) - INFO - Setting up experiment environment...
2025-05-05 18:54:53,437 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 18:54:53,798 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 18:54:53,861 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 18:54:53,880 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 18:54:54,012 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 18:54:54,039 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 18:54:54,044 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 18:54:54,045 - lavka_recsys.Experiment(catboost_ranker_611ad3) - INFO - Setup complete.
2025-05-05 18:54:54,047 - lavka_recsys.Experiment(catboost_ranker_611ad3) - INFO - Starting experiment run...
2025-05-05 18:54:54,399 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 18:54:54,421 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 18:54:54,425 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 18:54:54,451 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 18:54:54,456 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 18:54:54,487 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_eea2663e747c09fad5b02e705a394f1a.pkl
2025-05-05 18:54:55,880 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 18:54:55,906 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_0a8474df115bf334998e6bcb7079362b.pkl
2025-05-05 18:54:57,124 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 18:54:57,130 - lavka_recsys.ModelFactory - INFO - Creating catboost_ranker model with params: {'iterations': 300, 'loss_function': 'YetiRankPairwise', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'custom_metric': ['NDCG:top=10', 'PrecisionAt:top=10', 'RecallAt:top=10'], 'task_type': 'GPU', 'devices': '4,5', 'thread_count': -1}
2025-05-05 18:54:57,407 - lavka_recsys.CatBoostRankerModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 18:55:01,468 - lavka_recsys.CatBoostRankerModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 18:55:04,927 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 18:55:04,948 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 18:55:04,972 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 18:55:06,605 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 18:55:06,626 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 18:55:06,645 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 18:55:08,152 - lavka_recsys.CatBoostRankerModel - INFO - Training CatBoostRanker model with columns: ['user_total_views', 'source_type', 'month', 'std_purchase_hour', 'session_unique_products', 'user_total_purchases', 'purchases_day_u_p', 'day_of_week_relevance', 'hour_of_day', 'user_unique_products', 'count_purchase_u_p', 'puresvd_cf_score', 'cart_to_purchase_rate', 'cf_score', 'session_duration_seconds', 'store_total_interactions', 'user_product_purchase_cross', 'session_purchases', 'product_unique_users', 'days_since_interaction_u_s', 'store_total_purchases', 'is_weekend', 'views_day_u_p', 'most_common_purchase_day', 'count_purchase_u_s', 'purchases_week_u_p', 'interactions_month_u_p', 'avg_purchase_hour', 'user_total_interactions', 'city_name', 'mean_interval_days', 'interactions_week_u_p', 'purchase_view_ratio', 'days_since_interaction_u_p', 'user_store_purchase_cross', 'city_total_purchases', 'city_total_interactions', 'ctr_product', 'hour_relevance', 'user_segment', 'session_unique_stores', 'product_total_views', 'day_of_week', 'purchases_month_u_p', 'interaction_trend', 'npmi_cf_score', 'product_total_purchases', 'user_product_store_cross', 'svd_cf_score', 'store_total_views', 'interactions_day_u_p', 'views_week_u_p', 'city_unique_stores', 'store_unique_products', 'purchase_trend', 'session_length', 'views_month_u_p', 'city_total_views', 'product_total_interactions'] (cat_columns: ['user_segment', 'city_name', 'source_type'])
2025-05-05 18:55:48,449 - lavka_recsys.Experiment(catboost_ranker_611ad3) - INFO - Training completed in 51.32s
2025-05-05 18:55:48,454 - lavka_recsys.Experiment(catboost_ranker_611ad3) - INFO - Evaluating on holdout.
2025-05-05 18:55:48,518 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_1879e9aab22f20d41fd15e001434badd.pkl
2025-05-05 18:55:49,698 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 18:55:49,979 - lavka_recsys.CatBoostRankerModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 18:55:52,842 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 18:55:52,866 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 18:55:52,886 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 18:56:08,590 - lavka_recsys.Experiment(catboost_ranker_611ad3) - INFO - Run results saved: results/catboost_ranker_611ad3_results.json
2025-05-05 18:56:08,593 - lavka_recsys.Experiment(catboost_ranker_611ad3) - INFO - Run finished and results saved.
2025-05-05 18:56:08,711 - lavka_recsys.Experiment(catboost_ranker_611ad3) - INFO - Computing predictions...
2025-05-05 18:56:08,718 - lavka_recsys.DataLoader - INFO - Holdout data merged back into training data.
2025-05-05 18:56:08,758 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 18:56:08,787 - lavka_recsys.DataLoader - INFO -   history: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 18:56:08,792 - lavka_recsys.DataLoader - INFO -   target: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 18:56:08,823 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_1879e9aab22f20d41fd15e001434badd.pkl
2025-05-05 18:56:10,080 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 18:56:10,083 - lavka_recsys.ModelFactory - INFO - Creating catboost_ranker model with params: {'iterations': 300, 'loss_function': 'YetiRankPairwise', 'eval_metric': 'NDCG:top=10', 'early_stopping_rounds': 50, 'custom_metric': ['NDCG:top=10', 'PrecisionAt:top=10', 'RecallAt:top=10'], 'task_type': 'GPU', 'devices': '4,5', 'thread_count': -1}
2025-05-05 18:56:10,356 - lavka_recsys.CatBoostRankerModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 18:56:14,079 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 18:56:14,116 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 18:56:14,139 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 18:56:15,656 - lavka_recsys.CatBoostRankerModel - INFO - Training CatBoostRanker model with columns: ['user_total_views', 'source_type', 'month', 'std_purchase_hour', 'session_unique_products', 'user_total_purchases', 'purchases_day_u_p', 'day_of_week_relevance', 'hour_of_day', 'user_unique_products', 'count_purchase_u_p', 'puresvd_cf_score', 'cart_to_purchase_rate', 'cf_score', 'session_duration_seconds', 'store_total_interactions', 'user_product_purchase_cross', 'session_purchases', 'product_unique_users', 'days_since_interaction_u_s', 'store_total_purchases', 'is_weekend', 'views_day_u_p', 'most_common_purchase_day', 'count_purchase_u_s', 'purchases_week_u_p', 'interactions_month_u_p', 'avg_purchase_hour', 'user_total_interactions', 'city_name', 'mean_interval_days', 'interactions_week_u_p', 'purchase_view_ratio', 'days_since_interaction_u_p', 'user_store_purchase_cross', 'city_total_purchases', 'city_total_interactions', 'ctr_product', 'hour_relevance', 'user_segment', 'session_unique_stores', 'product_total_views', 'day_of_week', 'purchases_month_u_p', 'interaction_trend', 'npmi_cf_score', 'product_total_purchases', 'user_product_store_cross', 'svd_cf_score', 'store_total_views', 'interactions_day_u_p', 'views_week_u_p', 'city_unique_stores', 'store_unique_products', 'purchase_trend', 'session_length', 'views_month_u_p', 'city_total_views', 'product_total_interactions'] (cat_columns: ['user_segment', 'city_name', 'source_type'])
2025-05-05 18:56:54,691 - lavka_recsys.Experiment(catboost_ranker_611ad3) - INFO - Training completed in 44.61s
2025-05-05 18:56:54,697 - lavka_recsys.DataLoader - INFO - Holdout data merged back into training data.
2025-05-05 18:56:54,755 - lavka_recsys.CachedFeatureFactory - INFO - Generating feature batch
2025-05-05 18:56:54,756 - lavka_recsys.FeatureFactory - INFO - Invoking feature generators: source_type, count_purchase_user_product, count_purchase_user_store, ctr_product, cart_to_purchase_rate, purchase_view_ratio, recency_user_product, user_stats, product_stats, store_stats, city_stats, product_temporal_patterns, recency_user_store, time_features, time_window_user_product, session_features, frequency_features, product_popularity_trend, cross_features, user_segments, memory-based-cf, npmi-cf, puresvd-cf, svd-cf
2025-05-05 18:56:54,757 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: source_type
2025-05-05 18:56:54,757 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_product
2025-05-05 18:56:55,006 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: count_purchase_user_store
2025-05-05 18:56:55,068 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: ctr_product
2025-05-05 18:56:55,694 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cart_to_purchase_rate
2025-05-05 18:56:56,120 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: purchase_view_ratio
2025-05-05 18:56:56,614 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_product
2025-05-05 18:56:57,722 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 18:56:58,113 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 18:56:58,613 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 18:56:58,999 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 18:56:59,614 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_temporal_patterns
2025-05-05 18:56:59,762 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: recency_user_store
2025-05-05 18:57:00,191 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_features
2025-05-05 18:57:00,203 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: time_window_user_product
2025-05-05 18:57:00,549 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: session_features
2025-05-05 18:57:02,709 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: frequency_features
2025-05-05 18:57:08,231 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_popularity_trend
2025-05-05 18:57:08,809 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_stats
2025-05-05 18:57:09,209 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: product_stats
2025-05-05 18:57:09,635 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: store_stats
2025-05-05 18:57:09,969 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: city_stats
2025-05-05 18:57:10,672 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: cross_features
2025-05-05 18:57:10,674 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: user_segments
2025-05-05 18:57:11,043 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: memory-based-cf
2025-05-05 18:57:12,346 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: npmi-cf
2025-05-05 18:57:48,357 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: puresvd-cf
2025-05-05 18:58:22,193 - lavka_recsys.FeatureFactory - DEBUG - Generating feature: svd-cf
2025-05-05 18:58:23,838 - lavka_recsys.FeatureFactory - INFO - Joined features
2025-05-05 18:58:23,841 - lavka_recsys.FeatureFactory - INFO - All column names: {'store_total_views', 'std_purchase_hour', 'store_unique_products', 'avg_purchase_hour', 'session_length', 'month', 'user_store_purchase_cross', 'purchases_month_u_p', 'is_weekend', 'purchases_week_u_p', 'hour_relevance', 'store_total_interactions', 'session_unique_products', 'user_product_purchase_cross', 'user_product_store_cross', 'city_total_interactions', 'product_unique_users', 'session_purchases', 'purchase_view_ratio', 'product_total_views', 'store_total_purchases', 'user_segment', 'npmi_cf_score', 'puresvd_cf_score', 'days_since_interaction_u_p', 'ctr_product', 'user_total_interactions', 'day_of_week', 'session_unique_stores', 'product_total_purchases', 'product_total_interactions', 'hour_of_day', 'views_day_u_p', 'interaction_trend', 'user_total_purchases', 'user_unique_products', 'user_total_views', 'count_purchase_u_s', 'city_total_views', 'city_unique_stores', 'count_purchase_u_p', 'day_of_week_relevance', 'purchases_day_u_p', 'mean_interval_days', 'cart_to_purchase_rate', 'city_total_purchases', 'most_common_purchase_day', 'city_name', 'interactions_day_u_p', 'views_week_u_p', 'views_month_u_p', 'days_since_interaction_u_s', 'session_duration_seconds', 'purchase_trend', 'cf_score', 'interactions_month_u_p', 'svd_cf_score', 'source_type', 'interactions_week_u_p'}
2025-05-05 18:58:23,842 - lavka_recsys.FeatureFactory - INFO - All categorical column names: ['city_name', 'user_segment', 'source_type']
2025-05-05 18:58:23,924 - lavka_recsys.CatBoostRankerModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 18:58:24,169 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 18:58:24,177 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 18:58:24,184 - lavka_recsys.CatBoostRankerModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 18:58:24,693 - lavka_recsys.Experiment(catboost_ranker_611ad3) - INFO - Submission saved: results/submissions/catboost_ranker_611ad3_submission.csv
2025-05-05 18:58:24,743 - lavka_recsys.Experiment(catboost_ranker_611ad3) - INFO - Submission model saved: results/submissions/catboost_ranker_611ad3_model.pkl
2025-05-05 19:08:48,054 - lavka_recsys.Experiment(catboost_classifier_4f314c) - INFO - Initialized experiment: catboost_classifier_4f314c
2025-05-05 19:08:48,068 - lavka_recsys.Experiment(catboost_classifier_4f314c) - INFO - Config saved: results/catboost_classifier_4f314c_config.json
2025-05-05 19:08:48,069 - lavka_recsys.Experiment(catboost_classifier_4f314c) - INFO - Setting up experiment environment...
2025-05-05 19:08:48,071 - lavka_recsys.DataLoader - INFO - Loading training data from ../../data/lavka/train.parquet
2025-05-05 19:08:48,363 - lavka_recsys.DataLoader - INFO - Loading test data from ../../data/lavka/test.parquet
2025-05-05 19:08:48,430 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 19:08:48,446 - lavka_recsys.DataPreprocessor - DEBUG - Converting 'timestamp' from epoch[s] to datetime
2025-05-05 19:08:48,574 - lavka_recsys.DataLoader - INFO - Holdout Split:
2025-05-05 19:08:48,603 - lavka_recsys.DataLoader - INFO -   train: 2022-12-31 18:46:42 → 2024-01-03 17:31:52 (15_070_276 rows, 367 days)
2025-05-05 19:08:48,607 - lavka_recsys.DataLoader - INFO -   holdout: 2024-01-03 17:56:48 → 2024-02-02 17:34:51 (1_438_338 rows, 29 days)
2025-05-05 19:08:48,609 - lavka_recsys.Experiment(catboost_classifier_4f314c) - INFO - Setup complete.
2025-05-05 19:08:48,609 - lavka_recsys.Experiment(catboost_classifier_4f314c) - INFO - Starting experiment run...
2025-05-05 19:08:48,950 - lavka_recsys.DataLoader - INFO - Validation Split:
2025-05-05 19:08:48,986 - lavka_recsys.DataLoader - INFO -   train_history: 2022-12-31 18:46:42 → 2023-11-04 17:16:23 (12_082_523 rows, 307 days)
2025-05-05 19:08:48,990 - lavka_recsys.DataLoader - INFO -   train_target: 2023-11-04 18:19:12 → 2023-12-04 17:25:02 (1_498_126 rows, 29 days)
2025-05-05 19:08:49,017 - lavka_recsys.DataLoader - INFO -   val_history: 2022-12-31 18:46:42 → 2023-12-04 17:25:02 (13_580_649 rows, 337 days)
2025-05-05 19:08:49,021 - lavka_recsys.DataLoader - INFO -   val_target: 2023-12-04 18:02:13 → 2024-01-03 17:31:52 (1_489_627 rows, 29 days)
2025-05-05 19:08:49,048 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_eea2663e747c09fad5b02e705a394f1a.pkl
2025-05-05 19:08:50,254 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 19:08:50,285 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_0a8474df115bf334998e6bcb7079362b.pkl
2025-05-05 19:08:51,471 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 19:08:51,473 - lavka_recsys.ModelFactory - INFO - Creating catboost_classifier model with params: {'loss_function': 'Logloss', 'eval_metric': 'AUC', 'early_stopping_rounds': 50, 'custom_metric': ['AUC', 'NDCG:top=10'], 'task_type': 'GPU', 'devices': '4,5', 'thread_count': -1}
2025-05-05 19:08:51,718 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 19:08:55,651 - lavka_recsys.CatBoostClassifierModel - INFO - Sorting data by group_id for grouped ranking
2025-05-05 19:08:59,205 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 19:08:59,227 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 19:08:59,248 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 19:09:00,925 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 19:09:00,955 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 19:09:00,984 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 19:09:02,594 - lavka_recsys.CatBoostClassifierModel - INFO - Training CatBoostClassifier model with columns: Index(['user_total_views', 'source_type', 'month', 'std_purchase_hour',
       'session_unique_products', 'user_total_purchases', 'purchases_day_u_p',
       'day_of_week_relevance', 'hour_of_day', 'user_unique_products',
       'count_purchase_u_p', 'puresvd_cf_score', 'cart_to_purchase_rate',
       'cf_score', 'session_duration_seconds', 'store_total_interactions',
       'user_product_purchase_cross', 'session_purchases',
       'product_unique_users', 'days_since_interaction_u_s',
       'store_total_purchases', 'is_weekend', 'views_day_u_p',
       'most_common_purchase_day', 'count_purchase_u_s', 'purchases_week_u_p',
       'interactions_month_u_p', 'avg_purchase_hour',
       'user_total_interactions', 'city_name', 'mean_interval_days',
       'interactions_week_u_p', 'purchase_view_ratio',
       'days_since_interaction_u_p', 'user_store_purchase_cross',
       'city_total_purchases', 'city_total_interactions', 'ctr_product',
       'hour_relevance', 'user_segment', 'session_unique_stores',
       'product_total_views', 'day_of_week', 'purchases_month_u_p',
       'interaction_trend', 'npmi_cf_score', 'product_total_purchases',
       'user_product_store_cross', 'svd_cf_score', 'store_total_views',
       'interactions_day_u_p', 'views_week_u_p', 'city_unique_stores',
       'store_unique_products', 'purchase_trend', 'session_length',
       'views_month_u_p', 'city_total_views', 'product_total_interactions'],
      dtype='object') (cat_columns: ['user_segment', 'city_name', 'source_type'])
2025-05-05 19:10:03,497 - lavka_recsys.Experiment(catboost_classifier_4f314c) - INFO - Training completed in 72.02s
2025-05-05 19:10:03,502 - lavka_recsys.Experiment(catboost_classifier_4f314c) - INFO - Evaluating on holdout.
2025-05-05 19:10:03,572 - lavka_recsys.CachedFeatureFactory - DEBUG - Loading from cache results/feature_cache/cache_1879e9aab22f20d41fd15e001434badd.pkl
2025-05-05 19:10:04,762 - lavka_recsys.CachedFeatureFactory - INFO - Using cached feature batch
2025-05-05 19:10:04,967 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'source_type' to string for CatBoost
2025-05-05 19:10:05,008 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'city_name' to string for CatBoost
2025-05-05 19:10:05,028 - lavka_recsys.CatBoostClassifierModel - INFO - Converting 'user_segment' to string for CatBoost
2025-05-05 19:10:19,304 - lavka_recsys.Experiment(catboost_classifier_4f314c) - INFO - Run results saved: results/catboost_classifier_4f314c_results.json
2025-05-05 19:10:19,309 - lavka_recsys.Experiment(catboost_classifier_4f314c) - INFO - Run finished and results saved.
